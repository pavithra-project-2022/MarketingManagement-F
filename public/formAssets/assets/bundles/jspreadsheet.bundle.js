var formula=function(){var error=function(){var e={};return e.nil=new Error("#NULL!"),e.div0=new Error("#DIV/0!"),e.value=new Error("#VALUE!"),e.ref=new Error("#REF!"),e.name=new Error("#NAME?"),e.num=new Error("#NUM!"),e.na=new Error("#N/A"),e.error=new Error("#ERROR!"),e.data=new Error("#GETTING_DATA"),e}(),utils=function(){var n={flattenShallow:function(e){return e&&e.reduce?e.reduce(function(e,t){var o=Array.isArray(e),n=Array.isArray(t);return o&&n?e.concat(t):o?(e.push(t),e):n?[e].concat(t):[e,t]}):e},isFlat:function(e){if(!e)return!1;for(var t=0;t<e.length;++t)if(Array.isArray(e[t]))return!1;return!0},flatten:function(){for(var e=n.argsToArray.apply(null,arguments);!n.isFlat(e);)e=n.flattenShallow(e);return e},argsToArray:function(e){var t=[];return n.arrayEach(e,function(e){t.push(e)}),t},numbers:function(){return this.flatten.apply(null,arguments).filter(function(e){return"number"==typeof e})},cleanFloat:function(e){return Math.round(1e14*e)/1e14},parseBool:function(e){if("boolean"==typeof e)return e;if(e instanceof Error)return e;if("number"==typeof e)return 0!==e;if("string"==typeof e){var t=e.toUpperCase();if("TRUE"===t)return!0;if("FALSE"===t)return!1}return e instanceof Date&&!isNaN(e)||error.value},parseNumber:function(e){return void 0===e||""===e||isNaN(e)?error.value:parseFloat(e)},parseNumberArray:function(e){var t,o;if(!e||0===(t=e.length))return error.value;for(;t--;){if((o=n.parseNumber(e[t]))===error.value)return o;e[t]=o}return e},parseMatrix:function(e){var t;if(!e||0===e.length)return error.value;for(var o=0;o<e.length;o++)if(t=n.parseNumberArray(e[o]),(e[o]=t)instanceof Error)return t;return e}},t=new Date(Date.UTC(1900,0,1));return n.parseDate=function(e){if(isNaN(e))return"string"!=typeof e||(e=new Date(e),isNaN(e))?error.value:e;if(e instanceof Date)return new Date(e);e=parseInt(e,10);return e<0?error.num:e<=60?new Date(t.getTime()+864e5*(e-1)):new Date(t.getTime()+864e5*(e-2))},n.parseDateArray=function(e){for(var t,o=e.length;o--;){if((t=this.parseDate(e[o]))===error.value)return t;e[o]=t}return e},n.anyIsError=function(){for(var e=arguments.length;e--;)if(arguments[e]instanceof Error)return!0;return!1},n.arrayValuesToNumbers=function(e){for(var t,o=e.length;o--;)"number"!=typeof(t=e[o])&&(!0===t?e[o]=1:!1===t?e[o]=0:"string"==typeof t&&((t=this.parseNumber(t))instanceof Error?e[o]=0:e[o]=t));return e},n.rest=function(e,t){return t=t||1,e&&"function"==typeof e.slice?e.slice(t):e},n.initial=function(e,t){return t=t||1,e&&"function"==typeof e.slice?e.slice(0,e.length-t):e},n.arrayEach=function(e,t){for(var o=-1,n=e.length;++o<n&&!1!==t(e[o],o,e););return e},n.transpose=function(o){return o?o[0].map(function(e,t){return o.map(function(e){return e[t]})}):error.value},n}(),met={};met.datetime=function(){var e={},t=new Date(1900,0,1),o=[[],[1,2,3,4,5,6,7],[7,1,2,3,4,5,6],[6,0,1,2,3,4,5],[],[],[],[],[],[],[],[7,1,2,3,4,5,6],[6,7,1,2,3,4,5],[5,6,7,1,2,3,4],[4,5,6,7,1,2,3],[3,4,5,6,7,1,2],[2,3,4,5,6,7,1],[1,2,3,4,5,6,7]];function n(e){return(e-t)/864e5+(-22038912e5<e?2:1)}return e.DATE=function(e,t,o){return e=utils.parseNumber(e),t=utils.parseNumber(t),o=utils.parseNumber(o),utils.anyIsError(e,t,o)?error.value:e<0||t<0||o<0?error.num:new Date(e,t-1,o)},e.DATEVALUE=function(e){if("string"!=typeof e)return error.value;e=Date.parse(e);return isNaN(e)?error.value:e<=-22038912e5?(e-t)/864e5+1:(e-t)/864e5+2},e.DAY=function(e){e=utils.parseDate(e);return e instanceof Error?e:e.getDate()},e.DAYS=function(e,t){return e=utils.parseDate(e),t=utils.parseDate(t),e instanceof Error?e:t instanceof Error?t:n(e)-n(t)},e.DAYS360=function(e,t,o){},e.EDATE=function(e,t){return(e=utils.parseDate(e))instanceof Error?e:isNaN(t)?error.value:(t=parseInt(t,10),e.setMonth(e.getMonth()+t),n(e))},e.EOMONTH=function(e,t){return(e=utils.parseDate(e))instanceof Error?e:isNaN(t)?error.value:(t=parseInt(t,10),n(new Date(e.getFullYear(),e.getMonth()+t+1,0)))},e.HOUR=function(e){return(e=utils.parseDate(e))instanceof Error?e:e.getHours()},e.INTERVAL=function(e){if("number"!=typeof e&&"string"!=typeof e)return error.value;e=parseInt(e,10);var t=Math.floor(e/94608e4),o=(e%=94608e4,Math.floor(e/2592e3)),n=(e%=2592e3,Math.floor(e/86400)),r=(e%=86400,Math.floor(e/3600)),i=(e%=3600,Math.floor(e/60)),e=e%=60;return"P"+(t=0<t?t+"Y":"")+(o=0<o?o+"M":"")+(n=0<n?n+"D":"")+"T"+(r=0<r?r+"H":"")+(i=0<i?i+"M":"")+(e=0<e?e+"S":"")},e.ISOWEEKNUM=function(e){if((e=utils.parseDate(e))instanceof Error)return e;e.setHours(0,0,0),e.setDate(e.getDate()+4-(e.getDay()||7));var t=new Date(e.getFullYear(),0,1);return Math.ceil(((e-t)/864e5+1)/7)},e.MINUTE=function(e){return(e=utils.parseDate(e))instanceof Error?e:e.getMinutes()},e.MONTH=function(e){return(e=utils.parseDate(e))instanceof Error?e:e.getMonth()+1},e.NETWORKDAYS=function(e,t,o){},e.NETWORKDAYS.INTL=function(e,t,o,n){},e.NOW=function(){return new Date},e.SECOND=function(e){return(e=utils.parseDate(e))instanceof Error?e:e.getSeconds()},e.TIME=function(e,t,o){return e=utils.parseNumber(e),t=utils.parseNumber(t),o=utils.parseNumber(o),utils.anyIsError(e,t,o)?error.value:e<0||t<0||o<0?error.num:(3600*e+60*t+o)/86400},e.TIMEVALUE=function(e){return(e=utils.parseDate(e))instanceof Error?e:(3600*e.getHours()+60*e.getMinutes()+e.getSeconds())/86400},e.TODAY=function(){return new Date},e.WEEKDAY=function(e,t){if((e=utils.parseDate(e))instanceof Error)return e;void 0===t&&(t=1);e=e.getDay();return o[t][e]},e.WEEKNUM=function(e,t){},e.WORKDAY=function(e,t,o){},e.WORKDAY.INTL=function(e,t,o,n){},e.YEAR=function(e){return(e=utils.parseDate(e))instanceof Error?e:e.getFullYear()},e.YEARFRAC=function(e,t,o){},e}(),met.database=function(){var exports={};function compact(e){if(!e)return e;for(var t=[],o=0;o<e.length;++o)e[o]&&t.push(e[o]);return t}function findResultIndex(database,criterias){for(var matches={},i=1;i<database[0].length;++i)matches[i]=!0;for(var maxCriteriaLength=criterias[0].length,i=1;i<criterias.length;++i)criterias[i].length>maxCriteriaLength&&(maxCriteriaLength=criterias[i].length);for(var k=1;k<database.length;++k)for(var l=1;l<database[k].length;++l){for(var currentCriteriaResult=!1,hasMatchingCriteria=!1,j=0;j<criterias.length;++j){var criteria=criterias[j];if(!(criteria.length<maxCriteriaLength)){var criteriaField=criteria[0];if(database[k][0]===criteriaField)for(var hasMatchingCriteria=!0,p=1;p<criteria.length;++p)currentCriteriaResult=currentCriteriaResult||eval(database[k][l]+criteria[p])}}hasMatchingCriteria&&(matches[l]=matches[l]&&currentCriteriaResult)}for(var result=[],n=0;n<database[0].length;++n)matches[n]&&result.push(n-1);return result}return exports.FINDFIELD=function(e,t){for(var o=null,n=0;n<e.length;n++)if(e[n][0]===t){o=n;break}return null==o?error.value:o},exports.DAVERAGE=function(e,t,o){if(isNaN(t)&&"string"!=typeof t)return error.value;for(var n=findResultIndex(e,o),r=[],i=(r="string"==typeof t?(o=exports.FINDFIELD(e,t),utils.rest(e[o])):utils.rest(e[t]),0),s=0;s<n.length;s++)i+=r[n[s]];return 0===n.length?error.div0:i/n.length},exports.DCOUNT=function(e,t,o){},exports.DCOUNTA=function(e,t,o){},exports.DGET=function(e,t,o){if(isNaN(t)&&"string"!=typeof t)return error.value;var n,o=findResultIndex(e,o),r=[];return r="string"==typeof t?(n=exports.FINDFIELD(e,t),utils.rest(e[n])):utils.rest(e[t]),0===o.length?error.value:1<o.length?error.num:r[o[0]]},exports.DMAX=function(e,t,o){if(isNaN(t)&&"string"!=typeof t)return error.value;for(var n=findResultIndex(e,o),r=[],i=(r="string"==typeof t?(o=exports.FINDFIELD(e,t),utils.rest(e[o])):utils.rest(e[t]))[n[0]],s=1;s<n.length;s++)i<r[n[s]]&&(i=r[n[s]]);return i},exports.DMIN=function(e,t,o){if(isNaN(t)&&"string"!=typeof t)return error.value;for(var n=findResultIndex(e,o),r=[],i=(r="string"==typeof t?(o=exports.FINDFIELD(e,t),utils.rest(e[o])):utils.rest(e[t]))[n[0]],s=1;s<n.length;s++)i>r[n[s]]&&(i=r[n[s]]);return i},exports.DPRODUCT=function(e,t,o){if(isNaN(t)&&"string"!=typeof t)return error.value;for(var n=findResultIndex(e,o),r=[],i=(r="string"==typeof t?(o=exports.FINDFIELD(e,t),utils.rest(e[o])):utils.rest(e[t]),[]),s=0;s<n.length;s++)i[s]=r[n[s]];for(var i=compact(i),l=1,s=0;s<i.length;s++)l*=i[s];return l},exports.DSTDEV=function(e,t,o){},exports.DSTDEVP=function(e,t,o){},exports.DSUM=function(e,t,o){},exports.DVAR=function(e,t,o){},exports.DVARP=function(e,t,o){},exports.MATCH=function(e,t,o){if(!e&&!t)return error.na;if(2===arguments.length&&(o=1),!(t instanceof Array))return error.na;if(-1!==o&&0!==o&&1!==o)return error.na;for(var n,r,i=0;i<t.length;i++)if(1===o){if(t[i]===e)return i+1;t[i]<e&&(!r||t[i]>r)&&(n=i+1,r=t[i])}else if(0===o){if("string"==typeof e){if(e=e.replace(/\?/g,"."),t[i].toLowerCase().match(e.toLowerCase()))return i+1}else if(t[i]===e)return i+1}else if(-1===o){if(t[i]===e)return i+1;t[i]>e&&(!r||t[i]<r)&&(n=i+1,r=t[i])}return n||error.na},exports}(),met.engineering=function(){var s={};function n(e){return/^[01]{1,10}$/.test(e)}return s.BESSELI=function(e,t){},s.BESSELJ=function(e,t){},s.BESSELK=function(e,t){},s.BESSELY=function(e,t){},s.BIN2DEC=function(e){if(!n(e))return error.num;var t=parseInt(e,2),e=e.toString();return 10===e.length&&"1"===e.substring(0,1)?parseInt(e.substring(1),2)-512:t},s.BIN2HEX=function(e,t){if(!n(e))return error.num;var o=e.toString();if(10===o.length&&"1"===o.substring(0,1))return(0xfffffffe00+parseInt(o.substring(1),2)).toString(16);o=parseInt(e,2).toString(16);return void 0===t?o:isNaN(t)?error.value:!(t<0)&&(t=Math.floor(t))>=o.length?REPT("0",t-o.length)+o:error.num},s.BIN2OCT=function(e,t){if(!n(e))return error.num;var o=e.toString();if(10===o.length&&"1"===o.substring(0,1))return(1073741312+parseInt(o.substring(1),2)).toString(8);o=parseInt(e,2).toString(8);return void 0===t?o:isNaN(t)?error.value:!(t<0)&&(t=Math.floor(t))>=o.length?REPT("0",t-o.length)+o:error.num},s.BITAND=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:e<0||t<0||Math.floor(e)!==e||Math.floor(t)!==t||0xffffffffffff<e||0xffffffffffff<t?error.num:e&t},s.BITLSHIFT=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:e<0||Math.floor(e)!==e||0xffffffffffff<e||53<Math.abs(t)?error.num:0<=t?e<<t:e>>-t},s.BITOR=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:e<0||t<0||Math.floor(e)!==e||Math.floor(t)!==t||0xffffffffffff<e||0xffffffffffff<t?error.num:e|t},s.BITRSHIFT=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:e<0||Math.floor(e)!==e||0xffffffffffff<e||53<Math.abs(t)?error.num:0<=t?e>>t:e<<-t},s.BITXOR=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:e<0||t<0||Math.floor(e)!==e||Math.floor(t)!==t||0xffffffffffff<e||0xffffffffffff<t?error.num:e^t},s.COMPLEX=function(e,t,o){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?e:"i"!==(o=void 0===o?"i":o)&&"j"!==o?error.value:0===e&&0===t?0:0===e?1===t?o:t.toString()+o:0===t?e.toString():(n=0<t?"+":"",e.toString()+n+(1===t?o:t.toString()+o));var n},s.CONVERT=function(e,t,o){if((e=utils.parseNumber(e))instanceof Error)return e;for(var n,r=[["a.u. of action","?",null,"action",!1,!1,105457168181818e-48],["a.u. of charge","e",null,"electric_charge",!1,!1,160217653141414e-33],["a.u. of energy","Eh",null,"energy",!1,!1,435974417757576e-32],["a.u. of length","a?",null,"length",!1,!1,529177210818182e-25],["a.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["a.u. of time","?/Eh",null,"time",!1,!1,241888432650516e-31],["admiralty knot","admkn",null,"speed",!1,!0,.514773333],["ampere","A",null,"electric_current",!0,!1,1],["ampere per meter","A/m",null,"magnetic_field_intensity",!0,!1,1],["ångström","Å",["ang"],"length",!1,!0,1e-10],["are","ar",null,"area",!1,!0,100],["astronomical unit","ua",null,"length",!1,!1,149597870691667e-25],["bar","bar",null,"pressure",!1,!1,1e5],["barn","b",null,"area",!1,!1,1e-28],["becquerel","Bq",null,"radioactivity",!0,!1,1],["bit","bit",["b"],"information",!1,!0,1],["btu","BTU",["btu"],"energy",!1,!0,1055.05585262],["byte","byte",null,"information",!1,!0,8],["candela","cd",null,"luminous_intensity",!0,!1,1],["candela per square metre","cd/m?",null,"luminance",!0,!1,1],["coulomb","C",null,"electric_charge",!0,!1,1],["cubic ångström","ang3",["ang^3"],"volume",!1,!0,1e-30],["cubic foot","ft3",["ft^3"],"volume",!1,!0,.028316846592],["cubic inch","in3",["in^3"],"volume",!1,!0,16387064e-12],["cubic light-year","ly3",["ly^3"],"volume",!1,!0,846786664623715e-61],["cubic metre","m?",null,"volume",!0,!0,1],["cubic mile","mi3",["mi^3"],"volume",!1,!0,4168181825.44058],["cubic nautical mile","Nmi3",["Nmi^3"],"volume",!1,!0,6352182208],["cubic Pica","Pica3",["Picapt3","Pica^3","Picapt^3"],"volume",!1,!0,7.58660370370369e-8],["cubic yard","yd3",["yd^3"],"volume",!1,!0,.764554857984],["cup","cup",null,"volume",!1,!0,.0002365882365],["dalton","Da",["u"],"mass",!1,!1,166053886282828e-41],["day","d",["day"],"time",!1,!0,86400],["degree","°",null,"angle",!1,!1,.0174532925199433],["degrees Rankine","Rank",null,"temperature",!1,!0,.555555555555556],["dyne","dyn",["dy"],"force",!1,!0,1e-5],["electronvolt","eV",["ev"],"energy",!1,!0,1.60217656514141],["ell","ell",null,"length",!1,!0,1.143],["erg","erg",["e"],"energy",!1,!0,1e-7],["farad","F",null,"electric_capacitance",!0,!1,1],["fluid ounce","oz",null,"volume",!1,!0,295735295625e-16],["foot","ft",null,"length",!1,!0,.3048],["foot-pound","flb",null,"energy",!1,!0,1.3558179483314],["gal","Gal",null,"acceleration",!1,!1,.01],["gallon","gal",null,"volume",!1,!0,.003785411784],["gauss","G",["ga"],"magnetic_flux_density",!1,!0,1],["grain","grain",null,"mass",!1,!0,647989e-10],["gram","g",null,"mass",!1,!0,.001],["gray","Gy",null,"absorbed_dose",!0,!1,1],["gross registered ton","GRT",["regton"],"volume",!1,!0,2.8316846592],["hectare","ha",null,"area",!1,!0,1e4],["henry","H",null,"inductance",!0,!1,1],["hertz","Hz",null,"frequency",!0,!1,1],["horsepower","HP",["h"],"power",!1,!0,745.69987158227],["horsepower-hour","HPh",["hh","hph"],"energy",!1,!0,2684519.538],["hour","h",["hr"],"time",!1,!0,3600],["imperial gallon (U.K.)","uk_gal",null,"volume",!1,!0,.00454609],["imperial hundredweight","lcwt",["uk_cwt","hweight"],"mass",!1,!0,50.802345],["imperial quart (U.K)","uk_qt",null,"volume",!1,!0,.0011365225],["imperial ton","brton",["uk_ton","LTON"],"mass",!1,!0,1016.046909],["inch","in",null,"length",!1,!0,.0254],["international acre","uk_acre",null,"area",!1,!0,4046.8564224],["IT calorie","cal",null,"energy",!1,!0,4.1868],["joule","J",null,"energy",!0,!0,1],["katal","kat",null,"catalytic_activity",!0,!1,1],["kelvin","K",["kel"],"temperature",!0,!0,1],["kilogram","kg",null,"mass",!0,!0,1],["knot","kn",null,"speed",!1,!0,.514444444444444],["light-year","ly",null,"length",!1,!0,9460730472580800],["litre","L",["l","lt"],"volume",!1,!0,.001],["lumen","lm",null,"luminous_flux",!0,!1,1],["lux","lx",null,"illuminance",!0,!1,1],["maxwell","Mx",null,"magnetic_flux",!1,!1,1e-18],["measurement ton","MTON",null,"volume",!1,!0,1.13267386368],["meter per hour","m/h",["m/hr"],"speed",!1,!0,.00027777777777778],["meter per second","m/s",["m/sec"],"speed",!0,!0,1],["meter per second squared","m?s??",null,"acceleration",!0,!1,1],["parsec","pc",["parsec"],"length",!1,!0,0x6da012f958ee1c],["meter squared per second","m?/s",null,"kinematic_viscosity",!0,!1,1],["metre","m",null,"length",!0,!0,1],["miles per hour","mph",null,"speed",!1,!0,.44704],["millimetre of mercury","mmHg",null,"pressure",!1,!1,133.322],["minute","?",null,"angle",!1,!1,.000290888208665722],["minute","min",["mn"],"time",!1,!0,60],["modern teaspoon","tspm",null,"volume",!1,!0,5e-6],["mole","mol",null,"amount_of_substance",!0,!1,1],["morgen","Morgen",null,"area",!1,!0,2500],["n.u. of action","?",null,"action",!1,!1,105457168181818e-48],["n.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["n.u. of speed","c?",null,"speed",!1,!1,299792458],["n.u. of time","?/(me?c??)",null,"time",!1,!1,128808866778687e-35],["nautical mile","M",["Nmi"],"length",!1,!0,1852],["newton","N",null,"force",!0,!0,1],["œrsted","Oe ",null,"magnetic_field_intensity",!1,!1,79.5774715459477],["ohm","Ω",null,"electric_resistance",!0,!1,1],["ounce mass","ozm",null,"mass",!1,!0,.028349523125],["pascal","Pa",null,"pressure",!0,!1,1],["pascal second","Pa?s",null,"dynamic_viscosity",!0,!1,1],["pferdestärke","PS",null,"power",!1,!0,735.49875],["phot","ph",null,"illuminance",!1,!1,1e-4],["pica (1/6 inch)","pica",null,"length",!1,!0,.00035277777777778],["pica (1/72 inch)","Pica",["Picapt"],"length",!1,!0,.00423333333333333],["poise","P",null,"dynamic_viscosity",!1,!1,.1],["pond","pond",null,"force",!1,!0,.00980665],["pound force","lbf",null,"force",!1,!0,4.4482216152605],["pound mass","lbm",null,"mass",!1,!0,.45359237],["quart","qt",null,"volume",!1,!0,.000946352946],["radian","rad",null,"angle",!0,!1,1],["second","?",null,"angle",!1,!1,484813681109536e-20],["second","s",["sec"],"time",!0,!0,1],["short hundredweight","cwt",["shweight"],"mass",!1,!0,45.359237],["siemens","S",null,"electrical_conductance",!0,!1,1],["sievert","Sv",null,"equivalent_dose",!0,!1,1],["slug","sg",null,"mass",!1,!0,14.59390294],["square ångström","ang2",["ang^2"],"area",!1,!0,1e-20],["square foot","ft2",["ft^2"],"area",!1,!0,.09290304],["square inch","in2",["in^2"],"area",!1,!0,64516e-8],["square light-year","ly2",["ly^2"],"area",!1,!0,895054210748189e17],["square meter","m?",null,"area",!0,!0,1],["square mile","mi2",["mi^2"],"area",!1,!0,2589988.110336],["square nautical mile","Nmi2",["Nmi^2"],"area",!1,!0,3429904],["square Pica","Pica2",["Picapt2","Pica^2","Picapt^2"],"area",!1,!0,1792111111111e-17],["square yard","yd2",["yd^2"],"area",!1,!0,.83612736],["statute mile","mi",null,"length",!1,!0,1609.344],["steradian","sr",null,"solid_angle",!0,!1,1],["stilb","sb",null,"luminance",!1,!1,1e-4],["stokes","St",null,"kinematic_viscosity",!1,!1,1e-4],["stone","stone",null,"mass",!1,!0,6.35029318],["tablespoon","tbs",null,"volume",!1,!0,147868e-10],["teaspoon","tsp",null,"volume",!1,!0,492892e-11],["tesla","T",null,"magnetic_flux_density",!0,!0,1],["thermodynamic calorie","c",null,"energy",!1,!0,4.184],["ton","ton",null,"mass",!1,!0,907.18474],["tonne","t",null,"mass",!1,!1,1e3],["U.K. pint","uk_pt",null,"volume",!1,!0,.00056826125],["U.S. bushel","bushel",null,"volume",!1,!0,.03523907],["U.S. oil barrel","barrel",null,"volume",!1,!0,.158987295],["U.S. pint","pt",["us_pt"],"volume",!1,!0,.000473176473],["U.S. survey mile","survey_mi",null,"length",!1,!0,1609.347219],["U.S. survey/statute acre","us_acre",null,"area",!1,!0,4046.87261],["volt","V",null,"voltage",!0,!1,1],["watt","W",null,"power",!0,!0,1],["watt-hour","Wh",["wh"],"energy",!1,!0,3600],["weber","Wb",null,"magnetic_flux",!0,!1,1],["yard","yd",null,"length",!1,!0,.9144],["year","yr",null,"time",!1,!0,31557600]],i={Yi:["yobi",80,12089258196146292e8,"Yi","yotta"],Zi:["zebi",70,11805916207174113e5,"Zi","zetta"],Ei:["exbi",60,0x1000000000000000,"Ei","exa"],Pi:["pebi",50,0x4000000000000,"Pi","peta"],Ti:["tebi",40,1099511627776,"Ti","tera"],Gi:["gibi",30,1073741824,"Gi","giga"],Mi:["mebi",20,1048576,"Mi","mega"],ki:["kibi",10,1024,"ki","kilo"]},s={Y:["yotta",1e24,"Y"],Z:["zetta",1e21,"Z"],E:["exa",1e18,"E"],P:["peta",1e15,"P"],T:["tera",1e12,"T"],G:["giga",1e9,"G"],M:["mega",1e6,"M"],k:["kilo",1e3,"k"],h:["hecto",100,"h"],e:["dekao",10,"e"],d:["deci",.1,"d"],c:["centi",.01,"c"],m:["milli",.001,"m"],u:["micro",1e-6,"u"],n:["nano",1e-9,"n"],p:["pico",1e-12,"p"],f:["femto",1e-15,"f"],a:["atto",1e-18,"a"],z:["zepto",1e-21,"z"],y:["yocto",1e-24,"y"]},l=null,a=null,u=t,c=o,d=1,p=1,h=0;h<r.length;h++)n=null===r[h][2]?[]:r[h][2],(r[h][1]===u||0<=n.indexOf(u))&&(l=r[h]),(r[h][1]===c||0<=n.indexOf(c))&&(a=r[h]);if(null===l){var f=i[t.substring(0,2)],b=s[t.substring(0,1)];"da"===t.substring(0,2)&&(b=["dekao",10,"da"]),f?(d=f[2],u=t.substring(2)):b&&(d=b[1],u=t.substring(b[2].length));for(var m=0;m<r.length;m++)n=null===r[m][2]?[]:r[m][2],(r[m][1]===u||0<=n.indexOf(u))&&(l=r[m])}if(null===a){f=i[o.substring(0,2)],t=s[o.substring(0,1)];"da"===o.substring(0,2)&&(t=["dekao",10,"da"]),f?(p=f[2],c=o.substring(2)):t&&(p=t[1],c=o.substring(t[2].length));for(var g=0;g<r.length;g++)n=null===r[g][2]?[]:r[g][2],(r[g][1]===c||0<=n.indexOf(c))&&(a=r[g])}return null===l||null===a||l[3]!==a[3]?error.na:e*l[6]*d/(a[6]*p)},s.DEC2BIN=function(e,t){if((e=utils.parseNumber(e))instanceof Error)return e;if(!/^-?[0-9]{1,3}$/.test(e)||e<-512||511<e)return error.num;if(e<0)return"1"+REPT("0",9-(512+e).toString(2).length)+(512+e).toString(2);e=parseInt(e,10).toString(2);return void 0===t?e:isNaN(t)?error.value:!(t<0)&&(t=Math.floor(t))>=e.length?REPT("0",t-e.length)+e:error.num},s.DEC2HEX=function(e,t){if((e=utils.parseNumber(e))instanceof Error)return e;if(!/^-?[0-9]{1,12}$/.test(e)||e<-549755813888||549755813887<e)return error.num;if(e<0)return(1099511627776+e).toString(16);e=parseInt(e,10).toString(16);return void 0===t?e:isNaN(t)?error.value:!(t<0)&&(t=Math.floor(t))>=e.length?REPT("0",t-e.length)+e:error.num},s.DEC2OCT=function(e,t){if((e=utils.parseNumber(e))instanceof Error)return e;if(!/^-?[0-9]{1,9}$/.test(e)||e<-536870912||536870911<e)return error.num;if(e<0)return(1073741824+e).toString(8);e=parseInt(e,10).toString(8);return void 0===t?e:isNaN(t)?error.value:!(t<0)&&(t=Math.floor(t))>=e.length?REPT("0",t-e.length)+e:error.num},s.DELTA=function(e,t){return t=void 0===t?0:t,e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:e===t?1:0},s.ERF=function(e,t){},s.ERF.PRECISE=function(){},s.ERFC=function(e){},s.ERFC.PRECISE=function(){},s.GESTEP=function(e,t){return t=t||0,e=utils.parseNumber(e),utils.anyIsError(t,e)?e:t<=e?1:0},s.HEX2BIN=function(e,t){if(!/^[0-9A-Fa-f]{1,10}$/.test(e))return error.num;var o=10===e.length&&"f"===e.substring(0,1).toLowerCase(),e=o?parseInt(e,16)-1099511627776:parseInt(e,16);if(e<-512||511<e)return error.num;if(o)return"1"+REPT("0",9-(512+e).toString(2).length)+(512+e).toString(2);o=e.toString(2);return void 0===t?o:isNaN(t)?error.value:!(t<0)&&(t=Math.floor(t))>=o.length?REPT("0",t-o.length)+o:error.num},s.HEX2DEC=function(e){if(!/^[0-9A-Fa-f]{1,10}$/.test(e))return error.num;e=parseInt(e,16);return 549755813888<=e?e-1099511627776:e},s.HEX2OCT=function(e,t){if(!/^[0-9A-Fa-f]{1,10}$/.test(e))return error.num;e=parseInt(e,16);if(536870911<e&&e<0xffe0000000)return error.num;if(0xffe0000000<=e)return(e-0xffc0000000).toString(8);e=e.toString(8);return void 0===t?e:isNaN(t)?error.value:!(t<0)&&(t=Math.floor(t))>=e.length?REPT("0",t-e.length)+e:error.num},s.IMABS=function(e){var t=s.IMREAL(e),e=s.IMAGINARY(e);return utils.anyIsError(t,e)?error.value:Math.sqrt(Math.pow(t,2)+Math.pow(e,2))},s.IMAGINARY=function(e){if(void 0===e||!0===e||!1===e)return error.value;if(0===e||"0"===e)return 0;if(0<=["i","j"].indexOf(e))return 1;var t=(e=e.replace("+i","+1i").replace("-i","-1i").replace("+j","+1j").replace("-j","-1j")).indexOf("+"),o=e.indexOf("-"),n=(0===t&&(t=e.indexOf("+",1)),0===o&&(o=e.indexOf("-",1)),e.substring(e.length-1,e.length)),n="i"===n||"j"===n;return 0<=t||0<=o?n?0<=t?isNaN(e.substring(0,t))||isNaN(e.substring(t+1,e.length-1))?error.num:Number(e.substring(t+1,e.length-1)):isNaN(e.substring(0,o))||isNaN(e.substring(o+1,e.length-1))?error.num:-Number(e.substring(o+1,e.length-1)):error.num:n?isNaN(e.substring(0,e.length-1))?error.num:e.substring(0,e.length-1):isNaN(e)?error.num:0},s.IMARGUMENT=function(e){var t=s.IMREAL(e),e=s.IMAGINARY(e);return utils.anyIsError(t,e)?error.value:0===t&&0===e?error.div0:0===t&&0<e?Math.PI/2:0===t&&e<0?-Math.PI/2:0===e&&0<t?0:0===e&&t<0?-Math.PI:0<t?Math.atan(e/t):t<0&&0<=e?Math.atan(e/t)+Math.PI:Math.atan(e/t)-Math.PI},s.IMCONJUGATE=function(e){var t=s.IMREAL(e),o=s.IMAGINARY(e);if(utils.anyIsError(t,o))return error.value;var n="i"===(n=e.substring(e.length-1))||"j"===n?n:"i";return 0!==o?s.COMPLEX(t,-o,n):e},s.IMCOS=function(e){var t=s.IMREAL(e),o=s.IMAGINARY(e);if(utils.anyIsError(t,o))return error.value;e="i"===(e=e.substring(e.length-1))||"j"===e?e:"i";return s.COMPLEX(Math.cos(t)*(Math.exp(o)+Math.exp(-o))/2,-Math.sin(t)*(Math.exp(o)-Math.exp(-o))/2,e)},s.IMCOSH=function(e){var t=s.IMREAL(e),o=s.IMAGINARY(e);if(utils.anyIsError(t,o))return error.value;e="i"===(e=e.substring(e.length-1))||"j"===e?e:"i";return s.COMPLEX(Math.cos(o)*(Math.exp(t)+Math.exp(-t))/2,Math.sin(o)*(Math.exp(t)-Math.exp(-t))/2,e)},s.IMCOT=function(e){var t=s.IMREAL(e),o=s.IMAGINARY(e);return utils.anyIsError(t,o)?error.value:s.IMDIV(s.IMCOS(e),s.IMSIN(e))},s.IMDIV=function(e,t){var o=s.IMREAL(e),n=s.IMAGINARY(e),r=s.IMREAL(t),i=s.IMAGINARY(t);if(utils.anyIsError(o,n,r,i))return error.value;e=e.substring(e.length-1),t=t.substring(t.length-1),e="j"===e||"j"===t?"j":"i";if(0===r&&0===i)return error.num;t=r*r+i*i;return s.COMPLEX((o*r+n*i)/t,(n*r-o*i)/t,e)},s.IMEXP=function(e){var t=s.IMREAL(e),o=s.IMAGINARY(e);if(utils.anyIsError(t,o))return error.value;e="i"===(e=e.substring(e.length-1))||"j"===e?e:"i",t=Math.exp(t);return s.COMPLEX(t*Math.cos(o),t*Math.sin(o),e)},s.IMLN=function(e){var t=s.IMREAL(e),o=s.IMAGINARY(e);if(utils.anyIsError(t,o))return error.value;e="i"===(e=e.substring(e.length-1))||"j"===e?e:"i";return s.COMPLEX(Math.log(Math.sqrt(t*t+o*o)),Math.atan(o/t),e)},s.IMLOG10=function(e){var t=s.IMREAL(e),o=s.IMAGINARY(e);if(utils.anyIsError(t,o))return error.value;e="i"===(e=e.substring(e.length-1))||"j"===e?e:"i";return s.COMPLEX(Math.log(Math.sqrt(t*t+o*o))/Math.log(10),Math.atan(o/t)/Math.log(10),e)},s.IMLOG2=function(e){var t=s.IMREAL(e),o=s.IMAGINARY(e);if(utils.anyIsError(t,o))return error.value;e="i"===(e=e.substring(e.length-1))||"j"===e?e:"i";return s.COMPLEX(Math.log(Math.sqrt(t*t+o*o))/Math.log(2),Math.atan(o/t)/Math.log(2),e)},s.IMPOWER=function(e,t){t=utils.parseNumber(t);var o=s.IMREAL(e),n=s.IMAGINARY(e);if(utils.anyIsError(t,o,n))return error.value;o="i"===(o=e.substring(e.length-1))||"j"===o?o:"i",n=Math.pow(s.IMABS(e),t),e=s.IMARGUMENT(e);return s.COMPLEX(n*Math.cos(t*e),n*Math.sin(t*e),o)},s.IMPRODUCT=function(){for(var e=arguments[0],t=1;t<arguments.length;t++){var o=s.IMREAL(e),n=s.IMAGINARY(e),r=s.IMREAL(arguments[t]),i=s.IMAGINARY(arguments[t]);if(utils.anyIsError(o,n,r,i))return error.value;e=s.COMPLEX(o*r-n*i,o*i+n*r)}return e},s.IMREAL=function(e){if(void 0===e||!0===e||!1===e)return error.value;if(0===e||"0"===e)return 0;if(0<=["i","+i","1i","+1i","-i","-1i","j","+j","1j","+1j","-j","-1j"].indexOf(e))return 0;var t=e.indexOf("+"),o=e.indexOf("-"),n=(0===t&&(t=e.indexOf("+",1)),0===o&&(o=e.indexOf("-",1)),e.substring(e.length-1,e.length)),n="i"===n||"j"===n;return 0<=t||0<=o?n?0<=t?isNaN(e.substring(0,t))||isNaN(e.substring(t+1,e.length-1))?error.num:Number(e.substring(0,t)):isNaN(e.substring(0,o))||isNaN(e.substring(o+1,e.length-1))?error.num:Number(e.substring(0,o)):error.num:n?isNaN(e.substring(0,e.length-1))?error.num:0:isNaN(e)?error.num:e},s.IMSEC=function(e){if(!0===e||!1===e)return error.value;var t=s.IMREAL(e),o=s.IMAGINARY(e);return utils.anyIsError(t,o)?error.value:s.IMDIV("1",s.IMCOS(e))},s.IMSECH=function(e){var t=s.IMREAL(e),o=s.IMAGINARY(e);return utils.anyIsError(t,o)?error.value:s.IMDIV("1",s.IMCOSH(e))},s.IMSIN=function(e){var t=s.IMREAL(e),o=s.IMAGINARY(e);if(utils.anyIsError(t,o))return error.value;e="i"===(e=e.substring(e.length-1))||"j"===e?e:"i";return s.COMPLEX(Math.sin(t)*(Math.exp(o)+Math.exp(-o))/2,Math.cos(t)*(Math.exp(o)-Math.exp(-o))/2,e)},s.IMSINH=function(e){var t=s.IMREAL(e),o=s.IMAGINARY(e);if(utils.anyIsError(t,o))return error.value;e="i"===(e=e.substring(e.length-1))||"j"===e?e:"i";return s.COMPLEX(Math.cos(o)*(Math.exp(t)-Math.exp(-t))/2,Math.sin(o)*(Math.exp(t)+Math.exp(-t))/2,e)},s.IMSQRT=function(e){var t=s.IMREAL(e),o=s.IMAGINARY(e);if(utils.anyIsError(t,o))return error.value;t="i"===(t=e.substring(e.length-1))||"j"===t?t:"i",o=Math.sqrt(s.IMABS(e)),e=s.IMARGUMENT(e);return s.COMPLEX(o*Math.cos(e/2),o*Math.sin(e/2),t)},s.IMCSC=function(e){if(!0===e||!1===e)return error.value;var t=s.IMREAL(e),o=s.IMAGINARY(e);return utils.anyIsError(t,o)?error.num:s.IMDIV("1",s.IMSIN(e))},s.IMCSCH=function(e){if(!0===e||!1===e)return error.value;var t=s.IMREAL(e),o=s.IMAGINARY(e);return utils.anyIsError(t,o)?error.num:s.IMDIV("1",s.IMSINH(e))},s.IMSUB=function(e,t){var o=this.IMREAL(e),n=this.IMAGINARY(e),r=this.IMREAL(t),i=this.IMAGINARY(t);if(utils.anyIsError(o,n,r,i))return error.value;e=e.substring(e.length-1),t=t.substring(t.length-1),e="j"!==e&&"j"!==t?"i":"j";return this.COMPLEX(o-r,n-i,e)},s.IMSUM=function(){for(var e=utils.flatten(arguments),t=e[0],o=1;o<e.length;o++){var n=this.IMREAL(t),r=this.IMAGINARY(t),i=this.IMREAL(e[o]),s=this.IMAGINARY(e[o]);if(utils.anyIsError(n,r,i,s))return error.value;t=this.COMPLEX(n+i,r+s)}return t},s.IMTAN=function(e){if(!0===e||!1===e)return error.value;var t=s.IMREAL(e),o=s.IMAGINARY(e);return utils.anyIsError(t,o)?error.value:this.IMDIV(this.IMSIN(e),this.IMCOS(e))},s.OCT2BIN=function(e,t){if(!/^[0-7]{1,10}$/.test(e))return error.num;var o=10===e.length&&"7"===e.substring(0,1),e=o?parseInt(e,8)-1073741824:parseInt(e,8);if(e<-512||511<e)return error.num;if(o)return"1"+REPT("0",9-(512+e).toString(2).length)+(512+e).toString(2);o=e.toString(2);return void 0===t?o:isNaN(t)?error.value:!(t<0)&&(t=Math.floor(t))>=o.length?REPT("0",t-o.length)+o:error.num},s.OCT2DEC=function(e){if(!/^[0-7]{1,10}$/.test(e))return error.num;e=parseInt(e,8);return 536870912<=e?e-1073741824:e},s.OCT2HEX=function(e,t){if(!/^[0-7]{1,10}$/.test(e))return error.num;e=parseInt(e,8);if(536870912<=e)return"ff"+(e+3221225472).toString(16);e=e.toString(16);return void 0===t?e:isNaN(t)?error.value:!(t<0)&&(t=Math.floor(t))>=e.length?REPT("0",t-e.length)+e:error.num},s}(),met.financial=function(){var u={};function l(e){return e&&e.getTime&&!isNaN(e.getTime())}function a(e){return e instanceof Date?e:new Date(e)}return u.ACCRINT=function(e,t,o,n,r,i,s){return e=a(e),t=a(t),o=a(o),l(e)&&l(t)&&l(o)?n<=0||r<=0||-1===[1,2,4].indexOf(i)||-1===[0,1,2,3,4].indexOf(s)||o<=e?"#NUM!":(s=s||0,(r=r||0)*n*YEARFRAC(e,o,s)):"#VALUE!"},u.ACCRINTM=null,u.AMORDEGRC=null,u.AMORLINC=null,u.COUPDAYBS=null,u.COUPDAYS=null,u.COUPDAYSNC=null,u.COUPNCD=null,u.COUPNUM=null,u.COUPPCD=null,u.CUMIPMT=function(e,t,o,n,r,i){if(e=utils.parseNumber(e),t=utils.parseNumber(t),o=utils.parseNumber(o),utils.anyIsError(e,t,o))return error.value;if(e<=0||t<=0||o<=0)return error.num;if(n<1||r<1||r<n)return error.num;if(0!==i&&1!==i)return error.num;var s=u.PMT(e,t,o,0,i),l=0;1===n&&0===i&&(l=-o,n++);for(var a=n;a<=r;a++)l+=1===i?u.FV(e,a-2,s,o,1)-s:u.FV(e,a-1,s,o,0);return l*=e},u.CUMPRINC=function(e,t,o,n,r,i){if(e=utils.parseNumber(e),t=utils.parseNumber(t),o=utils.parseNumber(o),utils.anyIsError(e,t,o))return error.value;if(e<=0||t<=0||o<=0)return error.num;if(n<1||r<1||r<n)return error.num;if(0!==i&&1!==i)return error.num;var s=u.PMT(e,t,o,0,i),l=0;1===n&&(l=0===i?s+o*e:s,n++);for(var a=n;a<=r;a++)l+=0<i?s-(u.FV(e,a-2,s,o,1)-s)*e:s-u.FV(e,a-1,s,o,0)*e;return l},u.DB=function(e,t,o,n,r){if(r=void 0===r?12:r,e=utils.parseNumber(e),t=utils.parseNumber(t),o=utils.parseNumber(o),n=utils.parseNumber(n),r=utils.parseNumber(r),utils.anyIsError(e,t,o,n,r))return error.value;if(e<0||t<0||o<0||n<0)return error.num;if(-1===[1,2,3,4,5,6,7,8,9,10,11,12].indexOf(r))return error.num;if(o<n)return error.num;if(e<=t)return 0;for(var i=(1-Math.pow(t/e,1/o)).toFixed(3),t=e*i*r/12,s=t,l=0,a=n===o?o-1:n,u=2;u<=a;u++)s+=l=(e-s)*i;return 1===n?t:n===o?(e-s)*i:l},u.DDB=function(e,t,o,n,r){if(r=void 0===r?2:r,e=utils.parseNumber(e),t=utils.parseNumber(t),o=utils.parseNumber(o),n=utils.parseNumber(n),r=utils.parseNumber(r),utils.anyIsError(e,t,o,n,r))return error.value;if(e<0||t<0||o<0||n<0||r<=0)return error.num;if(o<n)return error.num;if(e<=t)return 0;for(var i=0,s=0,l=1;l<=n;l++)i+=s=Math.min(r/o*(e-i),e-t-i);return s},u.DISC=null,u.DOLLARDE=function(e,t){if(e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t))return error.value;if(t<0)return error.num;if(0<=t&&t<1)return error.div0;t=parseInt(t,10);var o=parseInt(e,10),e=(o+=e%1*Math.pow(10,Math.ceil(Math.log(t)/Math.LN10))/t,Math.pow(10,Math.ceil(Math.log(t)/Math.LN2)+1));return Math.round(o*e)/e},u.DOLLARFR=function(e,t){if(e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t))return error.value;if(t<0)return error.num;if(0<=t&&t<1)return error.div0;t=parseInt(t,10);var o=parseInt(e,10);return o+=e%1*Math.pow(10,-Math.ceil(Math.log(t)/Math.LN10))*t},u.DURATION=null,u.EFFECT=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:e<=0||t<1?error.num:(t=parseInt(t,10),Math.pow(1+e/t,t)-1)},u.FV=function(e,t,o,n,r){return n=n||0,r=r||0,e=utils.parseNumber(e),t=utils.parseNumber(t),o=utils.parseNumber(o),n=utils.parseNumber(n),r=utils.parseNumber(r),utils.anyIsError(e,t,o,n,r)?error.value:-(0===e?n+o*t:(t=Math.pow(1+e,t),1===r?n*t+o*(1+e)*(t-1)/e:n*t+o*(t-1)/e))},u.FVSCHEDULE=function(e,t){if(e=utils.parseNumber(e),t=utils.parseNumberArray(utils.flatten(t)),utils.anyIsError(e,t))return error.value;for(var o=t.length,n=e,r=0;r<o;r++)n*=1+t[r];return n},u.INTRATE=null,u.IPMT=function(e,t,o,n,r,i){if(r=r||0,i=i||0,e=utils.parseNumber(e),t=utils.parseNumber(t),o=utils.parseNumber(o),n=utils.parseNumber(n),r=utils.parseNumber(r),i=utils.parseNumber(i),utils.anyIsError(e,t,o,n,r,i))return error.value;o=u.PMT(e,o,n,r,i),r=1===t?1===i?0:-n:1===i?u.FV(e,t-2,o,n,1)-o:u.FV(e,t-1,o,n,0);return r*e},u.IRR=function(e,t){if(t=t||0,e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumber(t),utils.anyIsError(e,t))return error.value;for(var o=[],n=!1,r=!1,i=0;i<e.length;i++)o[i]=0===i?0:o[i-1]+365,0<e[i]&&(n=!0),e[i]<0&&(r=!0);if(!n||!r)return error.num;t=void 0===t?.1:t;for(var s,l,a,u=t;s=u-(a=function(e,t,o){for(var n=o+1,r=e[0],i=1;i<e.length;i++)r+=e[i]/Math.pow(n,(t[i]-t[0])/365);return r}(e,o,u))/function(e,t,o){for(var n=o+1,r=0,i=1;i<e.length;i++){var s=(t[i]-t[0])/365;r-=s*e[i]/Math.pow(n,1+s)}return r}(e,o,u),l=Math.abs(s-u),u=s,1e-10<l&&1e-10<Math.abs(a););return u},u.ISPMT=function(e,t,o,n){return e=utils.parseNumber(e),t=utils.parseNumber(t),o=utils.parseNumber(o),n=utils.parseNumber(n),utils.anyIsError(e,t,o,n)?error.value:n*e*(t/o-1)},u.MDURATION=null,u.MIRR=function(e,t,o){if(e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumber(t),o=utils.parseNumber(o),utils.anyIsError(e,t,o))return error.value;for(var n=e.length,r=[],i=[],s=0;s<n;s++)(e[s]<0?r:i).push(e[s]);o=-u.NPV(o,i)*Math.pow(1+o,n-1),t=u.NPV(t,r)*(1+t);return Math.pow(o/t,1/(n-1))-1},u.NOMINAL=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:e<=0||t<1?error.num:(t=parseInt(t,10),(Math.pow(e+1,1/t)-1)*t)},u.NPER=function(e,t,o,n,r){return r=void 0===r?0:r,n=void 0===n?0:n,e=utils.parseNumber(e),t=utils.parseNumber(t),o=utils.parseNumber(o),n=utils.parseNumber(n),r=utils.parseNumber(r),utils.anyIsError(e,t,o,n,r)?error.value:Math.log((t*(1+e*r)-n*e)/(o*e+t*(1+e*r)))/Math.log(1+e)},u.NPV=function(){var e=utils.parseNumberArray(utils.flatten(arguments));if(e instanceof Error)return e;for(var t=e[0],o=0,n=1;n<e.length;n++)o+=e[n]/Math.pow(1+t,n);return o},u.ODDFPRICE=null,u.ODDFYIELD=null,u.ODDLPRICE=null,u.ODDLYIELD=null,u.PDURATION=function(e,t,o){return e=utils.parseNumber(e),t=utils.parseNumber(t),o=utils.parseNumber(o),utils.anyIsError(e,t,o)?error.value:e<=0?error.num:(Math.log(o)-Math.log(t))/Math.log(1+e)},u.PMT=function(e,t,o,n,r){return n=n||0,r=r||0,e=utils.parseNumber(e),t=utils.parseNumber(t),o=utils.parseNumber(o),n=utils.parseNumber(n),r=utils.parseNumber(r),utils.anyIsError(e,t,o,n,r)?error.value:-(0===e?(o+n)/t:(t=Math.pow(1+e,t),1===r?(n*e/(t-1)+o*e/(1-1/t))/(1+e):n*e/(t-1)+o*e/(1-1/t)))},u.PPMT=function(e,t,o,n,r,i){return r=r||0,i=i||0,e=utils.parseNumber(e),o=utils.parseNumber(o),n=utils.parseNumber(n),r=utils.parseNumber(r),i=utils.parseNumber(i),utils.anyIsError(e,o,n,r,i)?error.value:u.PMT(e,o,n,r,i)-u.IPMT(e,t,o,n,r,i)},u.PRICE=null,u.PRICEDISC=null,u.PRICEMAT=null,u.PV=function(e,t,o,n,r){return n=n||0,r=r||0,e=utils.parseNumber(e),t=utils.parseNumber(t),o=utils.parseNumber(o),n=utils.parseNumber(n),r=utils.parseNumber(r),utils.anyIsError(e,t,o,n,r)?error.value:0===e?-o*t-n:((1-Math.pow(1+e,t))/e*o*(1+e*r)-n)/Math.pow(1+e,t)},u.RATE=function(e,t,o,n,r,i){if(i=void 0===i?.01:i,n=void 0===n?0:n,r=void 0===r?0:r,e=utils.parseNumber(e),t=utils.parseNumber(t),o=utils.parseNumber(o),n=utils.parseNumber(n),r=utils.parseNumber(r),i=utils.parseNumber(i),utils.anyIsError(e,t,o,n,r,i))return error.value;for(var s=0,l=!1,a=i;s<100&&!l;){var u=Math.pow(a+1,e),c=Math.pow(a+1,e-1),c=a-(n+u*o+t*(u-1)*(a*r+1)/a)/(e*c*o-t*(u-1)*(a*r+1)/Math.pow(a,2)+(e*t*c*(a*r+1)/a+t*(u-1)*r/a));Math.abs(c-a)<1e-6&&(l=!0),s++,a=c}return l?a:Number.NaN+a},u.RECEIVED=null,u.RRI=function(e,t,o){return e=utils.parseNumber(e),t=utils.parseNumber(t),o=utils.parseNumber(o),utils.anyIsError(e,t,o)?error.value:0===e||0===t?error.num:Math.pow(o/t,1/e)-1},u.SLN=function(e,t,o){return e=utils.parseNumber(e),t=utils.parseNumber(t),o=utils.parseNumber(o),utils.anyIsError(e,t,o)?error.value:0===o?error.num:(e-t)/o},u.SYD=function(e,t,o,n){return e=utils.parseNumber(e),t=utils.parseNumber(t),o=utils.parseNumber(o),n=utils.parseNumber(n),utils.anyIsError(e,t,o,n)?error.value:0===o||n<1||o<n?error.num:(e-t)*(o-(n=parseInt(n,10))+1)*2/(o*(o+1))},u.TBILLEQ=function(e,t,o){return e=utils.parseDate(e),t=utils.parseDate(t),o=utils.parseNumber(o),utils.anyIsError(e,t,o)?error.value:o<=0||t<e||31536e6<t-e?error.num:365*o/(360-o*DAYS360(e,t,!1))},u.TBILLPRICE=function(e,t,o){return e=utils.parseDate(e),t=utils.parseDate(t),o=utils.parseNumber(o),utils.anyIsError(e,t,o)?error.value:o<=0||t<e||31536e6<t-e?error.num:100*(1-o*DAYS360(e,t,!1)/360)},u.TBILLYIELD=function(e,t,o){return e=utils.parseDate(e),t=utils.parseDate(t),o=utils.parseNumber(o),utils.anyIsError(e,t,o)?error.value:o<=0||t<e||31536e6<t-e?error.num:360*(100-o)/(o*DAYS360(e,t,!1))},u.VDB=null,u.XIRR=function(e,t,o){if(e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseDateArray(utils.flatten(t)),o=utils.parseNumber(o),utils.anyIsError(e,t,o))return error.value;for(var n=!1,r=!1,i=0;i<e.length;i++)0<e[i]&&(n=!0),e[i]<0&&(r=!0);if(!n||!r)return error.num;o=o||.1;for(var s,l,a,u=o;s=u-(a=function(e,t,o){for(var n=o+1,r=e[0],i=1;i<e.length;i++)r+=e[i]/Math.pow(n,DAYS(t[i],t[0])/365);return r}(e,t,u))/function(e,t,o){for(var n=o+1,r=0,i=1;i<e.length;i++){var s=DAYS(t[i],t[0])/365;r-=s*e[i]/Math.pow(n,1+s)}return r}(e,t,u),l=Math.abs(s-u),u=s,1e-10<l&&1e-10<Math.abs(a););return u},u.XNPV=function(e,t,o){if(e=utils.parseNumber(e),t=utils.parseNumberArray(utils.flatten(t)),o=utils.parseDateArray(utils.flatten(o)),utils.anyIsError(e,t,o))return error.value;for(var n=0,r=0;r<t.length;r++)n+=t[r]/Math.pow(1+e,DAYS(o[r],o[0])/365);return n},u.YIELD=null,u.YIELDDISC=null,u.YIELDMAT=null,u}(),met.information=function(){var t={CELL:null,ERROR:{}};return t.ERROR.TYPE=function(e){switch(e){case error.nil:return 1;case error.div0:return 2;case error.value:return 3;case error.ref:return 4;case error.name:return 5;case error.num:return 6;case error.na:return 7;case error.data:return 8}return error.na},t.INFO=null,t.ISBLANK=function(e){return null===e},t.ISBINARY=function(e){return/^[01]{1,10}$/.test(e)},t.ISERR=function(e){return 0<=[error.value,error.ref,error.div0,error.num,error.name,error.nil].indexOf(e)||"number"==typeof e&&(isNaN(e)||!isFinite(e))},t.ISERROR=function(e){return t.ISERR(e)||e===error.na},t.ISEVEN=function(e){return!(1&Math.floor(Math.abs(e)))},t.ISFORMULA=null,t.ISLOGICAL=function(e){return!0===e||!1===e},t.ISNA=function(e){return e===error.na},t.ISNONTEXT=function(e){return"string"!=typeof e},t.ISNUMBER=function(e){return"number"==typeof e&&!isNaN(e)&&isFinite(e)},t.ISODD=function(e){return!!(1&Math.floor(Math.abs(e)))},t.ISREF=null,t.ISTEXT=function(e){return"string"==typeof e},t.N=function(e){return this.ISNUMBER(e)?e:e instanceof Date?e.getTime():!0===e?1:!1!==e&&this.ISERROR(e)?e:0},t.NA=function(){return error.na},t.SHEET=null,t.SHEETS=null,t.TYPE=function(e){return this.ISNUMBER(e)?1:this.ISTEXT(e)?2:this.ISLOGICAL(e)?4:this.ISERROR(e)?16:Array.isArray(e)?64:void 0},t}(),met.logical=function(){var e={AND:function(){for(var e=utils.flatten(arguments),t=!0,o=0;o<e.length;o++)e[o]||(t=!1);return t},CHOOSE:function(){if(arguments.length<2)return error.na;var e=arguments[0];return e<1||254<e||arguments.length<e+1?error.value:arguments[e]},FALSE:function(){return!1},IF:function(e,t,o){return e?t:o},IFERROR:function(e,t){return ISERROR(e)?t:e},IFNA:function(e,t){return e===error.na?t:e},NOT:function(e){return!e},OR:function(){for(var e=utils.flatten(arguments),t=!1,o=0;o<e.length;o++)e[o]&&(t=!0);return t},TRUE:function(){return!0},XOR:function(){for(var e=utils.flatten(arguments),t=0,o=0;o<e.length;o++)e[o]&&t++;return!!(1&Math.floor(Math.abs(t)))},SWITCH:function(){var e;if(0<arguments.length){var t=arguments[0],o=arguments.length-1,n=Math.floor(o/2),r=!1,o=o%2==0?null:arguments[arguments.length-1];if(n)for(var i=0;i<n;i++)if(t===arguments[2*i+1]){e=arguments[2*i+2],r=!0;break}!r&&o&&(e=o)}return e}};return e}(),met.math=function(){var exports={ABS:function(e){return(e=utils.parseNumber(e))instanceof Error?e:Math.abs(utils.parseNumber(e))},ACOS:function(e){return(e=utils.parseNumber(e))instanceof Error?e:Math.acos(e)},ACOSH:function(e){return(e=utils.parseNumber(e))instanceof Error?e:Math.log(e+Math.sqrt(e*e-1))},ACOT:function(e){return(e=utils.parseNumber(e))instanceof Error?e:Math.atan(1/e)},ACOTH:function(e){return(e=utils.parseNumber(e))instanceof Error?e:.5*Math.log((e+1)/(e-1))},AGGREGATE:null,ARABIC:function(e){if(!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(e))return error.value;var t=0;return e.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g,function(e){t+={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1}[e]}),t},ASIN:function(e){return(e=utils.parseNumber(e))instanceof Error?e:Math.asin(e)},ASINH:function(e){return(e=utils.parseNumber(e))instanceof Error?e:Math.log(e+Math.sqrt(e*e+1))},ATAN:function(e){return(e=utils.parseNumber(e))instanceof Error?e:Math.atan(e)},ATAN2:function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:Math.atan2(e,t)},ATANH:function(e){return(e=utils.parseNumber(e))instanceof Error?e:Math.log((1+e)/(1-e))/2},BASE:function(e,t,o){if(o=o||0,e=utils.parseNumber(e),t=utils.parseNumber(t),o=utils.parseNumber(o),utils.anyIsError(e,t,o))return error.value;o=void 0===o?0:o;e=e.toString(t);return new Array(Math.max(o+1-e.length,0)).join("0")+e},CEILING:function(e,t,o){return t=void 0===t?1:t,o=void 0===o?0:o,e=utils.parseNumber(e),t=utils.parseNumber(t),o=utils.parseNumber(o),utils.anyIsError(e,t,o)?error.value:0===t?0:(t=Math.abs(t),0<=e?Math.ceil(e/t)*t:0===o?-1*Math.floor(Math.abs(e)/t)*t:-1*Math.ceil(Math.abs(e)/t)*t)}},MEMOIZED_FACT=(exports.CEILING.MATH=exports.CEILING,exports.CEILING.PRECISE=exports.CEILING,exports.COMBIN=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:exports.FACT(e)/(exports.FACT(t)*exports.FACT(e-t))},exports.COMBINA=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:0===e&&0===t?1:exports.COMBIN(e+t-1,e-1)},exports.COS=function(e){return(e=utils.parseNumber(e))instanceof Error?e:Math.cos(e)},exports.COSH=function(e){return(e=utils.parseNumber(e))instanceof Error?e:(Math.exp(e)+Math.exp(-e))/2},exports.COT=function(e){return(e=utils.parseNumber(e))instanceof Error?e:1/Math.tan(e)},exports.COTH=function(e){if((e=utils.parseNumber(e))instanceof Error)return e;e=Math.exp(2*e);return(e+1)/(e-1)},exports.CSC=function(e){return(e=utils.parseNumber(e))instanceof Error?e:1/Math.sin(e)},exports.CSCH=function(e){return(e=utils.parseNumber(e))instanceof Error?e:2/(Math.exp(e)-Math.exp(-e))},exports.DECIMAL=function(e,t){return arguments.length<1?error.value:parseInt(e,t)},exports.DEGREES=function(e){return(e=utils.parseNumber(e))instanceof Error?e:180*e/Math.PI},exports.EVEN=function(e){return(e=utils.parseNumber(e))instanceof Error?e:exports.CEILING(e,-2,-1)},exports.EXP=Math.exp,[]);return exports.FACT=function(e){if((e=utils.parseNumber(e))instanceof Error)return e;e=Math.floor(e);return 0===e||1===e?1:(0<MEMOIZED_FACT[e]||(MEMOIZED_FACT[e]=exports.FACT(e-1)*e),MEMOIZED_FACT[e])},exports.FACTDOUBLE=function(e){if((e=utils.parseNumber(e))instanceof Error)return e;e=Math.floor(e);return e<=0?1:e*exports.FACTDOUBLE(e-2)},exports.FLOOR=function(e,t,o){return t=void 0===t?1:t,o=void 0===o?0:o,e=utils.parseNumber(e),t=utils.parseNumber(t),o=utils.parseNumber(o),utils.anyIsError(e,t,o)?error.value:0===t?0:(t=Math.abs(t),0<=e?Math.floor(e/t)*t:0===o?-1*Math.ceil(Math.abs(e)/t)*t:-1*Math.floor(Math.abs(e)/t)*t)},exports.FLOOR.MATH=exports.FLOOR,exports.GCD=null,exports.INT=function(e){return(e=utils.parseNumber(e))instanceof Error?e:Math.floor(e)},exports.LCM=function(){var e=utils.parseNumberArray(utils.flatten(arguments));if(e instanceof Error)return e;for(var t,o,n,r,i=1;void 0!==(n=e.pop());)for(;1<n;){if(n%2){for(t=3,o=Math.floor(Math.sqrt(n));t<=o&&n%t;t+=2);r=t<=o?t:n}else r=2;for(n/=r,i*=r,t=e.length;t;e[--t]%r==0&&1==(e[t]/=r)&&e.splice(t,1));}return i},exports.LN=function(e){return(e=utils.parseNumber(e))instanceof Error?e:Math.log(e)},exports.LOG=function(e,t){return e=utils.parseNumber(e),t=void 0===t?10:utils.parseNumber(t),utils.anyIsError(e,t)?error.value:Math.log(e)/Math.log(t)},exports.LOG10=function(e){return(e=utils.parseNumber(e))instanceof Error?e:Math.log(e)/Math.log(10)},exports.MDETERM=null,exports.MINVERSE=null,exports.MMULT=null,exports.MOD=function(e,t){if(e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t))return error.value;if(0===t)return error.div0;e=Math.abs(e%t);return 0<t?e:-e},exports.MROUND=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:e*t<0?error.num:Math.round(e/t)*t},exports.MULTINOMIAL=function(){var e=utils.parseNumberArray(utils.flatten(arguments));if(e instanceof Error)return e;for(var t=0,o=1,n=0;n<e.length;n++)t+=e[n],o*=exports.FACT(e[n]);return exports.FACT(t)/o},exports.MUNIT=null,exports.ODD=function(e){if((e=utils.parseNumber(e))instanceof Error)return e;var t=1&(t=Math.ceil(Math.abs(e)))?t:t+1;return 0<e?t:-t},exports.PI=function(){return Math.PI},exports.POWER=function(e,t){if(e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t))return error.value;e=Math.pow(e,t);return isNaN(e)?error.num:e},exports.PRODUCT=function(){var e=utils.parseNumberArray(utils.flatten(arguments));if(e instanceof Error)return e;for(var t=1,o=0;o<e.length;o++)t*=e[o];return t},exports.QUOTIENT=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:parseInt(e/t,10)},exports.RADIANS=function(e){return(e=utils.parseNumber(e))instanceof Error?e:e*Math.PI/180},exports.RAND=function(){return Math.random()},exports.RANDBETWEEN=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:e+Math.ceil((t-e+1)*Math.random())-1},exports.ROMAN=null,exports.ROUND=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:Math.round(e*Math.pow(10,t))/Math.pow(10,t)},exports.ROUNDDOWN=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:(0<e?1:-1)*Math.floor(Math.abs(e)*Math.pow(10,t))/Math.pow(10,t)},exports.ROUNDUP=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:(0<e?1:-1)*Math.ceil(Math.abs(e)*Math.pow(10,t))/Math.pow(10,t)},exports.SEC=function(e){return(e=utils.parseNumber(e))instanceof Error?e:1/Math.cos(e)},exports.SECH=function(e){return(e=utils.parseNumber(e))instanceof Error?e:2/(Math.exp(e)+Math.exp(-e))},exports.SERIESSUM=function(e,t,o,n){if(e=utils.parseNumber(e),t=utils.parseNumber(t),o=utils.parseNumber(o),n=utils.parseNumberArray(n),utils.anyIsError(e,t,o,n))return error.value;for(var r=n[0]*Math.pow(e,t),i=1;i<n.length;i++)r+=n[i]*Math.pow(e,t+i*o);return r},exports.SIGN=function(e){return(e=utils.parseNumber(e))instanceof Error?e:e<0?-1:0===e?0:1},exports.SIN=function(e){return(e=utils.parseNumber(e))instanceof Error?e:Math.sin(e)},exports.SINH=function(e){return(e=utils.parseNumber(e))instanceof Error?e:(Math.exp(e)-Math.exp(-e))/2},exports.SQRT=function(e){return(e=utils.parseNumber(e))instanceof Error?e:e<0?error.num:Math.sqrt(e)},exports.SQRTPI=function(e){return(e=utils.parseNumber(e))instanceof Error?e:Math.sqrt(e*Math.PI)},exports.SUBTOTAL=null,exports.ADD=function(e,t){return 2!==arguments.length?error.na:(e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:e+t)},exports.MINUS=function(e,t){return 2!==arguments.length?error.na:(e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:e-t)},exports.DIVIDE=function(e,t){return 2!==arguments.length?error.na:(e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:0===t?error.div0:e/t)},exports.MULTIPLY=function(e,t){return 2!==arguments.length?error.na:(e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:e*t)},exports.GTE=function(e,t){return 2!==arguments.length?error.na:(e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.error:t<=e)},exports.LT=function(e,t){return 2!==arguments.length?error.na:(e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.error:e<t)},exports.LTE=function(e,t){return 2!==arguments.length?error.na:(e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.error:e<=t)},exports.EQ=function(e,t){return 2!==arguments.length?error.na:e===t},exports.NE=function(e,t){return 2!==arguments.length?error.na:e!==t},exports.POW=function(e,t){return 2!==arguments.length?error.na:(e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.error:exports.POWER(e,t))},exports.SUM=function(){for(var e=0,t=Object.keys(arguments),o=0;o<t.length;++o){var n,r=arguments[t[o]];"number"==typeof r?e+=r:"string"==typeof r?(n=parseFloat(r),isNaN(n)||(e+=n)):Array.isArray(r)&&(e+=exports.SUM.apply(null,r))}return e},exports.SUMIF=function(){var args=utils.argsToArray(arguments),criteria=args.pop(),range=utils.parseNumberArray(utils.flatten(args));if(range instanceof Error)return range;for(var result=0,i=0;i<range.length;i++)result+=eval(range[i]+criteria)?range[i]:0;return result},exports.SUMIFS=function(){var args=utils.argsToArray(arguments),range=utils.parseNumberArray(utils.flatten(args.shift()));if(range instanceof Error)return range;for(var criteria=args,n_range_elements=range.length,n_criterias=criteria.length,result=0,i=0;i<n_range_elements;i++){for(var el=range[i],condition="",c=0;c<n_criterias;c+=2)isNaN(criteria[c][i])?condition+='"'+criteria[c][i]+'"'+criteria[c+1]:condition+=criteria[c][i]+criteria[c+1],c!==n_criterias-1&&(condition+=" && ");condition=condition.slice(0,-4),eval(condition)&&(result+=el)}return result},exports.SUMPRODUCT=null,exports.SUMSQ=function(){var e=utils.parseNumberArray(utils.flatten(arguments));if(e instanceof Error)return e;for(var t=0,o=e.length,n=0;n<o;n++)t+=ISNUMBER(e[n])?e[n]*e[n]:0;return t},exports.SUMX2MY2=function(e,t){if(e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumberArray(utils.flatten(t)),utils.anyIsError(e,t))return error.value;for(var o=0,n=0;n<e.length;n++)o+=e[n]*e[n]-t[n]*t[n];return o},exports.SUMX2PY2=function(e,t){if(e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumberArray(utils.flatten(t)),utils.anyIsError(e,t))return error.value;var o=0;e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumberArray(utils.flatten(t));for(var n=0;n<e.length;n++)o+=e[n]*e[n]+t[n]*t[n];return o},exports.SUMXMY2=function(e,t){if(e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumberArray(utils.flatten(t)),utils.anyIsError(e,t))return error.value;var o=0;e=utils.flatten(e),t=utils.flatten(t);for(var n=0;n<e.length;n++)o+=Math.pow(e[n]-t[n],2);return o},exports.TAN=function(e){return(e=utils.parseNumber(e))instanceof Error?e:Math.tan(e)},exports.TANH=function(e){if((e=utils.parseNumber(e))instanceof Error)return e;e=Math.exp(2*e);return(e-1)/(e+1)},exports.TRUNC=function(e,t){return t=void 0===t?0:t,e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:(0<e?1:-1)*Math.floor(Math.abs(e)*Math.pow(10,t))/Math.pow(10,t)},exports}(),met.misc=function(){var e={UNIQUE:function(){for(var e=[],t=0;t<arguments.length;++t){for(var o=!1,n=arguments[t],r=0;r<e.length&&!(o=e[r]===n);++r);o||e.push(n)}return e}};return e.FLATTEN=utils.flatten,e.ARGS2ARRAY=function(){return Array.prototype.slice.call(arguments,0)},e.REFERENCE=function(e,t){try{for(var o=t.split("."),n=e,r=0;r<o.length;++r){var i,s,l=o[r];n="]"===l[l.length-1]?(i=l.indexOf("["),s=l.substring(i+1,l.length-1),n[l.substring(0,i)][s]):n[l]}return n}catch(e){}},e.JOIN=function(e,t){return e.join(t)},e.NUMBERS=function(){return utils.flatten(arguments).filter(function(e){return"number"==typeof e})},e.NUMERAL=null,e}(),met.text=function(){var e={ASC:null,BAHTTEXT:null,CHAR:function(e){return(e=utils.parseNumber(e))instanceof Error?e:String.fromCharCode(e)},CLEAN:function(e){return(e=e||"").replace(/[\0-\x1F]/g,"")},CODE:function(e){return(e=e||"").charCodeAt(0)},CONCATENATE:function(){for(var e,t=utils.flatten(arguments);-1<(e=t.indexOf(!0));)t[e]="TRUE";for(var o;-1<(o=t.indexOf(!1));)t[o]="FALSE";return t.join("")},DBCS:null,DOLLAR:null,EXACT:function(e,t){return e===t},FIND:function(e,t,o){return o=void 0===o?0:o,t?t.indexOf(e,o-1)+1:null},FIXED:null,HTML2TEXT:function(e){var t="";return e&&(e instanceof Array?e.forEach(function(e){""!==t&&(t+="\n"),t+=e.replace(/<(?:.|\n)*?>/gm,"")}):t=e.replace(/<(?:.|\n)*?>/gm,"")),t},LEFT:function(e,t){return(t=utils.parseNumber(t=void 0===t?1:t))instanceof Error||"string"!=typeof e?error.value:e?e.substring(0,t):null},LEN:function(e){return 0===arguments.length?error.error:"string"==typeof e?e?e.length:0:e.length||error.value},LOWER:function(e){return"string"!=typeof e?error.value:e&&e.toLowerCase()},MID:function(e,t,o){if(t=utils.parseNumber(t),o=utils.parseNumber(o),utils.anyIsError(t,o)||"string"!=typeof e)return o;t-=1;return e.substring(t,t+o)},NUMBERVALUE:null,PRONETIC:null,PROPER:function(e){return void 0===e||0===e.length?error.value:(!1===(e=!0===e?"TRUE":e)&&(e="FALSE"),isNaN(e)&&"number"==typeof e?error.value:(e="number"==typeof e?""+e:e).replace(/\w\S*/g,function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()}))},REGEXEXTRACT:function(e,t){e=e.match(new RegExp(t));return e?e[1<e.length?e.length-1:0]:null},REGEXMATCH:function(e,t,o){e=e.match(new RegExp(t));return o?e:!!e},REGEXREPLACE:function(e,t,o){return e.replace(new RegExp(t),o)},REPLACE:function(e,t,o,n){return t=utils.parseNumber(t),o=utils.parseNumber(o),utils.anyIsError(t,o)||"string"!=typeof e||"string"!=typeof n?error.value:e.substr(0,t-1)+n+e.substr(t-1+o)},REPT:function(e,t){return(t=utils.parseNumber(t))instanceof Error?t:new Array(t+1).join(e)},RIGHT:function(e,t){return(t=utils.parseNumber(t=void 0===t?1:t))instanceof Error?t:e?e.substring(e.length-t):null},SEARCH:function(e,t,o){return"string"!=typeof e||"string"!=typeof t?error.value:(o=void 0===o?0:o,0===(t=t.toLowerCase().indexOf(e.toLowerCase(),o-1)+1)?error.value:t)},SPLIT:function(e,t){return e.split(t)},SUBSTITUTE:function(e,t,o,n){if(!(e&&t&&o))return e;if(void 0===n)return e.replace(new RegExp(t,"g"),o);for(var r=0,i=0;0<e.indexOf(t,r);)if(r=e.indexOf(t,r+1),++i===n)return e.substring(0,r)+o+e.substring(r+t.length)},T:function(e){return"string"==typeof e?e:""},TEXT:null,TRIM:function(e){return"string"!=typeof e?error.value:e.replace(/ +/g," ").trim()}};return e.UNICHAR=e.CHAR,e.UNICODE=e.CODE,e.UPPER=function(e){return"string"!=typeof e?error.value:e.toUpperCase()},e.VALUE=null,e}(),met.stats=function(){var exports={},SQRT2PI=2.5066282746310002;return exports.AVEDEV=null,exports.AVERAGE=function(){for(var e=utils.numbers(utils.flatten(arguments)),t=e.length,o=0,n=0,r=0;r<t;r++)o+=e[r],n+=1;return o/n},exports.AVERAGEA=function(){for(var e=utils.flatten(arguments),t=e.length,o=0,n=0,r=0;r<t;r++){var i=e[r];"number"==typeof i&&(o+=i),!0===i&&o++,null!==i&&n++}return o/n},exports.AVERAGEIF=function(range,criteria,average_range){if(average_range=average_range||range,range=utils.flatten(range),average_range=utils.parseNumberArray(utils.flatten(average_range)),average_range instanceof Error)return average_range;for(var average_count=0,result=0,i=0;i<range.length;i++)eval(range[i]+criteria)&&(result+=average_range[i],average_count++);return result/average_count},exports.AVERAGEIFS=null,exports.COUNT=function(){return utils.numbers(utils.flatten(arguments)).length},exports.COUNTA=function(){var e=utils.flatten(arguments);return e.length-exports.COUNTBLANK(e)},exports.COUNTIN=function(e,t){for(var o=0,n=0;n<e.length;n++)e[n]===t&&o++;return o},exports.COUNTBLANK=function(){for(var e,t=utils.flatten(arguments),o=0,n=0;n<t.length;n++)null!==(e=t[n])&&""!==e||o++;return o},exports.COUNTIF=function(){for(var args=utils.argsToArray(arguments),criteria=args.pop(),range=utils.flatten(args),matches=(/[<>=!]/.test(criteria)||(criteria='=="'+criteria+'"'),0),i=0;i<range.length;i++)"string"!=typeof range[i]?eval(range[i]+criteria)&&matches++:eval('"'+range[i]+'"'+criteria)&&matches++;return matches},exports.COUNTIFS=function(){for(var args=utils.argsToArray(arguments),results=new Array(utils.flatten(args[0]).length),i=0;i<results.length;i++)results[i]=!0;for(i=0;i<args.length;i+=2){var range=utils.flatten(args[i]),criteria=args[i+1];/[<>=!]/.test(criteria)||(criteria='=="'+criteria+'"');for(var j=0;j<range.length;j++)"string"!=typeof range[j]?results[j]=results[j]&&eval(range[j]+criteria):results[j]=results[j]&&eval('"'+range[j]+'"'+criteria)}for(var result=0,i=0;i<results.length;i++)results[i]&&result++;return result},exports.COUNTUNIQUE=function(){return UNIQUE.apply(null,utils.flatten(arguments)).length},exports.FISHER=function(e){return(e=utils.parseNumber(e))instanceof Error?e:Math.log((1+e)/(1-e))/2},exports.FISHERINV=function(e){if((e=utils.parseNumber(e))instanceof Error)return e;e=Math.exp(2*e);return(e-1)/(e+1)},exports.FREQUENCY=function(e,t){if(e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumberArray(utils.flatten(t)),utils.anyIsError(e,t))return error.value;for(var o=e.length,n=t.length,r=[],i=0;i<=n;i++)for(var s=r[i]=0;s<o;s++)0===i?e[s]<=t[0]&&(r[0]+=1):i<n?e[s]>t[i-1]&&e[s]<=t[i]&&(r[i]+=1):i===n&&e[s]>t[n-1]&&(r[n]+=1);return r},exports.LARGE=function(e,t){return e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumber(t),utils.anyIsError(e,t)?e:e.sort(function(e,t){return t-e})[t-1]},exports.MAX=function(){var e=utils.numbers(utils.flatten(arguments));return 0===e.length?0:Math.max.apply(Math,e)},exports.MAXA=function(){var e=utils.arrayValuesToNumbers(utils.flatten(arguments));return 0===e.length?0:Math.max.apply(Math,e)},exports.MIN=function(){var e=utils.numbers(utils.flatten(arguments));return 0===e.length?0:Math.min.apply(Math,e)},exports.MINA=function(){var e=utils.arrayValuesToNumbers(utils.flatten(arguments));return 0===e.length?0:Math.min.apply(Math,e)},exports.MODE={},exports.MODE.MULT=function(){var e=utils.parseNumberArray(utils.flatten(arguments));if(e instanceof Error)return e;for(var t,o=e.length,n={},r=[],i=0,s=0;s<o;s++)n[t=e[s]]=n[t]?n[t]+1:1,n[t]>i&&(i=n[t],r=[]),n[t]===i&&(r[r.length]=t);return r},exports.MODE.SNGL=function(){var e=utils.parseNumberArray(utils.flatten(arguments));return e instanceof Error?e:exports.MODE.MULT(e).sort(function(e,t){return e-t})[0]},exports.PERCENTILE={},exports.PERCENTILE.EXC=function(e,t){if(e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumber(t),utils.anyIsError(e,t))return error.value;var o=(e=e.sort(function(e,t){return e-t})).length;if(t<1/(o+1)||1-1/(o+1)<t)return error.num;t=t*(o+1)-1,o=Math.floor(t);return utils.cleanFloat(t===o?e[t]:e[o]+(t-o)*(e[o+1]-e[o]))},exports.PERCENTILE.INC=function(e,t){if(e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumber(t),utils.anyIsError(e,t))return error.value;var t=t*((e=e.sort(function(e,t){return e-t})).length-1),o=Math.floor(t);return utils.cleanFloat(t===o?e[t]:e[o]+(t-o)*(e[o+1]-e[o]))},exports.PERCENTRANK={},exports.PERCENTRANK.EXC=function(e,t,o){if(o=void 0===o?3:o,e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumber(t),o=utils.parseNumber(o),utils.anyIsError(e,t,o))return error.value;e=e.sort(function(e,t){return e-t});for(var n=UNIQUE.apply(null,e),r=e.length,i=n.length,o=Math.pow(10,o),s=0,l=!1,a=0;!l&&a<i;)t===n[a]?(s=(e.indexOf(n[a])+1)/(r+1),l=!0):t>=n[a]&&(t<n[a+1]||a===i-1)&&(s=(e.indexOf(n[a])+1+(t-n[a])/(n[a+1]-n[a]))/(r+1),l=!0),a++;return Math.floor(s*o)/o},exports.PERCENTRANK.INC=function(e,t,o){if(o=void 0===o?3:o,e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumber(t),o=utils.parseNumber(o),utils.anyIsError(e,t,o))return error.value;e=e.sort(function(e,t){return e-t});for(var n=UNIQUE.apply(null,e),r=e.length,i=n.length,o=Math.pow(10,o),s=0,l=!1,a=0;!l&&a<i;)t===n[a]?(s=e.indexOf(n[a])/(r-1),l=!0):t>=n[a]&&(t<n[a+1]||a===i-1)&&(s=(e.indexOf(n[a])+(t-n[a])/(n[a+1]-n[a]))/(r-1),l=!0),a++;return Math.floor(s*o)/o},exports.PERMUT=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:FACT(e)/FACT(e-t)},exports.PERMUTATIONA=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:Math.pow(e,t)},exports.PHI=function(e){return(e=utils.parseNumber(e))instanceof Error?error.value:Math.exp(-.5*e*e)/SQRT2PI},exports.PROB=function(e,t,o,n){if(void 0===o)return 0;if(n=void 0===n?o:n,e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumberArray(utils.flatten(t)),o=utils.parseNumber(o),n=utils.parseNumber(n),utils.anyIsError(e,t,o,n))return error.value;if(o===n)return 0<=e.indexOf(o)?t[e.indexOf(o)]:0;for(var r=e.sort(function(e,t){return e-t}),i=r.length,s=0,l=0;l<i;l++)r[l]>=o&&r[l]<=n&&(s+=t[e.indexOf(r[l])]);return s},exports.QUARTILE={},exports.QUARTILE.EXC=function(e,t){if(e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumber(t),utils.anyIsError(e,t))return error.value;switch(t){case 1:return exports.PERCENTILE.EXC(e,.25);case 2:return exports.PERCENTILE.EXC(e,.5);case 3:return exports.PERCENTILE.EXC(e,.75);default:return error.num}},exports.QUARTILE.INC=function(e,t){if(e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumber(t),utils.anyIsError(e,t))return error.value;switch(t){case 1:return exports.PERCENTILE.INC(e,.25);case 2:return exports.PERCENTILE.INC(e,.5);case 3:return exports.PERCENTILE.INC(e,.75);default:return error.num}},exports.RANK={},exports.RANK.AVG=function(e,t,o){if(e=utils.parseNumber(e),t=utils.parseNumberArray(utils.flatten(t)),utils.anyIsError(e,t))return error.value;for(var n=(t=(t=utils.flatten(t)).sort((o=o||!1)?function(e,t){return e-t}:function(e,t){return t-e})).length,r=0,i=0;i<n;i++)t[i]===e&&r++;return 1<r?(2*t.indexOf(e)+r+1)/2:t.indexOf(e)+1},exports.RANK.EQ=function(e,t,o){return e=utils.parseNumber(e),t=utils.parseNumberArray(utils.flatten(t)),utils.anyIsError(e,t)?error.value:(t=t.sort((o=o||!1)?function(e,t){return e-t}:function(e,t){return t-e})).indexOf(e)+1},exports.RSQ=function(e,t){return e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumberArray(utils.flatten(t)),utils.anyIsError(e,t)?error.value:Math.pow(exports.PEARSON(e,t),2)},exports.SMALL=function(e,t){return e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumber(t),utils.anyIsError(e,t)?e:e.sort(function(e,t){return e-t})[t-1]},exports.STANDARDIZE=function(e,t,o){return e=utils.parseNumber(e),t=utils.parseNumber(t),o=utils.parseNumber(o),utils.anyIsError(e,t,o)?error.value:(e-t)/o},exports.STDEV={},exports.STDEV.P=function(){var e=exports.VAR.P.apply(this,arguments);return Math.sqrt(e)},exports.STDEV.S=function(){var e=exports.VAR.S.apply(this,arguments);return Math.sqrt(e)},exports.STDEVA=function(){var e=exports.VARA.apply(this,arguments);return Math.sqrt(e)},exports.STDEVPA=function(){var e=exports.VARPA.apply(this,arguments);return Math.sqrt(e)},exports.VAR={},exports.VAR.P=function(){for(var e=utils.numbers(utils.flatten(arguments)),t=e.length,o=0,n=exports.AVERAGE(e),r=0;r<t;r++)o+=Math.pow(e[r]-n,2);return o/t},exports.VAR.S=function(){for(var e=utils.numbers(utils.flatten(arguments)),t=e.length,o=0,n=exports.AVERAGE(e),r=0;r<t;r++)o+=Math.pow(e[r]-n,2);return o/(t-1)},exports.VARA=function(){for(var e=utils.flatten(arguments),t=e.length,o=0,n=0,r=exports.AVERAGEA(e),i=0;i<t;i++){var s=e[i];o+="number"==typeof s?Math.pow(s-r,2):!0===s?Math.pow(1-r,2):Math.pow(0-r,2),null!==s&&n++}return o/(n-1)},exports.VARPA=function(){for(var e=utils.flatten(arguments),t=e.length,o=0,n=0,r=exports.AVERAGEA(e),i=0;i<t;i++){var s=e[i];o+="number"==typeof s?Math.pow(s-r,2):!0===s?Math.pow(1-r,2):Math.pow(0-r,2),null!==s&&n++}return o/n},exports.WEIBULL={},exports.WEIBULL.DIST=function(e,t,o,n){return e=utils.parseNumber(e),t=utils.parseNumber(t),o=utils.parseNumber(o),utils.anyIsError(e,t,o)?error.value:n?1-Math.exp(-Math.pow(e/o,t)):Math.pow(e,t-1)*Math.exp(-Math.pow(e/o,t))*t/Math.pow(o,t)},exports.Z={},exports.Z.TEST=function(e,t,o){if(e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumber(t),utils.anyIsError(e,t))return error.value;o=o||exports.STDEV.S(e);var n=e.length;return 1-exports.NORM.S.DIST((exports.AVERAGE(e)-t)/(o/Math.sqrt(n)),!0)},exports}(),met.utils=function(){var e={PROGRESS:function(e,t){return'<div style="width:'+(e||"0")+"%;height:4px;background-color:"+(t||"red")+';margin-top:1px;"></div>'},RATING:function(e){for(var t='<div class="jrating">',o=0;o<5;o++)t+=o<e?'<div class="jrating-selected"></div>':"<div></div>";return t+="</div>"}};return e}();for(var i=0;i<Object.keys(met).length;i++)for(var methods=met[Object.keys(met)[i]],keys=Object.keys(methods),j=0;j<keys.length;j++)if(methods[keys[j]])if("function"==typeof methods[keys[j]]||"object"==typeof methods[keys[j]]){if(window[keys[j]]=methods[keys[j]],window[keys[j]].toString=function(){return"#ERROR"},"object"==typeof methods[keys[j]])for(var tmp=Object.keys(methods[keys[j]]),z=0;z<tmp.length;z++)window[keys[j]][tmp[z]].toString=function(){return"#ERROR"}}else window[keys[j]]=function(){return keys[j]+"Not implemented"};else window[keys[j]]=function(){return keys[j]+"Not implemented"};var x=null,y=null,instance=null,secureFormula=(window.TABLE=function(){return instance},window.COLUMN=window.COL=function(){return parseInt(x)+1},window.ROW=function(){return parseInt(y)+1},window.CELL=function(){return F.getColumnNameFromCoords(x,y)},window.VALUE=function(e,t,o){return instance.getValueFromCoords(parseInt(e)-1,parseInt(t)-1,o)},window.THISROWCELL=function(e){return instance.getValueFromCoords(parseInt(e)-1,parseInt(y))},function(e,t){for(var o="",n=0,r=["=","!",">","<"],i=0;i<e.length;i++)1==(n='"'==e[i]?0==n?1:0:n)?o+=e[i]:(o+=e[i].toUpperCase(),1==t&&0<i&&"="==e[i]&&-1==r.indexOf(e[i-1])&&-1==r.indexOf(e[i+1])&&(o+="="));return o=(o=(o=(o=o.replace(/\^/g,"**")).replace(/\<\>/g,"!=")).replace(/\&/g,"+")).replace(/\$/g,"")}),tokensUpdate=function(e,t){for(var o=0;o<e.length;o++){var n=F.getTokensFromRange(e[o]);t=t.replace(e[o],"["+n.join(",")+"]")}return t},F=function(e,t,o,n,r){instance=r,x=o,y=n;var i="",s=Object.keys(t);if(s.length)for(o=0;o<s.length;o++)-1==s[o].indexOf(".")&&-1==s[o].indexOf("!")?i+="var "+s[o]+" = "+t[s[o]]+";\n":i+=s[o]+" = "+t[s[o]]+";\n";e=(e=e.replace(/\$/g,"")).replace(/\!/g,".");r=(e=secureFormula(e,!0)).match(/([A-Z]+[0-9]*\.)?(\$?[A-Z]+\$?[0-9]+):(\$?[A-Z]+\$?[0-9]+)?/g);return r&&r.length&&(e=tokensUpdate(r,e)),new Function(i+"; return "+e)()},getColumnName=function(e){var t="";return 701<e?t=(t+=String.fromCharCode(64+parseInt(e/676)))+String.fromCharCode(64+parseInt(e%676/26)):25<e&&(t+=String.fromCharCode(64+parseInt(e/26))),t+=String.fromCharCode(65+e%26)};return F.getColumnNameFromCoords=function(e,t){return getColumnName(parseInt(e))+(parseInt(t)+1)},F.getCoordsFromColumnName=function(e){var t=/^[a-zA-Z]+/.exec(e);if(t){for(var o=0,n=0;n<t[0].length;n++)o+=parseInt(t[0].charCodeAt(n)-64)*Math.pow(26,t[0].length-1-n);--o<0&&(o=0);e=parseInt(/[0-9]+$/.exec(e))||null;return 0<e&&e--,[o,e]}},F.getRangeFromTokens=function(e){e=e.filter(function(e){return"#REF!"!=e});for(var t="",o="",n=0;n<e.length;n++)0<=e[n].indexOf(".")?t=".":0<=e[n].indexOf("!")&&(t="!"),t&&(o=e[n].split(t),e[n]=o[1],o=o[0]+t);return e.sort(function(e,t){e=Helpers.getCoordsFromColumnName(e),t=Helpers.getCoordsFromColumnName(t);return e[1]>t[1]?1:e[1]<t[1]?-1:e[0]>t[0]?1:e[0]<t[0]?-1:0}),e.length?o+(e[0]+":"+e[e.length-1]):"#REF!"},F.getTokensFromRange=function(e){t=0<e.indexOf(".")?(e=(t=e.split("."))[1],t[0]+"."):0<e.indexOf("!")?(e=(t=e.split("!"))[1],t[0]+"!"):"";var t,o,n,e=e.split(":"),r=F.getCoordsFromColumnName(e[0]),i=F.getCoordsFromColumnName(e[1]);if(n=r[0]<=i[0]?(o=r[0],i[0]):(o=i[0],r[0]),null===r[1]&&null==i[1])for(var s=null,l=null,a=Object.keys(vars),u=0;u<a.length;u++){var c=F.getCoordsFromColumnName(a[u]);c[0]===r[0]&&(null===s||c[1]<s)&&(s=c[1]),c[0]===i[0]&&(null===l||c[1]>l)&&(l=c[1])}else l=r[1]<=i[1]?(s=r[1],i[1]):(s=i[1],r[1]);for(var d=[],p=s;p<=l;p++){for(var h=[],u=o;u<=n;u++)h.push(t+F.getColumnNameFromCoords(u,p));d.push(h)}return d},F.setFormula=function(e){for(var t=Object.keys(e),o=0;o<t.length;o++)"function"==typeof e[t[o]]&&(window[t[o]]=e[t[o]])},F}(),jSuites;jSuites||"function"!=typeof require||(jSuites=require("jsuites")),!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.jspreadsheet=e.jexcel=t()}(this,function(){"use strict";var Version=function(){var e={title:"Jspreadsheet",version:"4.10.1",type:"CE",host:"https://bossanova.uk/jspreadsheet",license:"MIT",print:function(){return[this.title+" "+this.type+" "+this.version,this.host,this.license].join("\r\n")}};return function(){return e}}(),isFormula=function(e){e=(""+e)[0];return"="==e||"#"==e},getMask=function(e){var t;return e.format||e.mask||e.locale?(t={},e.mask?t.mask=e.mask:e.format?t.mask=e.format:(t.locale=e.locale,t.options=e.options),e.decimal&&(t.options||(t.options={}),t.options={decimal:e.decimal}),t):null},jexcel=function(el,options){var obj={options:{}};if(!(el instanceof Element||el instanceof HTMLDocument))return console.error("Jspreadsheet: el is not a valid DOM element"),!1;if("TABLE"==el.tagName){if(!(options=jexcel.createFromTable(el,options)))return console.error("Jspreadsheet: el is not a valid DOM element"),!1;var div=document.createElement("div");el.parentNode.insertBefore(div,el),el.remove(),el=div}var defaults={url:null,method:"GET",requestVariables:null,data:null,sorting:null,copyCompatibility:!1,root:null,rows:[],columns:[],colHeaders:[],colWidths:[],colAlignments:[],nestedHeaders:null,defaultColWidth:50,defaultColAlign:"center",defaultRowHeight:null,minSpareRows:0,minSpareCols:0,minDimensions:[0,0],allowExport:!0,includeHeadersOnDownload:!1,includeHeadersOnCopy:!1,columnSorting:!0,columnDrag:!1,columnResize:!0,rowResize:!1,rowDrag:!0,editable:!0,allowInsertRow:!0,allowManualInsertRow:!0,allowInsertColumn:!0,allowManualInsertColumn:!0,allowDeleteRow:!0,allowDeletingAllRows:!1,allowDeleteColumn:!0,allowRenameColumn:!0,allowComments:!1,wordWrap:!1,imageOptions:null,csv:null,csvFileName:"jspreadsheet",csvHeaders:!0,csvDelimiter:",",parseTableFirstRowAsHeader:!1,parseTableAutoCellType:!1,selectionCopy:!0,mergeCells:{},toolbar:null,search:!1,pagination:!1,paginationOptions:null,fullscreen:!1,lazyLoading:!1,loadingSpin:!1,tableOverflow:!1,tableHeight:"300px",tableWidth:null,textOverflow:!1,meta:null,style:null,classes:null,parseFormulas:!0,autoIncrement:!0,autoCasting:!0,secureFormulas:!0,stripHTML:!0,stripHTMLOnCopy:!1,filters:!1,footers:null,onundo:null,onredo:null,onload:null,onchange:null,oncomments:null,onbeforechange:null,onafterchanges:null,onbeforeinsertrow:null,oninsertrow:null,onbeforeinsertcolumn:null,oninsertcolumn:null,onbeforedeleterow:null,ondeleterow:null,onbeforedeletecolumn:null,ondeletecolumn:null,onmoverow:null,onmovecolumn:null,onresizerow:null,onresizecolumn:null,onsort:null,onselection:null,oncopy:null,onpaste:null,onbeforepaste:null,onmerge:null,onfocus:null,onblur:null,onchangeheader:null,oncreateeditor:null,oneditionstart:null,oneditionend:null,onchangestyle:null,onchangemeta:null,onchangepage:null,onbeforesave:null,onsave:null,onevent:null,persistance:!1,updateTable:null,detachForUpdates:!1,freezeColumns:null,text:{noRecordsFound:"No records found",showingPage:"Showing page {0} of {1} entries",show:"Show ",search:"Search",entries:" entries",columnName:"Column name",insertANewColumnBefore:"Insert a new column before",insertANewColumnAfter:"Insert a new column after",deleteSelectedColumns:"Delete selected columns",renameThisColumn:"Rename this column",orderAscending:"Order ascending",orderDescending:"Order descending",insertANewRowBefore:"Insert a new row before",insertANewRowAfter:"Insert a new row after",deleteSelectedRows:"Delete selected rows",editComments:"Edit comments",addComments:"Add comments",comments:"Comments",clearComments:"Clear comments",copy:"Copy...",paste:"Paste...",saveAs:"Save as...",about:"About",areYouSureToDeleteTheSelectedRows:"Are you sure to delete the selected rows?",areYouSureToDeleteTheSelectedColumns:"Are you sure to delete the selected columns?",thisActionWillDestroyAnyExistingMergedCellsAreYouSure:"This action will destroy any existing merged cells. Are you sure?",thisActionWillClearYourSearchResultsAreYouSure:"This action will clear your search results. Are you sure?",thereIsAConflictWithAnotherMergedCell:"There is a conflict with another merged cell",invalidMergeProperties:"Invalid merged properties",cellAlreadyMerged:"Cell already merged",noCellsSelected:"No cells selected"},about:!0},property;for(property in defaults)if(options&&options.hasOwnProperty(property))if("text"===property)for(var textKey in obj.options[property]=defaults[property],options[property])options[property].hasOwnProperty(textKey)&&(obj.options[property][textKey]=options[property][textKey]);else obj.options[property]=options[property];else obj.options[property]=defaults[property];obj.el=el,obj.corner=null,obj.contextMenu=null,obj.textarea=null,obj.ads=null,obj.content=null,obj.table=null,obj.thead=null,obj.tbody=null,obj.rows=[],obj.results=null,obj.searchInput=null,obj.toolbar=null,obj.pagination=null,obj.pageNumber=null,obj.headerContainer=null,obj.colgroupContainer=null,obj.headers=[],obj.records=[],obj.history=[],obj.formula=[],obj.colgroup=[],obj.selection=[],obj.highlighted=[],obj.selectedCell=null,obj.selectedContainer=null,obj.style=[],obj.data=null,obj.filter=null,obj.filters=[],obj.cursor=null,obj.historyIndex=-1,obj.ignoreEvents=!1,obj.ignoreHistory=!1,obj.edition=null,obj.hashString=null,obj.resizing=null,obj.dragging=null,1==obj.options.lazyLoading&&0==obj.options.tableOverflow&&0==obj.options.fullscreen&&(console.error("Jspreadsheet: The lazyloading only works when tableOverflow = yes or fullscreen = yes"),obj.options.lazyLoading=!1),obj.fullscreen=function(e){null==e&&(e=!obj.options.fullscreen),obj.options.fullscreen!=e&&(1==(obj.options.fullscreen=e)?el.classList.add("fullscreen"):el.classList.remove("fullscreen"))},obj.dispatch=function(e){var t,o;return obj.ignoreEvents||("function"==typeof obj.options.onevent&&(t=obj.options.onevent.apply(this,arguments)),"function"==typeof obj.options[e]&&(t=obj.options[e].apply(this,Array.prototype.slice.call(arguments,1)))),"onafterchanges"==e&&obj.options.persistance&&(e=1==obj.options.persistance?obj.options.url:obj.options.persistance,o=obj.prepareJson(arguments[2]),obj.save(e,o)),t},obj.prepareTable=function(){for(var e,t=obj.options.columns.length,o=(!obj.options.data||void 0===obj.options.data[0]||(e=Object.keys(obj.options.data[0])).length>t&&(t=e.length),obj.options.minDimensions[0]>t&&(t=obj.options.minDimensions[0]),[]),n=0;n<t;n++)obj.options.colHeaders[n]||(obj.options.colHeaders[n]=""),obj.options.colWidths[n]||(obj.options.colWidths[n]=obj.options.defaultColWidth),obj.options.colAlignments[n]||(obj.options.colAlignments[n]=obj.options.defaultColAlign),obj.options.columns[n]?obj.options.columns[n].type||(obj.options.columns[n].type="text"):obj.options.columns[n]={type:"text"},obj.options.columns[n].name||(obj.options.columns[n].name=e&&e[n]?e[n]:n),obj.options.columns[n].source||(obj.options.columns[n].source=[]),obj.options.columns[n].options||(obj.options.columns[n].options=[]),obj.options.columns[n].editor||(obj.options.columns[n].editor=null),obj.options.columns[n].allowEmpty||(obj.options.columns[n].allowEmpty=!1),obj.options.columns[n].title||(obj.options.columns[n].title=obj.options.colHeaders[n]||""),obj.options.columns[n].width||(obj.options.columns[n].width=obj.options.colWidths[n]||obj.options.defaultColWidth),obj.options.columns[n].align||(obj.options.columns[n].align=obj.options.colAlignments[n]||"center"),"autocomplete"==obj.options.columns[n].type||"dropdown"==obj.options.columns[n].type?obj.options.columns[n].url&&o.push({url:obj.options.columns[n].url,index:n,method:"GET",dataType:"json",success:function(e){for(var t=0;t<e.length;t++)obj.options.columns[this.index].source.push(e[t])}}):"calendar"!=obj.options.columns[n].type||obj.options.columns[n].options.format||(obj.options.columns[n].options.format="DD/MM/YYYY");o.length?jSuites.ajax(o,function(){obj.createTable()}):obj.createTable()},obj.createTable=function(){obj.table=document.createElement("table"),obj.thead=document.createElement("thead"),obj.tbody=document.createElement("tbody"),obj.headers=[],obj.colgroup=[],obj.content=document.createElement("div"),obj.content.classList.add("jexcel_content"),obj.content.onscroll=function(e){obj.scrollControls(e)},obj.content.onwheel=function(e){obj.wheelControls(e)},obj.toolbar=document.createElement("div"),obj.toolbar.classList.add("jexcel_toolbar");var e=document.createElement("div"),t=document.createTextNode(obj.options.text.search+": "),t=(obj.searchInput=document.createElement("input"),obj.searchInput.classList.add("jexcel_search"),e.appendChild(t),e.appendChild(obj.searchInput),obj.searchInput.onfocus=function(){obj.resetSelection()},document.createElement("div"));if(0<obj.options.pagination&&obj.options.paginationOptions&&0<obj.options.paginationOptions.length){obj.paginationDropdown=document.createElement("select"),obj.paginationDropdown.classList.add("jexcel_pagination_dropdown"),obj.paginationDropdown.onchange=function(){obj.options.pagination=parseInt(this.value),obj.page(0)};for(var o=0;o<obj.options.paginationOptions.length;o++){var n=document.createElement("option");n.value=obj.options.paginationOptions[o],n.innerHTML=obj.options.paginationOptions[o],obj.paginationDropdown.appendChild(n)}obj.paginationDropdown.value=obj.options.pagination,t.appendChild(document.createTextNode(obj.options.text.show)),t.appendChild(obj.paginationDropdown),t.appendChild(document.createTextNode(obj.options.text.entries))}var r=document.createElement("div"),t=(r.classList.add("jexcel_filter"),r.appendChild(t),r.appendChild(e),obj.colgroupContainer=document.createElement("colgroup"),document.createElement("col"));if(t.setAttribute("width","50"),obj.colgroupContainer.appendChild(t),obj.options.nestedHeaders&&0<obj.options.nestedHeaders.length)if(obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0])for(var i=0;i<obj.options.nestedHeaders.length;i++)obj.thead.appendChild(obj.createNestedHeader(obj.options.nestedHeaders[i]));else obj.thead.appendChild(obj.createNestedHeader(obj.options.nestedHeaders));obj.headerContainer=document.createElement("tr"),(t=document.createElement("td")).classList.add("jexcel_selectall"),obj.headerContainer.appendChild(t);for(o=0;o<obj.options.columns.length;o++)obj.createCellHeader(o),obj.headerContainer.appendChild(obj.headers[o]),obj.colgroupContainer.appendChild(obj.colgroup[o]);if(obj.thead.appendChild(obj.headerContainer),1==obj.options.filters){obj.filter=document.createElement("tr");var s=document.createElement("td");obj.filter.appendChild(s);for(o=0;o<obj.options.columns.length;o++)(s=document.createElement("td")).innerHTML="&nbsp;",s.setAttribute("data-x",o),s.className="jexcel_column_filter","hidden"==obj.options.columns[o].type&&(s.style.display="none"),obj.filter.appendChild(s);obj.thead.appendChild(obj.filter)}obj.table=document.createElement("table"),obj.table.classList.add("jexcel"),obj.table.setAttribute("cellpadding","0"),obj.table.setAttribute("cellspacing","0"),obj.table.setAttribute("unselectable","yes"),obj.table.appendChild(obj.colgroupContainer),obj.table.appendChild(obj.thead),obj.table.appendChild(obj.tbody),obj.options.textOverflow||obj.table.classList.add("jexcel_overflow"),obj.corner=document.createElement("div"),obj.corner.className="jexcel_corner",obj.corner.setAttribute("unselectable","on"),obj.corner.setAttribute("onselectstart","return false"),0==obj.options.selectionCopy&&(obj.corner.style.display="none"),obj.textarea=document.createElement("textarea"),obj.textarea.className="jexcel_textarea",obj.textarea.id="jexcel_textarea",obj.textarea.tabIndex="-1",obj.contextMenu=document.createElement("div"),obj.contextMenu.className="jexcel_contextmenu",jSuites.contextmenu(obj.contextMenu,{onclick:function(){obj.contextMenu.contextmenu.close(!1)}});e=document.createElement("a");e.setAttribute("href","https://bossanova.uk/jspreadsheet/"),obj.ads=document.createElement("div"),obj.ads.className="jexcel_about";try{"undefined"==typeof sessionStorage||sessionStorage.getItem("jexcel")||(sessionStorage.setItem("jexcel",!0),(l=document.createElement("img")).src="//bossanova.uk/jspreadsheet/logo.png",e.appendChild(l))}catch(e){}t=document.createElement("span");t.innerHTML="Jspreadsheet CE",e.appendChild(t),obj.ads.appendChild(e);document.createElement("div").classList.add("jexcel_table"),obj.pagination=document.createElement("div"),obj.pagination.classList.add("jexcel_pagination");var l=document.createElement("div"),t=document.createElement("div");if(obj.pagination.appendChild(l),obj.pagination.appendChild(t),obj.options.pagination||(obj.pagination.style.display="none"),1==obj.options.search&&el.appendChild(r),obj.content.appendChild(obj.table),obj.content.appendChild(obj.corner),obj.content.appendChild(obj.textarea),el.appendChild(obj.toolbar),el.appendChild(obj.content),el.appendChild(obj.pagination),el.appendChild(obj.contextMenu),el.appendChild(obj.ads),el.classList.add("jexcel_container"),obj.options.toolbar&&obj.options.toolbar.length&&obj.createToolbar(),1==obj.options.fullscreen?el.classList.add("fullscreen"):1==obj.options.tableOverflow&&(obj.options.tableHeight&&(obj.content.style["overflow-y"]="auto",obj.content.style["box-shadow"]="rgb(221 221 221) 2px 2px 5px 0.1px",obj.content.style.maxHeight=obj.options.tableHeight),obj.options.tableWidth&&(obj.content.style["overflow-x"]="auto",obj.content.style.width=obj.options.tableWidth)),1!=obj.options.tableOverflow&&obj.options.toolbar&&el.classList.add("with-toolbar"),1==obj.options.columnDrag&&obj.thead.classList.add("draggable"),1==obj.options.columnResize&&obj.thead.classList.add("resizable"),1==obj.options.rowDrag&&obj.tbody.classList.add("draggable"),1==obj.options.rowResize&&obj.tbody.classList.add("resizable"),obj.setData(),obj.options.style&&obj.setStyle(obj.options.style,null,null,1,1),obj.options.classes)for(var a=Object.keys(obj.options.classes),o=0;o<a.length;o++){var u=jexcel.getIdFromColumnName(a[o],!0);obj.records[u[1]][u[0]].classList.add(obj.options.classes[a[o]])}},obj.refresh=function(){obj.options.url?(1==obj.options.loadingSpin&&jSuites.loading.show(),jSuites.ajax({url:obj.options.url,method:obj.options.method,data:obj.options.requestVariables,dataType:"json",success:function(e){obj.options.data=e.data||e,obj.setData(),1==obj.options.loadingSpin&&jSuites.loading.hide()}})):obj.setData()},obj.setData=function(e){if(e&&("string"==typeof e&&(e=JSON.parse(e)),obj.options.data=e),obj.options.data||(obj.options.data=[]),obj.options.data&&obj.options.data[0]&&!Array.isArray(obj.options.data[0])){for(var e=[],t=0;t<obj.options.data.length;t++){for(var o=[],n=0;n<obj.options.columns.length;n++)o[n]=obj.options.data[t][obj.options.columns[n].name];e.push(o)}obj.options.data=e}var r,i,t=0,n=0,s=obj.options.columns.length,l=obj.options.data.length,a=obj.options.minDimensions[0],u=obj.options.minDimensions[1],c=s<a?a:s,d=l<u?u:l;for(t=0;t<d;t++)for(n=0;n<c;n++)null==obj.options.data[t]&&(obj.options.data[t]=[]),null==obj.options.data[t][n]&&(obj.options.data[t][n]="");for(obj.rows=[],obj.results=null,obj.records=[],obj.history=[],obj.historyIndex=-1,obj.tbody.innerHTML="",1==obj.options.lazyLoading?(r=0,i=obj.options.data.length<100?obj.options.data.length:100,obj.options.pagination&&(obj.options.pagination=!1,console.error("Jspreadsheet: Pagination will be disable due the lazyLoading"))):obj.options.pagination?(obj.pageNumber||(obj.pageNumber=0),obj.options.pagination,r=obj.options.pagination*obj.pageNumber,i=obj.options.pagination*obj.pageNumber+obj.options.pagination,obj.options.data.length<i&&(i=obj.options.data.length)):(r=0,i=obj.options.data.length),t=0;t<obj.options.data.length;t++){var p=obj.createRow(t,obj.options.data[t]);r<=t&&t<i&&obj.tbody.appendChild(p)}if(1!=obj.options.lazyLoading&&obj.options.pagination&&obj.updatePagination(),obj.options.mergeCells)for(var h=Object.keys(obj.options.mergeCells),n=0;n<h.length;n++){var f=obj.options.mergeCells[h[n]];obj.setMerge(h[n],f[0],f[1],1)}obj.updateTable(),obj.dispatch("onload",el,obj)},obj.getData=function(e,t){for(var o=[],n=0,r=0,i=1==t||0==obj.options.copyCompatibility,s=obj.options.columns.length,l=obj.options.data.length,a=0;a<l;a++){for(var n=0,u=0;u<s;u++)e&&!obj.records[a][u].classList.contains("highlight")||(o[r]||(o[r]=[]),o[r][n]=i?obj.options.data[a][u]:obj.records[a][u].innerHTML,n++);0<n&&r++}return o},obj.getJsonRow=function(e){for(var t=obj.options.data[e],o=obj.options.columns.length,n={},r=0;r<o;r++)obj.options.columns[r].name||(obj.options.columns[r].name=r),n[obj.options.columns[r].name]=t[r];return n},obj.getJson=function(e){for(var t=[],o=obj.options.columns.length,n=obj.options.data.length,r=0;r<n;r++){for(var i=null,s=0;s<o;s++)e&&!obj.records[r][s].classList.contains("highlight")||(null==i&&(i={}),obj.options.columns[s].name||(obj.options.columns[s].name=s),i[obj.options.columns[s].name]=obj.options.data[r][s]);null!=i&&t.push(i)}return t},obj.prepareJson=function(e){for(var t=[],o=0;o<e.length;o++){var n=e[o].x,r=e[o].y,n=obj.options.columns[n].name||n;t[r]||(t[r]={row:r,data:{}}),t[r].data[n]=e[o].newValue}return t.filter(function(e){return null!=e})},obj.save=function(e,t){var o=obj.dispatch("onbeforesave",el,obj,t);if(o)t=o;else if(!1===o)return!1;jSuites.ajax({url:e,method:"POST",dataType:"json",data:{data:JSON.stringify(t)},success:function(e){obj.dispatch("onsave",el,obj,t)}})},obj.getRowData=function(e){return obj.options.data[e]},obj.setRowData=function(e,t){for(var o=0;o<obj.headers.length;o++){var n=jexcel.getColumnNameFromId([o,e]);null!=t[o]&&obj.setValue(n,t[o])}},obj.getColumnData=function(e){for(var t=[],o=0;o<obj.options.data.length;o++)t.push(obj.options.data[o][e]);return t},obj.setColumnData=function(e,t){for(var o=0;o<obj.rows.length;o++){var n=jexcel.getColumnNameFromId([e,o]);null!=t[o]&&obj.setValue(n,t[o])}},obj.createRow=function(e,t){obj.records[e]||(obj.records[e]=[]),t=t||obj.options.data[e],obj.rows[e]=document.createElement("tr"),obj.rows[e].setAttribute("data-y",e);var o=null,n=(obj.options.defaultRowHeight&&(obj.rows[e].style.height=obj.options.defaultRowHeight+"px"),obj.options.rows[e]&&(obj.options.rows[e].height&&(obj.rows[e].style.height=obj.options.rows[e].height),obj.options.rows[e].title&&(o=obj.options.rows[e].title)),o=o||parseInt(e+1),document.createElement("td"));n.innerHTML=o,n.setAttribute("data-y",e),n.className="jexcel_row",obj.rows[e].appendChild(n);for(var r=0;r<obj.options.columns.length;r++)obj.records[e][r]=obj.createCell(r,e,t[r]),obj.rows[e].appendChild(obj.records[e][r]);return obj.rows[e]},obj.parseValue=function(e,t,o,n){"="==(""+o).substr(0,1)&&1==obj.options.parseFormulas&&(o=obj.executeFormula(o,e,t));var t=obj.options.columns[e];return t&&!isFormula(o)&&(e=null,(e=getMask(t))&&(o&&o==Number(o)&&(o=Number(o)),t=jSuites.mask.render(o,e,!0),n&&e.mask&&(e=e.mask.split(";"))[1]&&(e[1].match(new RegExp("\\[Red\\]","gi"))&&(o<0?n.classList.add("red"):n.classList.remove("red")),e[1].match(new RegExp("\\(","gi"))&&o<0&&(t="("+t+")")),t&&(o=t))),o};var validDate=function(e){return"-"==(e=""+e).substr(4,1)&&"-"==e.substr(7,1)||4==(e=e.split("-"))[0].length&&e[0]==Number(e[0])&&2==e[1].length&&e[1]==Number(e[1])},stripScript=(obj.createCell=function(e,t,o){var n,r=document.createElement("td"),i=(r.setAttribute("data-x",e),r.setAttribute("data-y",t),"="!=(""+o).substr(0,1)||1!=obj.options.secureFormulas||(n=secureFormula(o))!=o&&(o=n),obj.options.columns[e].editor?(!1===obj.options.stripHTML||!1===obj.options.columns[e].stripHTML?r.innerHTML=o:r.innerText=o,"function"==typeof obj.options.columns[e].editor.createCell&&(r=obj.options.columns[e].editor.createCell(r))):"hidden"==obj.options.columns[e].type?(r.style.display="none",r.innerText=o):"checkbox"==obj.options.columns[e].type||"radio"==obj.options.columns[e].type?((n=document.createElement("input")).type=obj.options.columns[e].type,n.name="c"+e,n.checked=1==o||"true"==o,n.onclick=function(){obj.setValue(r,this.checked)},1!=obj.options.columns[e].readOnly&&0!=obj.options.editable||n.setAttribute("disabled","disabled"),r.appendChild(n),obj.options.data[t][e]=n.checked):"calendar"==obj.options.columns[e].type?(n=null,validDate(o)||(i=jSuites.calendar.extractDateFromString(o,obj.options.columns[e].options.format))&&(n=i),r.innerText=jSuites.calendar.getDateString(n||o,obj.options.columns[e].options.format)):"dropdown"==obj.options.columns[e].type||"autocomplete"==obj.options.columns[e].type?(r.classList.add("jexcel_dropdown"),r.innerText=obj.getDropDownValue(e,o)):"color"==obj.options.columns[e].type?"square"==obj.options.columns[e].render?((i=document.createElement("div")).className="color",i.style.backgroundColor=o,r.appendChild(i)):(r.style.color=o,r.innerText=o):"image"==obj.options.columns[e].type?o&&"data:image"==o.substr(0,10)&&((n=document.createElement("img")).src=o,r.appendChild(n)):"html"==obj.options.columns[e].type||!1===obj.options.stripHTML||!1===obj.options.columns[e].stripHTML?r.innerHTML=stripScript(obj.parseValue(e,t,o,r)):r.innerText=obj.parseValue(e,t,o,r),1==obj.options.columns[e].readOnly&&(r.className="readonly"),obj.options.columns[e].align||"center");return r.style.textAlign=i,0!=obj.options.columns[e].wordWrap&&(1==obj.options.wordWrap||1==obj.options.columns[e].wordWrap||200<r.innerHTML.length)&&(r.style.whiteSpace="pre-wrap"),0<e&&1==this.options.textOverflow&&(o||r.innerHTML?obj.records[t][e-1].style.overflow="hidden":e==obj.options.columns.length-1&&(r.style.overflow="hidden")),r},obj.createCellHeader=function(e){var t=obj.options.columns[e].width||obj.options.defaultColWidth,o=obj.options.columns[e].align||obj.options.defaultColAlign;obj.headers[e]=document.createElement("td"),obj.options.stripHTML?obj.headers[e].innerText=obj.options.columns[e].title||jexcel.getColumnName(e):obj.headers[e].innerHTML=obj.options.columns[e].title||jexcel.getColumnName(e),obj.headers[e].setAttribute("data-x",e),obj.headers[e].style.textAlign=o,obj.options.columns[e].title&&obj.headers[e].setAttribute("title",obj.options.columns[e].title),obj.options.columns[e].id&&obj.headers[e].setAttribute("id",obj.options.columns[e].id),obj.colgroup[e]=document.createElement("col"),obj.colgroup[e].setAttribute("width",t),"hidden"==obj.options.columns[e].type&&(obj.headers[e].style.display="none",obj.colgroup[e].style.display="none")},obj.updateNestedHeader=function(e,t,o){obj.options.nestedHeaders[t][e].title&&(obj.options.nestedHeaders[t][e].title=o,obj.options.nestedHeaders[t].element.children[e+1].innerText=o)},obj.createNestedHeader=function(e){for(var t=document.createElement("tr"),o=(t.classList.add("jexcel_nested"),document.createElement("td")),n=(t.appendChild(o),e.element=t,0),r=0;r<e.length;r++){e[r].colspan||(e[r].colspan=1),e[r].align||(e[r].align="center"),e[r].title||(e[r].title="");for(var i=e[r].colspan,s=[],l=0;l<i;l++)obj.options.columns[n]&&"hidden"==obj.options.columns[n].type&&i++,s.push(n),n++;(o=document.createElement("td")).setAttribute("data-column",s.join(",")),o.setAttribute("colspan",e[r].colspan),o.setAttribute("align",e[r].align),o.innerText=e[r].title,t.appendChild(o)}return t},obj.createToolbar=function(t){t?obj.options.toolbar=t:t=obj.options.toolbar;for(var e,o=0;o<t.length;o++)if("i"==t[o].type)(e=document.createElement("i")).classList.add("jexcel_toolbar_item"),e.classList.add("material-icons"),e.setAttribute("data-k",t[o].k),e.setAttribute("data-v",t[o].v),e.setAttribute("id",t[o].id),t[o].tooltip&&e.setAttribute("title",t[o].tooltip),t[o].onclick&&(t[o].onclick,1)?e.onclick=function(){var e=o;return function(){t[e].onclick(el,obj,this)}}():e.onclick=function(){var e=this.getAttribute("data-k"),t=this.getAttribute("data-v");obj.setStyle(obj.highlighted,e,t)},e.innerText=t[o].content,obj.toolbar.appendChild(e);else if("select"==t[o].type){(e=document.createElement("select")).classList.add("jexcel_toolbar_item"),e.setAttribute("data-k",t[o].k),t[o].tooltip&&e.setAttribute("title",t[o].tooltip),t[o].onchange&&(t[o].onchange,1)?e.onchange=t[o].onchange:e.onchange=function(){var e=this.getAttribute("data-k");obj.setStyle(obj.highlighted,e,this.value)};for(var n=0;n<t[o].v.length;n++){var r=document.createElement("option");r.value=t[o].v[n],r.innerText=t[o].v[n],e.appendChild(r)}obj.toolbar.appendChild(e)}else"color"==t[o].type&&((e=document.createElement("i")).classList.add("jexcel_toolbar_item"),e.classList.add("material-icons"),e.setAttribute("data-k",t[o].k),e.setAttribute("data-v",""),t[o].tooltip&&e.setAttribute("title",t[o].tooltip),obj.toolbar.appendChild(e),e.innerText=t[o].content,jSuites.color(e,{onchange:function(e,t){e=e.getAttribute("data-k");obj.setStyle(obj.highlighted,e,t)}}))},obj.setMerge=function(e,t,o,n){var r=!1;if(!e){if(!obj.highlighted.length)return alert(obj.options.text.noCellsSelected),null;var i=parseInt(obj.highlighted[0].getAttribute("data-x")),s=parseInt(obj.highlighted[0].getAttribute("data-y")),l=parseInt(obj.highlighted[obj.highlighted.length-1].getAttribute("data-x")),a=parseInt(obj.highlighted[obj.highlighted.length-1].getAttribute("data-y")),e=jexcel.getColumnNameFromId([i,s]),t=l-i+1,o=a-s+1}var u=jexcel.getIdFromColumnName(e,!0);if(obj.options.mergeCells[e])obj.records[u[1]][u[0]].getAttribute("data-merged")&&(r=obj.options.text.cellAlreadyMerged);else if((!t||t<2)&&(!o||o<2))r=obj.options.text.invalidMergeProperties;else for(var c=u[1];c<u[1]+o;c++)for(var d=u[0];d<u[0]+t;d++){jexcel.getColumnNameFromId([d,c]);obj.records[c][d].getAttribute("data-merged")&&(r=obj.options.text.thereIsAConflictWithAnotherMergedCell)}if(r)alert(r);else{1<t?obj.records[u[1]][u[0]].setAttribute("colspan",t):t=1,1<o?obj.records[u[1]][u[0]].setAttribute("rowspan",o):o=1,obj.options.mergeCells[e]=[t,o,[]],obj.records[u[1]][u[0]].setAttribute("data-merged","true"),obj.records[u[1]][u[0]].style.overflow="hidden";for(var p=[],h=u[1];h<u[1]+o;h++)for(var f=u[0];f<u[0]+t;f++)u[0]==f&&u[1]==h||(p.push(obj.options.data[h][f]),obj.updateCell(f,h,"",!0),obj.options.mergeCells[e][2].push(obj.records[h][f]),obj.records[h][f].style.display="none",obj.records[h][f]=obj.records[u[1]][u[0]]);obj.updateSelection(obj.records[u[1]][u[0]]),n||(obj.setHistory({action:"setMerge",column:e,colspan:t,rowspan:o,data:p}),obj.dispatch("onmerge",el,e,t,o))}},obj.getMerge=function(e){var t={};if(e)t=obj.options.mergeCells[e]?[obj.options.mergeCells[e][0],obj.options.mergeCells[e][1]]:null;else if(obj.options.mergeCells){obj.options.mergeCells;for(var o=Object.keys(obj.options.mergeCells),n=0;n<o.length;n++)t[o[n]]=[obj.options.mergeCells[o[n]][0],obj.options.mergeCells[o[n]][1]]}return t},obj.removeMerge=function(e,t,o){if(obj.options.mergeCells[e]){for(var n=jexcel.getIdFromColumnName(e,!0),r=(obj.records[n[1]][n[0]].removeAttribute("colspan"),obj.records[n[1]][n[0]].removeAttribute("rowspan"),obj.records[n[1]][n[0]].removeAttribute("data-merged"),obj.options.mergeCells[e]),i=0,s=0;s<r[1];s++)for(var l=0;l<r[0];l++)(0<s||0<l)&&(obj.records[n[1]+s][n[0]+l]=r[2][i],obj.records[n[1]+s][n[0]+l].style.display="",t&&t[i]&&obj.updateCell(n[0]+l,n[1]+s,t[i]),i++);obj.updateSelection(obj.records[n[1]][n[0]],obj.records[n[1]+s-1][n[0]+l-1]),o||delete obj.options.mergeCells[e]}},obj.destroyMerged=function(e){if(obj.options.mergeCells){obj.options.mergeCells;for(var t=Object.keys(obj.options.mergeCells),o=0;o<t.length;o++)obj.removeMerge(t[o],null,e)}},obj.isColMerged=function(e,t){var o=[];if(obj.options.mergeCells)for(var n=Object.keys(obj.options.mergeCells),r=0;r<n.length;r++){var i=jexcel.getIdFromColumnName(n[r],!0),s=obj.options.mergeCells[n[r]][0],l=i[0],i=i[0]+(1<s?s-1:0);null==t?l<=e&&e<=i&&o.push(n[r]):t?l<e&&e<=i&&o.push(n[r]):l<=e&&e<i&&o.push(n[r])}return o},obj.isRowMerged=function(e,t){var o=[];if(obj.options.mergeCells)for(var n=Object.keys(obj.options.mergeCells),r=0;r<n.length;r++){var i=jexcel.getIdFromColumnName(n[r],!0),s=obj.options.mergeCells[n[r]][1],l=i[1],i=i[1]+(1<s?s-1:0);null==t?l<=e&&e<=i&&o.push(n[r]):t?l<e&&e<=i&&o.push(n[r]):l<=e&&e<i&&o.push(n[r])}return o},obj.openFilter=function(t){if(obj.options.filters){t=parseInt(t),obj.resetSelection();var e=[];if("checkbox"==obj.options.columns[t].type)e.push({id:"true",name:"True"}),e.push({id:"false",name:"False"});else{for(var o=[],n=!1,r=0;r<obj.options.data.length;r++){var i=obj.options.data[r][t],s=obj.records[r][t].innerHTML;i&&s?o[i]=s:n=!0}for(var l=Object.keys(o),e=[],r=0;r<l.length;r++)e.push({id:l[r],name:o[l[r]]});n&&e.push({value:"",id:"",name:"(Blanks)"})}var a=document.createElement("div"),u=(obj.filter.children[t+1].innerHTML="",obj.filter.children[t+1].appendChild(a),obj.filter.children[t+1].style.paddingLeft="0px",obj.filter.children[t+1].style.paddingRight="0px",obj.filter.children[t+1].style.overflow="initial",{data:e,multiple:!0,autocomplete:!0,opened:!0,value:void 0!==obj.filters[t]?obj.filters[t]:null,width:"100%",position:1==obj.options.tableOverflow||1==obj.options.fullscreen,onclose:function(e){obj.resetFilters(),obj.filters[t]=e.dropdown.getValue(!0),obj.filter.children[t+1].innerHTML=e.dropdown.getText(),obj.filter.children[t+1].style.paddingLeft="",obj.filter.children[t+1].style.paddingRight="",obj.filter.children[t+1].style.overflow="",obj.closeFilter(t),obj.refreshSelection()}});jSuites.dropdown(a,u)}else console.log("Jspreadsheet: filters not enabled.")},obj.resetFilters=function(){if(obj.options.filters)for(var e=0;e<obj.filter.children.length;e++)obj.filter.children[e].innerHTML="&nbsp;",obj.filters[e]=null;obj.results=null,obj.updateResult()},obj.closeFilter=function(e){if(!e)for(var t=0;t<obj.filter.children.length;t++)obj.filters[t]&&(e=t);var o=obj.filters[e];obj.results=[];for(var n=0;n<obj.options.data.length;n++)!function(e,t,o){for(var n=0;n<e.length;n++){var r=""+obj.options.data[o][t],i=""+obj.records[o][t].innerHTML;if(e[n]==r||e[n]==i)return!0}return!1}(o,e,n)||obj.results.push(n);obj.results.length||(obj.results=null),obj.updateResult()},obj.openEditor=function(o,e,t){function n(e){var t=o.getBoundingClientRect();return(e=document.createElement(e)).style.width=t.width+"px",e.style.height=t.height-2+"px",e.style.minHeight=t.height-2+"px",o.classList.add("editor"),o.innerHTML="",o.appendChild(e),obj.dispatch("oncreateeditor",el,o,a,l,e),e}var r,i,s,l=o.getAttribute("data-y"),a=o.getAttribute("data-x");obj.dispatch("oneditionstart",el,o,a,l),0<a&&(obj.records[l][a-1].style.overflow="hidden");if(1!=o.classList.contains("readonly"))if(obj.edition=[obj.records[l][a],obj.records[l][a].innerHTML,a,l],obj.options.columns[a].editor)obj.options.columns[a].editor.openEditor(o,el,e,t);else if("hidden"!=obj.options.columns[a].type)if("checkbox"==obj.options.columns[a].type||"radio"==obj.options.columns[a].type){var u=!o.children[0].checked;obj.setValue(o,u),obj.edition=null}else if("dropdown"==obj.options.columns[a].type||"autocomplete"==obj.options.columns[a].type){for(var c,u=obj.options.data[l][a],d=(obj.options.columns[a].multiple&&!Array.isArray(u)&&(u=u.split(";")),c="function"==typeof obj.options.columns[a].filter?obj.options.columns[a].filter(el,o,a,l,obj.options.columns[a].source):obj.options.columns[a].source,[]),p=0;p<c.length;p++)d.push(c[p]);var h=n("div"),f={data:d,multiple:!!obj.options.columns[a].multiple,autocomplete:!(!obj.options.columns[a].autocomplete&&"autocomplete"!=obj.options.columns[a].type),opened:!0,value:u,width:"100%",height:h.style.minHeight,position:1==obj.options.tableOverflow||1==obj.options.fullscreen,onclose:function(){obj.closeEditor(o,!0)}};obj.options.columns[a].options&&obj.options.columns[a].options.type&&(f.type=obj.options.columns[a].options.type),jSuites.dropdown(h,f)}else"calendar"==obj.options.columns[a].type||"color"==obj.options.columns[a].type?(u=obj.options.data[l][a],(h=n("input")).value=u,1!=obj.options.tableOverflow&&1!=obj.options.fullscreen||(obj.options.columns[a].options.position=!0),obj.options.columns[a].options.value=obj.options.data[l][a],obj.options.columns[a].options.opened=!0,obj.options.columns[a].options.onclose=function(e,t){obj.closeEditor(o,!0)},"color"==obj.options.columns[a].type?jSuites.color(h,obj.options.columns[a].options):jSuites.calendar(h,obj.options.columns[a].options),h.focus()):"html"==obj.options.columns[a].type?(u=obj.options.data[l][a],(h=n("div")).style.position="relative",(r=document.createElement("div")).classList.add("jexcel_richtext"),h.appendChild(r),jSuites.editor(r,{focus:!0,value:u}),i=o.getBoundingClientRect(),s=r.getBoundingClientRect(),window.innerHeight<i.bottom+s.height?r.style.top=i.top-(s.height+2)+"px":r.style.top=i.top+"px"):"image"==obj.options.columns[a].type?(t=o.children[0],(h=n("div")).style.position="relative",(r=document.createElement("div")).classList.add("jclose"),t&&t.src&&r.appendChild(t),h.appendChild(r),jSuites.image(r,obj.options.imageOptions),i=o.getBoundingClientRect(),s=r.getBoundingClientRect(),window.innerHeight<i.bottom+s.height?r.style.top=i.top-(s.height+2)+"px":r.style.top=i.top+"px"):(u=1==e?"":obj.options.data[l][a],(h=0==obj.options.columns[a].wordWrap||1!=obj.options.wordWrap&&1!=obj.options.columns[a].wordWrap?n("input"):n("textarea")).focus(),h.value=u,f=obj.options.columns[a],t=null,isFormula(u)||(t=getMask(f))&&(f.disabledMaskOnEdition||(f.mask?(s=f.mask.split(";"),h.setAttribute("data-mask",s[0])):f.locale&&h.setAttribute("data-locale",f.locale)),(t.input=h).mask=t,jSuites.mask.render(u,t,!1)),h.onblur=function(){obj.closeEditor(o,!0)},h.scrollLeft=h.scrollWidth)},obj.closeEditor=function(e,t){var o,n,r,i=parseInt(e.getAttribute("data-x")),s=parseInt(e.getAttribute("data-y"));1==t?(obj.options.columns[i].editor?o=obj.options.columns[i].editor.closeEditor(e,t):"checkbox"!=obj.options.columns[i].type&&"radio"!=obj.options.columns[i].type&&"hidden"!=obj.options.columns[i].type&&("dropdown"==obj.options.columns[i].type||"autocomplete"==obj.options.columns[i].type?o=e.children[0].dropdown.close(!0):"calendar"==obj.options.columns[i].type?o=e.children[0].calendar.close(!0):"color"==obj.options.columns[i].type?o=e.children[0].color.close(!0):"html"==obj.options.columns[i].type?o=e.children[0].children[0].editor.getData():"image"==obj.options.columns[i].type?o=(r=e.children[0].children[0].children[0])&&"IMG"==r.tagName?r.src:"":"numeric"==obj.options.columns[i].type?("="!=(""+(o=e.children[0].value)).substr(0,1)&&""==o&&(o=obj.options.columns[i].allowEmpty?"":0),e.children[0].onblur=null):(o=e.children[0].value,e.children[0].onblur=null,r=obj.options.columns[i],n=null,(n=getMask(r))&&""!==o&&!isFormula(o)&&"number"!=typeof o&&(r=jSuites.mask.extract(o,n,!0))&&""!==r.value&&(o=r.value))),obj.options.data[s][i]==o?e.innerHTML=obj.edition[1]:obj.setValue(e,o)):(obj.options.columns[i].editor?obj.options.columns[i].editor.closeEditor(e,t):"dropdown"==obj.options.columns[i].type||"autocomplete"==obj.options.columns[i].type?e.children[0].dropdown.close(!0):"calendar"==obj.options.columns[i].type?e.children[0].calendar.close(!0):"color"==obj.options.columns[i].type?e.children[0].color.close(!0):e.children[0].onblur=null,e.innerHTML=obj.edition&&obj.edition[1]?obj.edition[1]:""),obj.dispatch("oneditionend",el,e,i,s,o,t),e.classList.remove("editor"),obj.edition=null},obj.getCell=function(e){var t=(e=jexcel.getIdFromColumnName(e,!0))[0],e=e[1];return obj.records[e][t]},obj.getColumnOptions=function(e,t){return obj.options.columns[e]||{type:"text"}},obj.getCellFromCoords=function(e,t){return obj.records[t][e]},obj.getLabel=function(e){var t=(e=jexcel.getIdFromColumnName(e,!0))[0],e=e[1];return obj.records[e][t].innerHTML},obj.getLabelFromCoords=function(e,t){return obj.records[t][e].innerHTML},obj.getValue=function(e,t){e="object"==typeof e?(o=e.getAttribute("data-x"),e.getAttribute("data-y")):(o=(e=jexcel.getIdFromColumnName(e,!0))[0],e[1]);var o,n=null;return null!=o&&null!=e&&(obj.records[e]&&obj.records[e][o]&&(t||1==obj.options.copyCompatibility)?n=obj.records[e][o].innerHTML:obj.options.data[e]&&"undefined"!=obj.options.data[e][o]&&(n=obj.options.data[e][o])),n},obj.getValueFromCoords=function(e,t,o){var n=null;return null!=e&&null!=t&&(obj.records[t]&&obj.records[t][e]&&o||1==obj.options.copyCompatibility?n=obj.records[t][e].innerHTML:obj.options.data[t]&&"undefined"!=obj.options.data[t][e]&&(n=obj.options.data[t][e])),n},obj.setValue=function(e,t,o){var n=[];if("string"==typeof e){var r=(l=jexcel.getIdFromColumnName(e,!0))[0],i=l[1];n.push(obj.updateCell(r,i,t,o)),obj.updateFormulaChain(r,i,n)}else{r=null,i=null;if(e&&e.getAttribute&&(r=e.getAttribute("data-x"),i=e.getAttribute("data-y")),null!=r&&null!=i)n.push(obj.updateCell(r,i,t,o)),obj.updateFormulaChain(r,i,n);else{var s=Object.keys(e);if(0<s.length)for(var l,a=0;a<s.length;a++)"string"==typeof e[a]?(r=(l=jexcel.getIdFromColumnName(e[a],!0))[0],i=l[1]):null!=e[a].x&&null!=e[a].y?(r=e[a].x,i=e[a].y,null!=e[a].newValue?t=e[a].newValue:null!=e[a].value&&(t=e[a].value)):(r=e[a].getAttribute("data-x"),i=e[a].getAttribute("data-y")),null!=r&&null!=i&&(n.push(obj.updateCell(r,i,t,o)),obj.updateFormulaChain(r,i,n))}}obj.setHistory({action:"setValue",records:n,selection:obj.selectedCell}),obj.updateTable(),obj.onafterchanges(el,n)},obj.setValueFromCoords=function(e,t,o,n){var r=[];r.push(obj.updateCell(e,t,o,n)),obj.updateFormulaChain(e,t,r),obj.setHistory({action:"setValue",records:r,selection:obj.selectedCell}),obj.updateTable(),obj.onafterchanges(el,r)},obj.setCheckRadioValue=function(){for(var e=[],t=Object.keys(obj.highlighted),o=0;o<t.length;o++){var n=obj.highlighted[o].getAttribute("data-x"),r=obj.highlighted[o].getAttribute("data-y");"checkbox"!=obj.options.columns[n].type&&"radio"!=obj.options.columns[n].type||e.push(obj.updateCell(n,r,!obj.options.data[r][n]))}e.length&&(obj.setHistory({action:"setValue",records:e,selection:obj.selectedCell}),obj.onafterchanges(el,e))},function(e){var t=new Option,o=(t.innerHTML=e,null);for(e=t.getElementsByTagName("script");o=e[0];)o.parentNode.removeChild(o);return t.innerHTML}),chainLoopProtection=(obj.updateCell=function(e,t,o,n){if(1!=obj.records[t][e].classList.contains("readonly")||n){"="==(""+o).substr(0,1)&&1==obj.options.secureFormulas&&(i=secureFormula(o))!=o&&(o=i);var r,i=obj.dispatch("onbeforechange",el,obj.records[t][e],e,t,o),i=(null!=i&&(o=i),{x:e,y:t,col:e,row:t,newValue:o=obj.options.columns[e].editor&&"function"==typeof obj.options.columns[e].editor.updateCell?obj.options.columns[e].editor.updateCell(obj.records[t][e],o,n):o,oldValue:obj.options.data[t][e]});if(obj.options.columns[e].editor)obj.options.data[t][e]=o;else if("checkbox"==obj.options.columns[e].type||"radio"==obj.options.columns[e].type){if("radio"==obj.options.columns[e].type)for(var s=0;s<obj.options.data.length;s++)obj.options.data[s][e]=!1;obj.records[t][e].children[0].checked=1==o||"true"==o||"TRUE"==o,obj.options.data[t][e]=obj.records[t][e].children[0].checked}else"dropdown"==obj.options.columns[e].type||"autocomplete"==obj.options.columns[e].type?(obj.options.data[t][e]=o,obj.records[t][e].innerText=obj.getDropDownValue(e,o)):"calendar"==obj.options.columns[e].type?(n=null,validDate(o)||(r=jSuites.calendar.extractDateFromString(o,obj.options.columns[e].options.format))&&(n=r),obj.options.data[t][e]=o,obj.records[t][e].innerText=jSuites.calendar.getDateString(n||o,obj.options.columns[e].options.format)):"color"==obj.options.columns[e].type?(obj.options.data[t][e]=o,"square"==obj.options.columns[e].render?((r=document.createElement("div")).className="color",r.style.backgroundColor=o,obj.records[t][e].innerText="",obj.records[t][e].appendChild(r)):(obj.records[t][e].style.color=o,obj.records[t][e].innerText=o)):"image"==obj.options.columns[e].type?(obj.options.data[t][e]=o=""+o,obj.records[t][e].innerHTML="",o&&"data:image"==o.substr(0,10)&&((n=document.createElement("img")).src=o,obj.records[t][e].appendChild(n))):(obj.options.data[t][e]=o,"html"==obj.options.columns[e].type?obj.records[t][e].innerHTML=stripScript(obj.parseValue(e,t,o)):!1===obj.options.stripHTML||!1===obj.options.columns[e].stripHTML?obj.records[t][e].innerHTML=stripScript(obj.parseValue(e,t,o,obj.records[t][e])):obj.records[t][e].innerText=obj.parseValue(e,t,o,obj.records[t][e]),0!=obj.options.columns[e].wordWrap&&(1==obj.options.wordWrap||1==obj.options.columns[e].wordWrap||200<obj.records[t][e].innerHTML.length)?obj.records[t][e].style.whiteSpace="pre-wrap":obj.records[t][e].style.whiteSpace="");0<e&&(obj.records[t][e-1].style.overflow=o?"hidden":""),obj.dispatch("onchange",el,obj.records[t]&&obj.records[t][e]?obj.records[t][e]:null,e,t,o,i.oldValue)}else i={x:e,y:t,col:e,row:t};return i},obj.copyData=function(e,t){for(var o,n,r=obj.getData(!0,!0),i=obj.selectedContainer,s=parseInt(e.getAttribute("data-x")),e=parseInt(e.getAttribute("data-y")),l=parseInt(t.getAttribute("data-x")),a=parseInt(t.getAttribute("data-y")),u=[],c=!1,d=(i[0]==s?(o=e<i[1]?e-i[1]:1,n=0):(n=s<i[0]?s-i[0]:1,o=0),0),p=0,h=e;h<=a;h++)if(!obj.rows[h]||"none"!=obj.rows[h].style.display){null==r[p]&&(p=0),i[d=0]!=s&&(n=s<i[0]?s-i[0]:1);for(var f=s;f<=l;f++){if(obj.records[h][f]&&!obj.records[h][f].classList.contains("readonly")&&"none"!=obj.records[h][f].style.display&&0==c){if(!obj.selection.length&&""!=obj.options.data[h][f]){c=!0;continue}(null==r[p]||null==r[p][d])&&(d=0);var b,m=r[p][d];if(m&&!r[1]&&1==obj.options.autoIncrement)if("text"==obj.options.columns[f].type||"number"==obj.options.columns[f].type)if("="==(""+m).substr(0,1)){var g=m.match(/([A-Z]+[0-9]+)/g);if(g){for(var j=[],v=0;v<g.length;v++){var y=jexcel.getIdFromColumnName(g[v],1),y=(y[0]+=n,y[1]+=o,y[1]<0&&(y[1]=0),jexcel.getColumnNameFromId([y[0],y[1]]));y!=g[v]&&(j[g[v]]=y)}j&&(m=obj.updateFormula(m,j))}}else m==Number(m)&&(m=Number(m)+o);else"calendar"==obj.options.columns[f].type&&((b=new Date(m)).setDate(b.getDate()+o),m=b.getFullYear()+"-"+jexcel.doubleDigitFormat(parseInt(b.getMonth()+1))+"-"+jexcel.doubleDigitFormat(b.getDate())+" 00:00:00");u.push(obj.updateCell(f,h,m)),obj.updateFormulaChain(f,h,u)}d++,i[0]!=s&&n++}p++,o++}obj.setHistory({action:"setValue",records:u,selection:obj.selectedCell}),obj.updateTable(),obj.onafterchanges(el,u)},obj.refreshSelection=function(){obj.selectedCell&&obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3])},obj.conditionalSelectionUpdate=function(e,t,o){1==e?obj.selectedCell&&(t>=obj.selectedCell[1]&&t<=obj.selectedCell[3]||o>=obj.selectedCell[1]&&o<=obj.selectedCell[3])&&obj.resetSelection():obj.selectedCell&&(t>=obj.selectedCell[0]&&t<=obj.selectedCell[2]||o>=obj.selectedCell[0]&&o<=obj.selectedCell[2])&&obj.resetSelection()},obj.resetSelection=function(e){if(obj.highlighted.length)for(var t=1,o=0;o<obj.highlighted.length;o++){obj.highlighted[o].classList.remove("highlight"),obj.highlighted[o].classList.remove("highlight-left"),obj.highlighted[o].classList.remove("highlight-right"),obj.highlighted[o].classList.remove("highlight-top"),obj.highlighted[o].classList.remove("highlight-bottom"),obj.highlighted[o].classList.remove("highlight-selected");var n,r,i,s=parseInt(obj.highlighted[o].getAttribute("data-x")),l=parseInt(obj.highlighted[o].getAttribute("data-y"));i=obj.highlighted[o].getAttribute("data-merged")?(r=0<(n=parseInt(obj.highlighted[o].getAttribute("colspan")))?s+(n-1):s,0<(n=parseInt(obj.highlighted[o].getAttribute("rowspan")))?l+(n-1):l):(r=s,l);for(var a=s;a<=r;a++)obj.headers[a]&&obj.headers[a].classList.remove("selected");for(a=l;a<=i;a++)obj.rows[a]&&obj.rows[a].classList.remove("selected")}else var t=0;return obj.highlighted=[],obj.selectedCell=null,obj.corner.style.top="-2000px",obj.corner.style.left="-2000px",1==e&&1==t&&obj.dispatch("onblur",el),t},obj.updateSelection=function(e,t,o){var n,r=e.getAttribute("data-x"),e=e.getAttribute("data-y");t=t?(n=t.getAttribute("data-x"),t.getAttribute("data-y")):(n=r,e),obj.updateSelectionFromCoords(r,e,n,t,o)},obj.updateSelectionFromCoords=function(e,t,o,n,r){var i,s,l,a,u=obj.resetSelection();if(null==t&&(t=0,n=obj.rows.length-1),null==o&&(o=e),null==n&&(n=t),e>=obj.headers.length&&(e=obj.headers.length-1),t>=obj.rows.length&&(t=obj.rows.length-1),o>=obj.headers.length&&(o=obj.headers.length-1),n>=obj.rows.length&&(n=obj.rows.length-1),obj.selectedCell=[e,t,o,n],null!=e){obj.records[t][e]&&obj.records[t][e].classList.add("highlight-selected"),s=parseInt(e)<parseInt(o)?(i=parseInt(e),parseInt(o)):(i=parseInt(o),parseInt(e)),a=parseInt(t)<parseInt(n)?(l=parseInt(t),parseInt(n)):(l=parseInt(n),parseInt(t));for(var c=i;c<=s;c++)for(var d,p,h,f=l;f<=a;f++)obj.records[f][c]&&obj.records[f][c].getAttribute("data-merged")&&(h=parseInt(obj.records[f][c].getAttribute("data-x")),d=parseInt(obj.records[f][c].getAttribute("data-y")),1<(p=parseInt(obj.records[f][c].getAttribute("colspan")))&&(h<i&&(i=h),s<h+p&&(s=h+p-1)),(h=parseInt(obj.records[f][c].getAttribute("rowspan")))&&(d<l&&(l=d),a<d+h&&(a=d+h-1)));for(var b=null,m=null,g=null,j=null,f=l;f<=a;f++)"none"!=obj.rows[f].style.display&&(null==g&&(g=f),j=f);for(c=i;c<=s;c++){for(f=l;f<=a;f++)"none"!=obj.rows[f].style.display&&"none"!=obj.records[f][c].style.display&&(obj.records[f][c].classList.add("highlight"),obj.highlighted.push(obj.records[f][c]));"hidden"!=obj.options.columns[c].type&&(null==b&&(b=c),m=c)}for(m=m||0,c=b=b||0;c<=m;c++)"hidden"!=obj.options.columns[c].type&&(obj.records[g]&&obj.records[g][c]&&obj.records[g][c].classList.add("highlight-top"),obj.records[j]&&obj.records[j][c]&&obj.records[j][c].classList.add("highlight-bottom"),obj.headers[c].classList.add("selected"));for(f=g;f<=j;f++)obj.rows[f]&&"none"!=obj.rows[f].style.display&&(obj.records[f][b].classList.add("highlight-left"),obj.records[f][m].classList.add("highlight-right"),obj.rows[f].classList.add("selected"));obj.selectedContainer=[b,g,m,j]}0==u&&(obj.dispatch("onfocus",el),obj.removeCopyingSelection()),obj.dispatch("onselection",el,b,g,m,j,r),obj.updateCornerPosition()},obj.removeCopySelection=function(){for(var e=0;e<obj.selection.length;e++)obj.selection[e].classList.remove("selection"),obj.selection[e].classList.remove("selection-left"),obj.selection[e].classList.remove("selection-right"),obj.selection[e].classList.remove("selection-top"),obj.selection[e].classList.remove("selection-bottom");obj.selection=[]},obj.updateCopySelection=function(e,t){obj.removeCopySelection();var o,n,r,i,s=obj.selectedContainer[0],l=obj.selectedContainer[1],a=obj.selectedContainer[2],u=obj.selectedContainer[3];if(null!=e&&null!=t){(n=0<e-a?(o=parseInt(a)+1,parseInt(e)):(o=parseInt(e),parseInt(s)-1))-o<=(i=0<t-u?(r=parseInt(u)+1,parseInt(t)):(r=parseInt(t),parseInt(l)-1))-r?(o=parseInt(s),n=parseInt(a)):(r=parseInt(l),i=parseInt(u));for(var c=r;c<=i;c++)for(var d=o;d<=n;d++)obj.records[c][d]&&"none"!=obj.rows[c].style.display&&"none"!=obj.records[c][d].style.display&&(obj.records[c][d].classList.add("selection"),obj.records[r][d].classList.add("selection-top"),obj.records[i][d].classList.add("selection-bottom"),obj.records[c][o].classList.add("selection-left"),obj.records[c][n].classList.add("selection-right"),obj.selection.push(obj.records[c][d]))}},obj.updateCornerPosition=function(){var e,t,o,n,r,i,s,l;obj.highlighted.length?(e=(r=obj.highlighted[obj.highlighted.length-1]).getAttribute("data-x"),t=(l=obj.content.getBoundingClientRect()).left,l=l.top,o=(r=r.getBoundingClientRect()).left,s=r.top,n=r.width,r=r.height,i=o-t+obj.content.scrollLeft+n-4,s=s-l+obj.content.scrollTop+r-4,obj.corner.style.top=s+"px",obj.corner.style.left=i+"px",obj.options.freezeColumns?(l=obj.getFreezeWidth(),e>obj.options.freezeColumns-1&&o-t+n<l?obj.corner.style.display="none":1==obj.options.selectionCopy&&(obj.corner.style.display="")):1==obj.options.selectionCopy&&(obj.corner.style.display="")):(obj.corner.style.top="-2000px",obj.corner.style.left="-2000px")},obj.updateScroll=function(e){var t,o=obj.content.getBoundingClientRect(),n=o.left,r=o.top,i=o.width,o=o.height,s=obj.records[obj.selectedCell[3]][obj.selectedCell[2]].getBoundingClientRect(),l=s.left,a=s.top,u=s.width,s=s.height,l=((e=0==e||1==e?(t=l-n+obj.content.scrollLeft,a-r+obj.content.scrollTop-2):(t=l-n+obj.content.scrollLeft+u,a-r+obj.content.scrollTop+s))>obj.content.scrollTop+30&&e<obj.content.scrollTop+o||(e<obj.content.scrollTop+30?obj.content.scrollTop=e-s:obj.content.scrollTop=e-(o-2)),obj.getFreezeWidth());t>obj.content.scrollLeft+l&&t<obj.content.scrollLeft+i||(t<obj.content.scrollLeft+30?(obj.content.scrollLeft=t,obj.content.scrollLeft<50&&(obj.content.scrollLeft=0)):t<obj.content.scrollLeft+l?obj.content.scrollLeft=t-l-1:obj.content.scrollLeft=t-(i-20))},obj.getWidth=function(e){if(e)"object"==typeof e&&(e=$(e).getAttribute("data-x")),t=obj.colgroup[e].getAttribute("width");else for(var t=[],o=0;o<obj.headers.length;o++)t.push(obj.options.columns[o].width);return t},obj.setWidth=function(e,t,o){if(t){if(Array.isArray(e)){o=o||[];for(var n=0;n<e.length;n++){o[n]||(o[n]=obj.colgroup[e[n]].getAttribute("width"));var r=Array.isArray(t)&&t[n]?t[n]:t;obj.colgroup[e[n]].setAttribute("width",r),obj.options.columns[e[n]].width=r}}else o=o||obj.colgroup[e].getAttribute("width"),obj.colgroup[e].setAttribute("width",t),obj.options.columns[e].width=t;obj.setHistory({action:"setWidth",column:e,oldValue:o,newValue:t}),obj.dispatch("onresizecolumn",el,e,t,o),obj.updateCornerPosition()}},obj.setHeight=function(e,t,o){0<t&&("object"==typeof e&&(e=e.getAttribute("data-y")),o=o||((o=obj.rows[e].getAttribute("height"))||obj.rows[e].getBoundingClientRect().height),t=parseInt(t),obj.rows[e].style.height=t+"px",obj.options.rows[e]||(obj.options.rows[e]={}),obj.options.rows[e].height=t,obj.setHistory({action:"setHeight",row:e,oldValue:o,newValue:t}),obj.dispatch("onresizerow",el,e,t,o),obj.updateCornerPosition())},obj.getHeight=function(e){if(e){"object"==typeof e&&(e=$(e).getAttribute("data-y"));t=obj.rows[e].style.height}else for(var t=[],o=0;o<obj.rows.length;o++){var n=obj.rows[o].style.height;n&&(t[o]=n)}return t},obj.setFooter=function(e){if(e&&(obj.options.footers=e),obj.options.footers){obj.tfoot||(obj.tfoot=document.createElement("tfoot"),obj.table.appendChild(obj.tfoot));for(var t,o=0;o<obj.options.footers.length;o++){obj.tfoot.children[o]?t=obj.tfoot.children[o]:(t=document.createElement("tr"),n=document.createElement("td"),t.appendChild(n),obj.tfoot.appendChild(t));for(var n,r,i=0;i<obj.headers.length;i++)obj.options.footers[o][i]||(obj.options.footers[o][i]=""),obj.tfoot.children[o].children[i+1]?n=obj.tfoot.children[o].children[i+1]:(n=document.createElement("td"),t.appendChild(n),r=obj.options.columns[i].align||"center",n.style.textAlign=r),n.innerText=obj.parseValue(+obj.records.length+i,o,obj.options.footers[o][i])}}},obj.getHeader=function(e){return obj.headers[e].innerText},obj.setHeader=function(e,t){var o;obj.headers[e]&&(o=obj.headers[e].innerText,(t=t||prompt(obj.options.text.columnName,o))&&(obj.headers[e].innerText=t,obj.headers[e].setAttribute("title",t),obj.options.columns[e].title=t),obj.setHistory({action:"setHeader",column:e,oldValue:o,newValue:t}),obj.dispatch("onchangeheader",el,e,o,t))},obj.getHeaders=function(e){for(var t=[],o=0;o<obj.headers.length;o++)t.push(obj.getHeader(o));return e?t:t.join(obj.options.csvDelimiter)},obj.getMeta=function(e,t){return e?t?obj.options.meta[e]&&obj.options.meta[e][t]?obj.options.meta[e][t]:null:obj.options.meta[e]||null:obj.options.meta},obj.setMeta=function(e,t,o){if(obj.options.meta||(obj.options.meta={}),t&&o)obj.options.meta[e]||(obj.options.meta[e]={}),obj.options.meta[e][t]=o;else for(var n=Object.keys(e),r=0;r<n.length;r++){obj.options.meta[n[r]]||(obj.options.meta[n[r]]={});for(var i=Object.keys(e[n[r]]),s=0;s<i.length;s++)obj.options.meta[n[r]][i[s]]=e[n[r]][i[s]]}obj.dispatch("onchangemeta",el,e,t,o)},obj.updateMeta=function(e){if(obj.options.meta){for(var t={},o=Object.keys(obj.options.meta),n=0;n<o.length;n++)e[o[n]]?t[e[o[n]]]=obj.options.meta[o[n]]:t[o[n]]=obj.options.meta[o[n]];obj.options.meta=t}},obj.getStyle=function(e,t){if(e)return e=jexcel.getIdFromColumnName(e,!0),t?obj.records[e[1]][e[0]].style[t]:obj.records[e[1]][e[0]].getAttribute("style");for(var o={},n=obj.options.data[0].length,r=obj.options.data.length,i=0;i<r;i++)for(var s=0;s<n;s++){var l=t?obj.records[i][s].style[t]:obj.records[i][s].getAttribute("style");l&&(o[jexcel.getColumnNameFromId([s,i])]=l)}return o},obj.resetStyle=function(e,t){for(var o=Object.keys(e),n=0;n<o.length;n++){var r=jexcel.getIdFromColumnName(o[n],!0);obj.records[r[1]]&&obj.records[r[1]][r[0]]&&obj.records[r[1]][r[0]].setAttribute("style","")}obj.setStyle(e,null,null,null,t)},obj.setStyle=function(e,t,o,i,n){function r(e,t,o){var n,r=jexcel.getIdFromColumnName(e,!0);obj.records[r[1]]&&obj.records[r[1]][r[0]]&&(0==obj.records[r[1]][r[0]].classList.contains("readonly")||i)&&(n=obj.records[r[1]][r[0]].style[t],obj.records[r[1]][r[0]].style[t]=n!=o||i?o:o="",l[e]||(l[e]=[]),s[e]||(s[e]=[]),l[e].push([t+":"+n]),s[e].push([t+":"+o]))}var s={},l={};if(t&&o)if("string"==typeof e)r(e,t,o);else for(var a=[],u=0;u<e.length;u++){var c=e[u].getAttribute("data-x"),d=e[u].getAttribute("data-y"),c=jexcel.getColumnNameFromId([c,d]);a[c]||(r(c,t,o),a[c]=!0)}else for(var p=Object.keys(e),u=0;u<p.length;u++){var h=e[p[u]];"string"==typeof h&&(h=h.split(";"));for(var f=0;f<h.length;f++)"string"==typeof h[f]&&(h[f]=h[f].split(":")),h[f][0].trim()&&r(p[u],h[f][0].trim(),h[f][1])}for(p=Object.keys(l),u=0;u<p.length;u++)l[p[u]]=l[p[u]].join(";");for(p=Object.keys(s),u=0;u<p.length;u++)s[p[u]]=s[p[u]].join(";");n||obj.setHistory({action:"setStyle",oldValue:l,newValue:s}),obj.dispatch("onchangestyle",el,e,t,o)},obj.getComments=function(e,t){if(e)return"string"==typeof e&&(e=jexcel.getIdFromColumnName(e,!0)),t?[obj.records[e[1]][e[0]].getAttribute("title"),obj.records[e[1]][e[0]].getAttribute("author")]:obj.records[e[1]][e[0]].getAttribute("title")||"";for(var o={},n=0;n<obj.options.data.length;n++)for(var r=0;r<obj.options.columns.length;r++){var i=obj.records[n][r].getAttribute("title");i&&(o[e=jexcel.getColumnNameFromId([r,n])]=i)}return o},obj.setComments=function(e,t,o){n="string"==typeof e?jexcel.getIdFromColumnName(e,!0):e;var n,r=obj.records[n[1]][n[0]].getAttribute("title"),i=[r,o=obj.records[n[1]][n[0]].getAttribute("data-author")];obj.records[n[1]][n[0]].setAttribute("title",t||""),obj.records[n[1]][n[0]].setAttribute("data-author",o||""),t?obj.records[n[1]][n[0]].classList.add("jexcel_comments"):obj.records[n[1]][n[0]].classList.remove("jexcel_comments"),obj.setHistory({action:"setComments",column:e,newValue:[t,o],oldValue:i}),obj.dispatch("oncomments",el,t,r,n,n[0],n[1])},obj.getConfig=function(){var e=obj.options;return e.style=obj.getStyle(),e.mergeCells=obj.getMerge(),e.comments=obj.getComments(),e},obj.orderBy=function(e,t){if(0<=e){if(0<Object.keys(obj.options.mergeCells).length){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}t=null==t?obj.headers[e].classList.contains("arrow-down")?1:0:t?1:0;var o=[];if("number"==obj.options.columns[e].type||"percentage"==obj.options.columns[e].type||"autonumber"==obj.options.columns[e].type||"color"==obj.options.columns[e].type)for(var n=0;n<obj.options.data.length;n++)o[n]=[n,Number(obj.options.data[n][e])];else if("calendar"==obj.options.columns[e].type||"checkbox"==obj.options.columns[e].type||"radio"==obj.options.columns[e].type)for(n=0;n<obj.options.data.length;n++)o[n]=[n,obj.options.data[n][e]];else for(n=0;n<obj.options.data.length;n++)o[n]=[n,obj.records[n][e].innerText.toLowerCase()];"function"!=typeof obj.options.sorting&&(obj.options.sorting=function(o){return function(e,t){e=e[1],t=t[1];return o?""===e&&""!==t?1:""!==e&&""===t||t<e?-1:e<t?1:0:""===e&&""!==t?1:""!==e&&""===t?-1:t<e?1:e<t?-1:0}});for(var o=o.sort(obj.options.sorting(t)),r=[],n=0;n<o.length;n++)r[n]=o[n][0];return obj.setHistory({action:"orderBy",rows:r,column:e,order:t}),obj.updateOrderArrow(e,t),obj.updateOrder(r),obj.dispatch("onsort",el,e,t),!0}},obj.updateOrderArrow=function(e,t){for(var o=0;o<obj.headers.length;o++)obj.headers[o].classList.remove("arrow-up"),obj.headers[o].classList.remove("arrow-down");t?obj.headers[e].classList.add("arrow-up"):obj.headers[e].classList.add("arrow-down")},obj.updateOrder=function(e){for(var t=[],o=0;o<e.length;o++)t[o]=obj.options.data[e[o]];obj.options.data=t;for(t=[],o=0;o<e.length;o++)t[o]=obj.records[e[o]];obj.records=t;for(t=[],o=0;o<e.length;o++)t[o]=obj.rows[e[o]];if(obj.rows=t,obj.updateTableReferences(),obj.results&&obj.results.length)obj.searchInput.value?obj.search(obj.searchInput.value):obj.closeFilter();else if(obj.results=null,(obj.pageNumber=0)<obj.options.pagination)obj.page(0);else if(1==obj.options.lazyLoading)obj.loadPage(0);else for(o=0;o<obj.rows.length;o++)obj.tbody.appendChild(obj.rows[o])},obj.moveRow=function(e,t,o){var n;if(0<Object.keys(obj.options.mergeCells).length&&(n=t<e?1:0,obj.isRowMerged(e).length||obj.isRowMerged(t,n).length)){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}if(1==obj.options.search){if(obj.results&&obj.results.length!=obj.rows.length){if(!confirm(obj.options.text.thisActionWillClearYourSearchResultsAreYouSure))return!1;obj.resetSearch()}obj.results=null}o||(0<=Array.prototype.indexOf.call(obj.tbody.children,obj.rows[t])?t<e?obj.tbody.insertBefore(obj.rows[e],obj.rows[t]):obj.tbody.insertBefore(obj.rows[e],obj.rows[t].nextSibling):obj.tbody.removeChild(obj.rows[e])),obj.rows.splice(t,0,obj.rows.splice(e,1)[0]),obj.records.splice(t,0,obj.records.splice(e,1)[0]),obj.options.data.splice(t,0,obj.options.data.splice(e,1)[0]),0<obj.options.pagination&&obj.tbody.children.length!=obj.options.pagination&&obj.page(obj.pageNumber),obj.setHistory({action:"moveRow",oldValue:e,newValue:t}),obj.updateTableReferences(),obj.dispatch("onmoverow",el,e,t)},obj.insertRow=function(e,t,o){if(1==obj.options.allowInsertRow){var n,r=[],o=(0<e?n=e:(n=1,e&&(r=e)),!!o),e=obj.options.data.length-1;if((null==t||t>=parseInt(e)||t<0)&&(t=e),!1===obj.dispatch("onbeforeinsertrow",el,t,n,o))return!1;if(0<Object.keys(obj.options.mergeCells).length&&obj.isRowMerged(t,o).length){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}if(1==obj.options.search){if(obj.results&&obj.results.length!=obj.rows.length){if(!confirm(obj.options.text.thisActionWillClearYourSearchResultsAreYouSure))return!1;obj.resetSearch()}obj.results=null}for(var i=o?t:t+1,e=obj.records.splice(i),s=obj.options.data.splice(i),l=obj.rows.splice(i),a=[],u=[],c=[],d=i;d<n+i;d++){obj.options.data[d]=[];for(var p=0;p<obj.options.columns.length;p++)obj.options.data[d][p]=r[p]||"";var h=obj.createRow(d,obj.options.data[d]);l[0]?0<=Array.prototype.indexOf.call(obj.tbody.children,l[0])&&obj.tbody.insertBefore(h,l[0]):0<=Array.prototype.indexOf.call(obj.tbody.children,obj.rows[t])&&obj.tbody.appendChild(h),a.push(obj.records[d]),u.push(obj.options.data[d]),c.push(h)}Array.prototype.push.apply(obj.records,e),Array.prototype.push.apply(obj.options.data,s),Array.prototype.push.apply(obj.rows,l),0<obj.options.pagination&&obj.page(obj.pageNumber),obj.setHistory({action:"insertRow",rowNumber:t,numOfRows:n,insertBefore:o,rowRecords:a,rowData:u,rowNode:c}),obj.updateTableReferences(),obj.dispatch("oninsertrow",el,t,n,a,o)}},obj.deleteRow=function(e,t){if(1==obj.options.allowDeleteRow)if(1==obj.options.allowDeletingAllRows||1<obj.options.data.length){null==e&&(t=(o=obj.getSelectedRows())[0]?(e=parseInt(o[0].getAttribute("data-y")),o.length):(e=obj.options.data.length-1,1));var o=obj.options.data.length-1;if((e=null==e||o<e||e<0?o:e)+(t=t||1)>=obj.options.data.length&&(t=obj.options.data.length-e),!1===obj.dispatch("onbeforedeleterow",el,e,t))return!1;if(-1<parseInt(e)){var n=!1;if(0<Object.keys(obj.options.mergeCells).length)for(var r=e;r<e+t;r++)obj.isRowMerged(r,!1).length&&(n=!0);if(n){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}if(1==obj.options.search){if(obj.results&&obj.results.length!=obj.rows.length){if(!confirm(obj.options.text.thisActionWillClearYourSearchResultsAreYouSure))return!1;obj.resetSearch()}obj.results=null}0==obj.options.allowDeletingAllRows&&1+o===t&&(t--,console.error("Jspreadsheet: It is not possible to delete the last row"));for(r=e;r<e+t;r++)0<=Array.prototype.indexOf.call(obj.tbody.children,obj.rows[r])&&(obj.rows[r].className="",obj.rows[r].parentNode.removeChild(obj.rows[r]));var o=obj.records.splice(e,t),i=obj.options.data.splice(e,t),s=obj.rows.splice(e,t);0<obj.options.pagination&&obj.tbody.children.length!=obj.options.pagination&&obj.page(obj.pageNumber),obj.conditionalSelectionUpdate(1,e,e+t-1),obj.setHistory({action:"deleteRow",rowNumber:e,numOfRows:t,insertBefore:1,rowRecords:o,rowData:i,rowNode:s}),obj.updateTableReferences(),obj.dispatch("ondeleterow",el,e,t,o)}}else console.error("Jspreadsheet: It is not possible to delete the last row")},obj.moveColumn=function(e,t){var o;if(0<Object.keys(obj.options.mergeCells).length&&(o=t<e?1:0,obj.isColMerged(e).length||obj.isColMerged(t,o).length)){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}e=parseInt(e);if((t=parseInt(t))<e){obj.headerContainer.insertBefore(obj.headers[e],obj.headers[t]),obj.colgroupContainer.insertBefore(obj.colgroup[e],obj.colgroup[t]);for(var n=0;n<obj.rows.length;n++)obj.rows[n].insertBefore(obj.records[n][e],obj.records[n][t])}else{obj.headerContainer.insertBefore(obj.headers[e],obj.headers[t].nextSibling),obj.colgroupContainer.insertBefore(obj.colgroup[e],obj.colgroup[t].nextSibling);for(n=0;n<obj.rows.length;n++)obj.rows[n].insertBefore(obj.records[n][e],obj.records[n][t].nextSibling)}obj.options.columns.splice(t,0,obj.options.columns.splice(e,1)[0]),obj.headers.splice(t,0,obj.headers.splice(e,1)[0]),obj.colgroup.splice(t,0,obj.colgroup.splice(e,1)[0]);for(n=0;n<obj.rows.length;n++)obj.options.data[n].splice(t,0,obj.options.data[n].splice(e,1)[0]),obj.records[n].splice(t,0,obj.records[n].splice(e,1)[0]);if(obj.options.footers)for(n=0;n<obj.options.footers.length;n++)obj.options.footers[n].splice(t,0,obj.options.footers[n].splice(e,1)[0]);obj.setHistory({action:"moveColumn",oldValue:e,newValue:t}),obj.updateTableReferences(),obj.dispatch("onmovecolumn",el,e,t)},obj.insertColumn=function(e,t,o,n){if(1==obj.options.allowInsertColumn){var r,i=[],o=(0<e?r=e:(r=1,e&&(i=e)),!!o),e=obj.options.columns.length-1;if((null==t||t>=parseInt(e)||t<0)&&(t=e),!1===obj.dispatch("onbeforeinsertcolumn",el,t,r,o))return!1;if(0<Object.keys(obj.options.mergeCells).length&&obj.isColMerged(t,o).length){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}n=n||[];for(var s=0;s<r;s++)n[s]||(n[s]={type:"text",source:[],options:[],width:obj.options.defaultColWidth,align:obj.options.defaultColAlign});for(var l=o?t:t+1,e=(obj.options.columns=jexcel.injectArray(obj.options.columns,l,n),obj.headers.splice(l)),a=obj.colgroup.splice(l),u=[],c=[],d=[],p=[],h=[],f=l;f<r+l;f++)obj.createCellHeader(f),obj.headerContainer.insertBefore(obj.headers[f],obj.headerContainer.children[f+1]),obj.colgroupContainer.insertBefore(obj.colgroup[f],obj.colgroupContainer.children[f+1]),u.push(obj.headers[f]),c.push(obj.colgroup[f]);if(obj.options.footers)for(var b=0;b<obj.options.footers.length;b++){h[b]=[];for(s=0;s<r;s++)h[b].push("");obj.options.footers[b].splice(l,0,h[b])}for(var m=0;m<obj.options.data.length;m++){var g=obj.options.data[m].splice(l),j=obj.records[m].splice(l);p[m]=[],d[m]=[];for(f=l;f<r+l;f++){var v=i[m]||"",y=(obj.options.data[m][f]=v,obj.createCell(f,m,obj.options.data[m][f]));obj.records[m][f]=y,obj.rows[m]&&obj.rows[m].insertBefore(y,obj.rows[m].children[f+1]),p[m].push(v),d[m].push(y)}Array.prototype.push.apply(obj.options.data[m],g),Array.prototype.push.apply(obj.records[m],j)}if(Array.prototype.push.apply(obj.headers,e),Array.prototype.push.apply(obj.colgroup,a),obj.options.nestedHeaders&&0<obj.options.nestedHeaders.length)if(obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0])for(b=0;b<obj.options.nestedHeaders.length;b++){var x=parseInt(obj.options.nestedHeaders[b][obj.options.nestedHeaders[b].length-1].colspan)+r;obj.options.nestedHeaders[b][obj.options.nestedHeaders[b].length-1].colspan=x,obj.thead.children[b].children[obj.thead.children[b].children.length-1].setAttribute("colspan",x);for(var C=(C=obj.thead.children[b].children[obj.thead.children[b].children.length-1].getAttribute("data-column")).split(","),f=l;f<r+l;f++)C.push(f);obj.thead.children[b].children[obj.thead.children[b].children.length-1].setAttribute("data-column",C)}else{x=parseInt(obj.options.nestedHeaders[0].colspan)+r;obj.options.nestedHeaders[0].colspan=x,obj.thead.children[0].children[obj.thead.children[0].children.length-1].setAttribute("colspan",x)}obj.setHistory({action:"insertColumn",columnNumber:t,numOfColumns:r,insertBefore:o,columns:n,headers:u,colgroup:c,records:d,footers:h,data:p}),obj.updateTableReferences(),obj.dispatch("oninsertcolumn",el,t,r,d,o)}},obj.deleteColumn=function(e,t){if(1==obj.options.allowDeleteColumn)if(1<obj.headers.length){null==e&&(t=(o=obj.getSelectedColumns(!0)).length?(e=parseInt(o[0]),parseInt(o.length)):(e=obj.headers.length-1,1));var o=obj.options.data[0].length-1;if((t=t||1)>obj.options.data[0].length-(e=null==e||o<e||e<0?o:e)&&(t=obj.options.data[0].length-e),!1===obj.dispatch("onbeforedeletecolumn",el,e,t))return!1;if(-1<parseInt(e)){var n=!1;if(0<Object.keys(obj.options.mergeCells).length)for(var r=e;r<e+t;r++)obj.isColMerged(r,!1).length&&(n=!0);if(n){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}for(var o=obj.options.columns.splice(e,t),r=e;r<e+t;r++)obj.colgroup[r].className="",obj.headers[r].className="",obj.colgroup[r].parentNode.removeChild(obj.colgroup[r]),obj.headers[r].parentNode.removeChild(obj.headers[r]);for(var i=obj.headers.splice(e,t),s=obj.colgroup.splice(e,t),l=[],a=[],u=[],c=0;c<obj.options.data.length;c++)for(r=e;r<e+t;r++)obj.records[c][r].className="",obj.records[c][r].parentNode.removeChild(obj.records[c][r]);for(c=0;c<obj.options.data.length;c++)a[c]=obj.options.data[c].splice(e,t),l[c]=obj.records[c].splice(e,t);if(obj.options.footers)for(c=0;c<obj.options.footers.length;c++)u[c]=obj.options.footers[c].splice(e,t);if(obj.conditionalSelectionUpdate(0,e,e+t-1),obj.options.nestedHeaders&&0<obj.options.nestedHeaders.length)if(obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0])for(var d=0;d<obj.options.nestedHeaders.length;d++){var p=parseInt(obj.options.nestedHeaders[d][obj.options.nestedHeaders[d].length-1].colspan)-t;obj.options.nestedHeaders[d][obj.options.nestedHeaders[d].length-1].colspan=p,obj.thead.children[d].children[obj.thead.children[d].children.length-1].setAttribute("colspan",p)}else{p=parseInt(obj.options.nestedHeaders[0].colspan)-t;obj.options.nestedHeaders[0].colspan=p,obj.thead.children[0].children[obj.thead.children[0].children.length-1].setAttribute("colspan",p)}obj.setHistory({action:"deleteColumn",columnNumber:e,numOfColumns:t,insertBefore:1,columns:o,headers:i,colgroup:s,records:l,footers:u,data:a}),obj.updateTableReferences(),obj.dispatch("ondeletecolumn",el,e,t,l)}}else console.error("Jspreadsheet: It is not possible to delete the last column")},obj.getSelectedRows=function(e){for(var t=[],o=0;o<obj.rows.length;o++)obj.rows[o].classList.contains("selected")&&(e?t.push(o):t.push(obj.rows[o]));return t},obj.getSelectedColumns=function(){for(var e=[],t=0;t<obj.headers.length;t++)obj.headers[t].classList.contains("selected")&&e.push(t);return e},obj.getHighlighted=function(){return obj.highlighted},obj.updateTableReferences=function(){for(var e=0;e<obj.headers.length;e++)(d=obj.headers[e].getAttribute("data-x"))!=e&&(obj.headers[e].setAttribute("data-x",e),obj.headers[e].getAttribute("title")||(obj.headers[e].innerHTML=jexcel.getColumnName(e)));for(var t=0;t<obj.rows.length;t++)obj.rows[t]&&(p=obj.rows[t].getAttribute("data-y"))!=t&&(obj.rows[t].setAttribute("data-y",t),obj.rows[t].children[0].setAttribute("data-y",t),obj.rows[t].children[0].innerHTML=t+1);for(var r=[],o=[],n=function(e,t,o,n){e!=o&&obj.records[n][o].setAttribute("data-x",o),t!=n&&obj.records[n][o].setAttribute("data-y",n),e==o&&t==n||(e=jexcel.getColumnNameFromId([e,t]),t=jexcel.getColumnNameFromId([o,n]),r[e]=t)},t=0;t<obj.records.length;t++)for(var i,s,e=0;e<obj.records[0].length;e++)obj.records[t][e]&&(d=obj.records[t][e].getAttribute("data-x"),p=obj.records[t][e].getAttribute("data-y"),obj.records[t][e].getAttribute("data-merged")?(u=jexcel.getColumnNameFromId([d,p]),c=jexcel.getColumnNameFromId([e,t]),null==o[u]&&(u==c?o[u]=!1:(i=parseInt(e-d),s=parseInt(t-p),o[u]=[c,i,s]))):n(d,p,e,t));var l=Object.keys(o);if(l.length)for(e=0;e<l.length;e++)if(o[l[e]]){for(var a=jexcel.getIdFromColumnName(l[e],!0),u=(n(d=a[0],p=a[1],d+o[l[e]][1],p+o[l[e]][2]),l[e]),c=o[l[e]][0],t=0;t<obj.options.mergeCells[u][2].length;t++){var d=parseInt(obj.options.mergeCells[u][2][t].getAttribute("data-x")),p=parseInt(obj.options.mergeCells[u][2][t].getAttribute("data-y"));obj.options.mergeCells[u][2][t].setAttribute("data-x",d+o[l[e]][1]),obj.options.mergeCells[u][2][t].setAttribute("data-y",p+o[l[e]][2])}obj.options.mergeCells[c]=obj.options.mergeCells[u],delete obj.options.mergeCells[u]}obj.updateFormulas(r),obj.updateMeta(r),obj.refreshSelection(),obj.updateTable()},obj.updateTable=function(){if(0<obj.options.minSpareRows){for(var e=0,t=obj.rows.length-1;0<=t;t--){for(var o=!1,n=0;n<obj.headers.length;n++)obj.options.data[t][n]&&(o=!0);if(o)break;e++}0<obj.options.minSpareRows-e&&obj.insertRow(obj.options.minSpareRows-e)}if(0<obj.options.minSpareCols){for(var r=0,n=obj.headers.length-1;0<=n;n--){for(o=!1,t=0;t<obj.rows.length;t++)obj.options.data[t][n]&&(o=!0);if(o)break;r++}0<obj.options.minSpareCols-r&&obj.insertColumn(obj.options.minSpareCols-r)}if("function"==typeof obj.options.updateTable){obj.options.detachForUpdates&&el.removeChild(obj.content);for(t=0;t<obj.rows.length;t++)for(n=0;n<obj.headers.length;n++)obj.options.updateTable(el,obj.records[t][n],n,t,obj.options.data[t][n],obj.records[t][n].innerText,jexcel.getColumnNameFromId([n,t]));obj.options.detachForUpdates&&el.insertBefore(obj.content,obj.pagination)}obj.options.footers&&obj.setFooter(),setTimeout(function(){obj.updateCornerPosition()},0)},obj.isReadOnly=function(e){if(e=obj.getCell(e))return!!e.classList.contains("readonly")},obj.setReadOnly=function(e,t){(e=obj.getCell(e))&&(t?e.classList.add("readonly"):e.classList.remove("readonly"))},obj.showRow=function(e){obj.rows[e].style.display=""},obj.hideRow=function(e){obj.rows[e].style.display="none"},obj.showColumn=function(e){obj.headers[e].style.display="",obj.colgroup[e].style.display="",obj.filter&&obj.filter.children.length>e+1&&(obj.filter.children[e+1].style.display="");for(var t=0;t<obj.options.data.length;t++)obj.records[t][e].style.display="";obj.resetSelection()},obj.hideColumn=function(e){obj.headers[e].style.display="none",obj.colgroup[e].style.display="none",obj.filter&&obj.filter.children.length>e+1&&(obj.filter.children[e+1].style.display="none");for(var t=0;t<obj.options.data.length;t++)obj.records[t][e].style.display="none";obj.resetSelection()},obj.showIndex=function(){obj.table.classList.remove("jexcel_hidden_index")},obj.hideIndex=function(){obj.table.classList.add("jexcel_hidden_index")},[]),secureFormula=(obj.updateFormulaChain=function(e,t,o){var n=jexcel.getColumnNameFromId([e,t]);if(obj.formula[n]&&0<obj.formula[n].length)if(chainLoopProtection[n])obj.records[t][e].innerHTML="#ERROR",obj.formula[n]="";else{chainLoopProtection[n]=!0;for(var r=0;r<obj.formula[n].length;r++){var i=jexcel.getIdFromColumnName(obj.formula[n][r],!0),s=""+obj.options.data[i[1]][i[0]];"="==s.substr(0,1)?o.push(obj.updateCell(i[0],i[1],s,!0)):Object.keys(obj.formula)[r]=null,obj.updateFormulaChain(i[0],i[1],o)}}chainLoopProtection=[]},obj.updateFormulas=function(e){for(var t=0;t<obj.options.data.length;t++)for(var o,n=0;n<obj.options.data[0].length;n++)"="!=(l=""+obj.options.data[t][n]).substr(0,1)||(o=obj.updateFormula(l,e))!=l&&(obj.options.data[t][n]=o);for(var r=[],i=Object.keys(obj.formula),t=0;t<i.length;t++){var s=i[t],l=obj.formula[s];r[s=e[s]?e[s]:s]=[];for(n=0;n<l.length;n++){var a=l[n];e[a]&&(a=e[a]),r[s].push(a)}}obj.formula=r},obj.updateFormula=function(e,t){for(var o=/[A-Z]/,n=/[0-9]/,r="",i=null,s=null,l="",a=0;a<e.length;a++)o.exec(e[a])?(i=1,s=0,l+=e[a]):n.exec(e[a])?(s=i?1:0,l+=e[a]):(r=(r+=l=i&&s?t[l]||l:l)+e[a],s=i=0,l="");return l&&(r+=l=i&&s?t[l]||l:l),r},function(e){for(var t="",o=0,n=0;n<e.length;n++)t+=1==(o='"'==e[n]?0==o?1:0:o)?e[n]:e[n].toUpperCase();return t}),scrollLeft=(obj.executeFormula=function(expression,x,y){var formulaResults=[],formulaLoopProtection=[],execute=function(expression,x,y){var parentId=jexcel.getColumnNameFromId([x,y]);if(formulaLoopProtection[parentId])return console.error("Reference loop detected"),"#ERROR";formulaLoopProtection[parentId]=!0;var tokensUpdate=function(e){for(var t=0;t<e.length;t++){var o,n,r,i,s=[],l=e[t].split(":"),a=jexcel.getIdFromColumnName(l[0],!0),l=jexcel.getIdFromColumnName(l[1],!0);n=a[0]<=l[0]?(o=a[0],l[0]):(o=l[0],a[0]),i=a[1]<=l[1]?(r=a[1],l[1]):(r=l[1],a[1]);for(var u=r;u<=i;u++)for(var c=o;c<=n;c++)s.push(jexcel.getColumnNameFromId([c,u]));expression=expression.replace(e[t],s.join(","))}},tokens=(expression=expression.replace(/\$?([A-Z]+)\$?([0-9]+)/g,"$1$2"),expression.match(/([A-Z]+[0-9]+)\:([A-Z]+[0-9]+)/g)),tokens=(tokens&&tokens.length&&tokensUpdate(tokens),expression.match(/([A-Z]+[0-9]+)/g));if(tokens&&-1<tokens.indexOf(parentId))return console.error("Self Reference detected"),"#ERROR";var formulaExpressions={};if(tokens)for(var i=0,position,value,value,number;i<tokens.length;i++){obj.formula[tokens[i]]||(obj.formula[tokens[i]]=[]),obj.formula[tokens[i]].indexOf(parentId)<0&&obj.formula[tokens[i]].push(parentId),eval("typeof("+tokens[i]+') == "undefined"')&&(position=jexcel.getIdFromColumnName(tokens[i],1),value=void 0!==obj.options.data[position[1]]&&void 0!==obj.options.data[position[1]][position[0]]?obj.options.data[position[1]][position[0]]:"","="==(""+value).substr(0,1)&&(formulaResults[tokens[i]]?value=formulaResults[tokens[i]]:(value=execute(value,position[0],position[1]),formulaResults[tokens[i]]=value)),""==(""+value).trim()?formulaExpressions[tokens[i]]=null:value==Number(value)&&1==obj.options.autoCasting?formulaExpressions[tokens[i]]=Number(value):(number=obj.parseNumber(value,position[0]),1==obj.options.autoCasting&&number?formulaExpressions[tokens[i]]=number:formulaExpressions[tokens[i]]='"'+value+'"'))}try{var res=jexcel.formula(expression.substr(1),formulaExpressions,x,y,obj)}catch(e){var res="#ERROR";console.log(e)}return res};return execute(expression,x,y)},obj.parseNumber=function(e,t){var t=t&&obj.options.columns[t].decimal?obj.options.columns[t].decimal:".",o=""+e;return(o=o.split(t))[0]=o[0].match(/[+-]?[0-9]/g),o[0]&&(o[0]=o[0].join("")),o[1]&&(o[1]=o[1].match(/[0-9]*/g).join("")),e=o[0]&&0<=Number(o[0])?o[1]?Number(o[0]+"."+o[1]):Number(o[0]+".00"):null},obj.row=function(e){},obj.col=function(e){},obj.up=function(e,t){e?0<obj.selectedCell[3]&&obj.up.visible(1,t?0:1):(0<obj.selectedCell[1]&&obj.up.visible(0,t?0:1),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),1==obj.options.lazyLoading?0==obj.selectedCell[1]||0==obj.selectedCell[3]?(obj.loadPage(0),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3])):obj.loadValidation()?obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]):(e=parseInt(obj.tbody.firstChild.getAttribute("data-y")),obj.selectedCell[1]-e<30&&(obj.loadUp(),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]))):0<obj.options.pagination&&((t=obj.whichPage(obj.selectedCell[3]))!=obj.pageNumber&&obj.page(t)),obj.updateScroll(1)},obj.up.visible=function(e,t){var o,n;if(n=0==e?(o=parseInt(obj.selectedCell[0]),parseInt(obj.selectedCell[1])):(o=parseInt(obj.selectedCell[2]),parseInt(obj.selectedCell[3])),0==t){for(var r=0;r<n;r++)if("none"!=obj.records[r][o].style.display&&"none"!=obj.rows[r].style.display){n=r;break}}else n=obj.up.get(o,n);0==e?(obj.selectedCell[0]=o,obj.selectedCell[1]=n):(obj.selectedCell[2]=o,obj.selectedCell[3]=n)},obj.up.get=function(e,t){for(var e=parseInt(e),o=(t=parseInt(t))-1;0<=o;o--)if("none"!=obj.records[o][e].style.display&&"none"!=obj.rows[o].style.display&&(!obj.records[o][e].getAttribute("data-merged")||obj.records[o][e]!=obj.records[t][e])){t=o;break}return t},obj.down=function(e,t){e?obj.selectedCell[3]<obj.records.length-1&&obj.down.visible(1,t?0:1):(obj.selectedCell[1]<obj.records.length-1&&obj.down.visible(0,t?0:1),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),1==obj.options.lazyLoading?obj.selectedCell[1]==obj.records.length-1||obj.selectedCell[3]==obj.records.length-1?(obj.loadPage(-1),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3])):obj.loadValidation()?obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]):parseInt(obj.tbody.lastChild.getAttribute("data-y"))-obj.selectedCell[3]<30&&(obj.loadDown(),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3])):0<obj.options.pagination&&((e=obj.whichPage(obj.selectedCell[3]))!=obj.pageNumber&&obj.page(e)),obj.updateScroll(3)},obj.down.visible=function(e,t){var o,n;if(n=0==e?(o=parseInt(obj.selectedCell[0]),parseInt(obj.selectedCell[1])):(o=parseInt(obj.selectedCell[2]),parseInt(obj.selectedCell[3])),0==t){for(var r=obj.rows.length-1;n<r;r--)if("none"!=obj.records[r][o].style.display&&"none"!=obj.rows[r].style.display){n=r;break}}else n=obj.down.get(o,n);0==e?(obj.selectedCell[0]=o,obj.selectedCell[1]=n):(obj.selectedCell[2]=o,obj.selectedCell[3]=n)},obj.down.get=function(e,t){for(var e=parseInt(e),o=(t=parseInt(t))+1;o<obj.rows.length;o++)if("none"!=obj.records[o][e].style.display&&"none"!=obj.rows[o].style.display&&(!obj.records[o][e].getAttribute("data-merged")||obj.records[o][e]!=obj.records[t][e])){t=o;break}return t},obj.right=function(e,t){e?obj.selectedCell[2]<obj.headers.length-1&&obj.right.visible(1,t?0:1):(obj.selectedCell[0]<obj.headers.length-1&&obj.right.visible(0,t?0:1),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.updateScroll(2)},obj.right.visible=function(e,t){var o,n;if(n=0==e?(o=parseInt(obj.selectedCell[0]),parseInt(obj.selectedCell[1])):(o=parseInt(obj.selectedCell[2]),parseInt(obj.selectedCell[3])),0==t){for(var r=obj.headers.length-1;o<r;r--)if("none"!=obj.records[n][r].style.display){o=r;break}}else o=obj.right.get(o,n);0==e?(obj.selectedCell[0]=o,obj.selectedCell[1]=n):(obj.selectedCell[2]=o,obj.selectedCell[3]=n)},obj.right.get=function(e,t){for(var e=parseInt(e),t=parseInt(t),o=e+1;o<obj.headers.length;o++)if("none"!=obj.records[t][o].style.display&&(!obj.records[t][o].getAttribute("data-merged")||obj.records[t][o]!=obj.records[t][e])){e=o;break}return e},obj.left=function(e,t){e?0<obj.selectedCell[2]&&obj.left.visible(1,t?0:1):(0<obj.selectedCell[0]&&obj.left.visible(0,t?0:1),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.updateScroll(0)},obj.left.visible=function(e,t){var o,n;if(n=0==e?(o=parseInt(obj.selectedCell[0]),parseInt(obj.selectedCell[1])):(o=parseInt(obj.selectedCell[2]),parseInt(obj.selectedCell[3])),0==t){for(var r=0;r<o;r++)if("none"!=obj.records[n][r].style.display){o=r;break}}else o=obj.left.get(o,n);0==e?(obj.selectedCell[0]=o,obj.selectedCell[1]=n):(obj.selectedCell[2]=o,obj.selectedCell[3]=n)},obj.left.get=function(e,t){for(var e=parseInt(e),t=parseInt(t),o=e-1;0<=o;o--)if("none"!=obj.records[t][o].style.display&&(!obj.records[t][o].getAttribute("data-merged")||obj.records[t][o]!=obj.records[t][e])){e=o;break}return e},obj.first=function(e,t){e?t?obj.selectedCell[3]=0:obj.left.visible(1,0):(t?obj.selectedCell[1]=0:obj.left.visible(0,0),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),1!=obj.options.lazyLoading||0!=obj.selectedCell[1]&&0!=obj.selectedCell[3]?0<obj.options.pagination&&((e=obj.whichPage(obj.selectedCell[3]))!=obj.pageNumber&&obj.page(e)):obj.loadPage(0),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.updateScroll(1)},obj.last=function(e,t){e?t?obj.selectedCell[3]=obj.records.length-1:obj.right.visible(1,0):(t?obj.selectedCell[1]=obj.records.length-1:obj.right.visible(0,0),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),1!=obj.options.lazyLoading||obj.selectedCell[1]!=obj.records.length-1&&obj.selectedCell[3]!=obj.records.length-1?0<obj.options.pagination&&((e=obj.whichPage(obj.selectedCell[3]))!=obj.pageNumber&&obj.page(e)):obj.loadPage(-1),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.updateScroll(3)},obj.selectAll=function(){obj.selectedCell||(obj.selectedCell=[]),obj.selectedCell[0]=0,obj.selectedCell[1]=0,obj.selectedCell[2]=obj.headers.length-1,obj.selectedCell[3]=obj.records.length-1,obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3])},obj.loadPage=function(e){t=1==obj.options.search&&obj.results?obj.results:obj.rows;for(var t,o=100*(e=null!=e&&-1!=e?e:Math.ceil(t.length/100)-1),n=100*e+100,r=o=(o=(n=n>t.length?t.length:n)-100)<0?0:o;r<n;r++)1==obj.options.search&&obj.results?obj.tbody.appendChild(obj.rows[t[r]]):obj.tbody.appendChild(obj.rows[r]),100<obj.tbody.children.length&&obj.tbody.removeChild(obj.tbody.firstChild)},obj.loadUp=function(){var e,t=0;if(100<(e=1==obj.options.search&&obj.results?obj.results:obj.rows).length){var o=parseInt(obj.tbody.firstChild.getAttribute("data-y"));if(0<(o=1==obj.options.search&&obj.results?e.indexOf(o):o))for(var n=0;n<30;n++)-1<(o-=1)&&(1==obj.options.search&&obj.results?obj.tbody.insertBefore(obj.rows[e[o]],obj.tbody.firstChild):obj.tbody.insertBefore(obj.rows[o],obj.tbody.firstChild),100<obj.tbody.children.length&&(obj.tbody.removeChild(obj.tbody.lastChild),t=1))}return t},obj.loadDown=function(){var e,t=0;if(100<(e=1==obj.options.search&&obj.results?obj.results:obj.rows).length){var o=parseInt(obj.tbody.lastChild.getAttribute("data-y"));if((o=1==obj.options.search&&obj.results?e.indexOf(o):o)<obj.rows.length-1)for(var n=0;n<=30;n++)o<e.length&&(1==obj.options.search&&obj.results?obj.tbody.appendChild(obj.rows[e[o]]):obj.tbody.appendChild(obj.rows[o]),100<obj.tbody.children.length&&(obj.tbody.removeChild(obj.tbody.firstChild),t=1)),o+=1}return t},obj.loadValidation=function(){if(obj.selectedCell){var e=parseInt(obj.tbody.firstChild.getAttribute("data-y"))/100,t=parseInt(obj.selectedCell[3]/100),o=parseInt(obj.rows.length/100);if(e!=t&&t<=o&&!Array.prototype.indexOf.call(obj.tbody.children,obj.rows[obj.selectedCell[3]]))return obj.loadPage(t),!0}return!1},obj.resetSearch=function(){obj.searchInput.value="",obj.search(""),obj.results=null},obj.search=function(s){var l;return s=s&&s.toLowerCase(),obj.options.filters&&obj.resetFilters(),obj.resetSelection(),obj.pageNumber=0,obj.results=[],s?(l=function(e){-1==obj.results.indexOf(e)&&obj.results.push(e)},obj.options.data.filter(function(e,t){if(function(e,t,o){for(var n=0;n<e.length;n++)if(0<=(""+e[n]).toLowerCase().search(t)||0<=(""+obj.records[o][n].innerHTML).toLowerCase().search(t))return!0;return!1}(e,s,t)){var o=obj.isRowMerged(t);if(o.length)for(var n=0;n<o.length;n++)for(var r=jexcel.getIdFromColumnName(o[n],!0),i=0;i<obj.options.mergeCells[o[n]][1];i++)l(r[1]+i);else l(t);return!0}return!1})):obj.results=null,obj.updateResult()},obj.updateResult=function(){for(var e=0,t=0,e=1==obj.options.lazyLoading?100:0<obj.options.pagination?obj.options.pagination:(obj.results||obj.rows).length;obj.tbody.firstChild;)obj.tbody.removeChild(obj.tbody.firstChild);for(var o=0;o<obj.rows.length;o++)!obj.results||-1<obj.results.indexOf(o)?(t<e&&(obj.tbody.appendChild(obj.rows[o]),t++),obj.rows[o].style.display=""):obj.rows[o].style.display="none";return 0<obj.options.pagination&&obj.updatePagination(),obj.updateCornerPosition(),e},obj.whichPage=function(e){return 1==obj.options.search&&obj.results&&(e=obj.results.indexOf(e)),Math.ceil((parseInt(e)+1)/parseInt(obj.options.pagination))-1},obj.page=function(e){var t,o=obj.pageNumber,n=(t=1==obj.options.search&&obj.results?obj.results:obj.rows,parseInt(obj.options.pagination)),r=(null!=e&&-1!=e||(e=Math.ceil(t.length/n)-1),(obj.pageNumber=e)*n),i=e*n+n;for(i>t.length&&(i=t.length),r<0&&(r=0);obj.tbody.firstChild;)obj.tbody.removeChild(obj.tbody.firstChild);for(var s=r;s<i;s++)1==obj.options.search&&obj.results?obj.tbody.appendChild(obj.rows[t[s]]):obj.tbody.appendChild(obj.rows[s]);0<obj.options.pagination&&obj.updatePagination(),obj.updateCornerPosition(),obj.dispatch("onchangepage",el,e,o)},obj.updatePagination=function(){if(obj.pagination.children[0].innerHTML="",obj.pagination.children[1].innerHTML="",obj.options.pagination)if(o=(1==obj.options.search&&obj.results?obj.results:obj.rows).length){var e,t,o=Math.ceil(o/obj.options.pagination);obj.pageNumber<6?(e=1,t=o<10?o:10):o-obj.pageNumber<5?(e=(t=o)-9)<1&&(e=1):(e=obj.pageNumber-4,t=obj.pageNumber+5),1<e&&((n=document.createElement("div")).className="jexcel_page",n.innerHTML="<",n.title=1,obj.pagination.children[1].appendChild(n));for(var n,r=e;r<=t;r++)(n=document.createElement("div")).className="jexcel_page",n.innerHTML=r,obj.pagination.children[1].appendChild(n),obj.pageNumber==r-1&&n.classList.add("jexcel_page_selected");t<o&&((n=document.createElement("div")).className="jexcel_page",n.innerHTML=">",n.title=o,obj.pagination.children[1].appendChild(n));obj.pagination.children[0].innerHTML=function(e){var o=Array.prototype.slice.call(arguments,1);return e.replace(/{(\d+)}/g,function(e,t){return void 0!==o[t]?o[t]:e})}(obj.options.text.showingPage,obj.pageNumber+1,o)}else obj.pagination.children[0].innerHTML=obj.options.text.noRecordsFound},obj.download=function(e){var t;0==obj.options.allowExport?console.error("Export not allowed"):(t="",t+=obj.copy(!1,obj.options.csvDelimiter,!0,e,!0),e=new Blob(["\ufeff"+t],{type:"text/csv;charset=utf-8;"}),window.navigator&&window.navigator.msSaveOrOpenBlob?window.navigator.msSaveOrOpenBlob(e,obj.options.csvFileName+".csv"):(t=document.createElement("a"),e=URL.createObjectURL(e),t.href=e,t.setAttribute("download",obj.options.csvFileName+".csv"),document.body.appendChild(t),t.click(),t.parentNode.removeChild(t)))},obj.setHistory=function(e){var t;1!=obj.ignoreHistory&&(t=++obj.historyIndex,obj.history=obj.history=obj.history.slice(0,1+t),obj.history[t]=e)},obj.copy=function(e,t,o,n,r){t=t||"\t";for(var i=new RegExp(t,"ig"),s=[],l=[],a=[],u=[],c=[],d=obj.options.data[0].length,p=obj.options.data.length,h="",f=!1,b="",m="",g=0,j=0,v=0,y=0,x=!0,C=0;C<p;C++)for(var w=0;w<d;w++)e&&!obj.records[C][w].classList.contains("highlight")||(v<=w&&(v=w),y<=C&&(y=C));if(d===v+1&&p===y+1&&(x=!1),r&&1==obj.options.includeHeadersOnDownload||!r&&1==obj.options.includeHeadersOnCopy&&!x||n){if(obj.options.nestedHeaders&&0<obj.options.nestedHeaders.length)for(h=obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0]?obj.options.nestedHeaders:[obj.options.nestedHeaders],C=0;C<h.length;C++){for(var E=[],w=0;w<h[C].length;w++){var A=parseInt(h[C][w].colspan);E.push(h[C][w].title);for(var N=0;N<A-1;N++)E.push("")}m+=E.join(t)+"\r\n"}f=!0}obj.style=[];for(C=0;C<p;C++){for(var L,I,l=[],a=[],w=0;w<d;w++)e&&!obj.records[C][w].classList.contains("highlight")||(1==f&&s.push(obj.headers[w].innerText),(L=obj.options.data[C][w]).match&&(L.match(i)||L.match(/,/g)||L.match(/\n/)||L.match(/\"/))&&(L='"'+(L=L.replace(new RegExp('"',"g"),'""'))+'"'),l.push(L),"checkbox"==obj.options.columns[w].type||"radio"==obj.options.columns[w].type?I=L:(I=1==obj.options.stripHTMLOnCopy?obj.records[C][w].innerText:obj.records[C][w].innerHTML).match&&(I.match(i)||I.match(/,/g)||I.match(/\n/)||I.match(/\"/))&&(I='"'+(I=I.replace(new RegExp('"',"g"),'""'))+'"'),a.push(I),h=(h=obj.records[C][w].getAttribute("style")).replace("display: none;",""),obj.style.push(h||""));l.length&&(f&&(g=l.length,u.push(s.join(t))),u.push(l.join(t))),a.length&&(j++,f&&(c.push(s.join(t)),f=!1),c.push(a.join(t)))}r=(b=d==g&&p==j?m:b)+u.join("\r\n"),x=b+c.join("\r\n");if(o||(1==obj.options.copyCompatibility?obj.textarea.value=x:obj.textarea.value=r,obj.textarea.select(),document.execCommand("copy")),1==obj.options.copyCompatibility?obj.data=x:obj.data=r,obj.hashString=obj.hash(obj.data),!o){if(obj.removeCopyingSelection(),obj.highlighted)for(w=0;w<obj.highlighted.length;w++)obj.highlighted[w].classList.add("copying"),obj.highlighted[w].classList.contains("highlight-left")&&obj.highlighted[w].classList.add("copying-left"),obj.highlighted[w].classList.contains("highlight-right")&&obj.highlighted[w].classList.add("copying-right"),obj.highlighted[w].classList.contains("highlight-top")&&obj.highlighted[w].classList.add("copying-top"),obj.highlighted[w].classList.contains("highlight-bottom")&&obj.highlighted[w].classList.add("copying-bottom");obj.dispatch("oncopy",el,1==obj.options.copyCompatibility?c:u,obj.hashString)}return obj.data},obj.paste=function(e,t,o){var n=obj.dispatch("onbeforepaste",el,o,e,t);if(!1===n)return!1;var n=obj.hash(o=n?n:o),r=n==obj.hashString?obj.style:null,o=(1==obj.options.copyCompatibility&&n==obj.hashString&&(o=obj.data),obj.parseCSV(o,"\t"));if(null!=e&&null!=t&&o){for(var i,s=0,l=0,a=[],u={},c={},d=0,p=parseInt(e),h=parseInt(t);i=o[l];){for(s=0,p=parseInt(e);null!=i[s];){var f=obj.updateCell(p,h,i[s]);if(a.push(f),obj.updateFormulaChain(p,h,a),r&&r[d]&&(u[f=jexcel.getColumnNameFromId([p,h])]=r[d],c[f]=obj.getStyle(f),obj.records[h][p].setAttribute("style",r[d]),d++),null!=i[++s]){if(p>=obj.headers.length-1){if(1!=obj.options.allowInsertColumn)break;obj.insertColumn()}p=obj.right.get(p,h)}}if(o[++l]){if(h>=obj.rows.length-1){if(1!=obj.options.allowInsertRow)break;obj.insertRow()}h=obj.down.get(e,h)}}obj.updateSelectionFromCoords(e,t,p,h),obj.setHistory({action:"setValue",records:a,selection:obj.selectedCell,newStyle:u,oldStyle:c}),obj.updateTable(),obj.dispatch("onpaste",el,o),obj.onafterchanges(el,a)}obj.removeCopyingSelection()},obj.removeCopyingSelection=function(){for(var e=document.querySelectorAll(".jexcel .copying"),t=0;t<e.length;t++)e[t].classList.remove("copying"),e[t].classList.remove("copying-left"),e[t].classList.remove("copying-right"),e[t].classList.remove("copying-top"),e[t].classList.remove("copying-bottom")},obj.historyProcessRow=function(e,t){var o=t.insertBefore?+t.rowNumber:t.rowNumber+1;if(1==obj.options.search&&obj.results&&obj.results.length!=obj.rows.length&&obj.resetSearch(),1==e){for(var n=t.numOfRows,r=o;r<n+o;r++)obj.rows[r].parentNode.removeChild(obj.rows[r]);obj.records.splice(o,n),obj.options.data.splice(o,n),obj.rows.splice(o,n),obj.conditionalSelectionUpdate(1,o,n+o-1)}else{obj.records=jexcel.injectArray(obj.records,o,t.rowRecords),obj.options.data=jexcel.injectArray(obj.options.data,o,t.rowData),obj.rows=jexcel.injectArray(obj.rows,o,t.rowNode);for(var i=0,r=o;r<t.numOfRows+o;r++)obj.tbody.insertBefore(t.rowNode[i],obj.tbody.children[r]),i++}0<obj.options.pagination&&obj.page(obj.pageNumber),obj.updateTableReferences()},obj.historyProcessColumn=function(e,t){var o=t.insertBefore?t.columnNumber:t.columnNumber+1;if(1==e){var n=t.numOfColumns;obj.options.columns.splice(o,n);for(var r=o;r<n+o;r++)obj.headers[r].parentNode.removeChild(obj.headers[r]),obj.colgroup[r].parentNode.removeChild(obj.colgroup[r]);obj.headers.splice(o,n),obj.colgroup.splice(o,n);for(var i=0;i<t.data.length;i++){for(r=o;r<n+o;r++)obj.records[i][r].parentNode.removeChild(obj.records[i][r]);obj.records[i].splice(o,n),obj.options.data[i].splice(o,n)}if(obj.options.footers)for(i=0;i<obj.options.footers.length;i++)obj.options.footers[i].splice(o,n)}else{obj.options.columns=jexcel.injectArray(obj.options.columns,o,t.columns),obj.headers=jexcel.injectArray(obj.headers,o,t.headers),obj.colgroup=jexcel.injectArray(obj.colgroup,o,t.colgroup);for(var s=0,r=o;r<t.numOfColumns+o;r++)obj.headerContainer.insertBefore(t.headers[s],obj.headerContainer.children[r+1]),obj.colgroupContainer.insertBefore(t.colgroup[s],obj.colgroupContainer.children[r+1]),s++;for(i=0;i<t.data.length;i++){obj.options.data[i]=jexcel.injectArray(obj.options.data[i],o,t.data[i]),obj.records[i]=jexcel.injectArray(obj.records[i],o,t.records[i]);for(s=0,r=o;r<t.numOfColumns+o;r++)obj.rows[i].insertBefore(t.records[i][s],obj.rows[i].children[r+1]),s++}if(obj.options.footers)for(i=0;i<obj.options.footers.length;i++)obj.options.footers[i]=jexcel.injectArray(obj.options.footers[i],o,t.footers[i])}if(obj.options.nestedHeaders&&0<obj.options.nestedHeaders.length)if(obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0])for(var l,i=0;i<obj.options.nestedHeaders.length;i++)l=1==e?parseInt(obj.options.nestedHeaders[i][obj.options.nestedHeaders[i].length-1].colspan)-t.numOfColumns:parseInt(obj.options.nestedHeaders[i][obj.options.nestedHeaders[i].length-1].colspan)+t.numOfColumns,obj.options.nestedHeaders[i][obj.options.nestedHeaders[i].length-1].colspan=l,obj.thead.children[i].children[obj.thead.children[i].children.length-1].setAttribute("colspan",l);else l=1==e?parseInt(obj.options.nestedHeaders[0].colspan)-t.numOfColumns:parseInt(obj.options.nestedHeaders[0].colspan)+t.numOfColumns,obj.options.nestedHeaders[0].colspan=l,obj.thead.children[0].children[obj.thead.children[0].children.length-1].setAttribute("colspan",l);obj.updateTableReferences()},obj.undo=function(){var e=!!obj.ignoreEvents,t=!!obj.ignoreHistory,o=(obj.ignoreEvents=!0,obj.ignoreHistory=!0,[]);if(0<=obj.historyIndex){var n=obj.history[obj.historyIndex--];if("insertRow"==n.action)obj.historyProcessRow(1,n);else if("deleteRow"==n.action)obj.historyProcessRow(0,n);else if("insertColumn"==n.action)obj.historyProcessColumn(1,n);else if("deleteColumn"==n.action)obj.historyProcessColumn(0,n);else if("moveRow"==n.action)obj.moveRow(n.newValue,n.oldValue);else if("moveColumn"==n.action)obj.moveColumn(n.newValue,n.oldValue);else if("setMerge"==n.action)obj.removeMerge(n.column,n.data);else if("setStyle"==n.action)obj.setStyle(n.oldValue,null,null,1);else if("setWidth"==n.action)obj.setWidth(n.column,n.oldValue);else if("setHeight"==n.action)obj.setHeight(n.row,n.oldValue);else if("setHeader"==n.action)obj.setHeader(n.column,n.oldValue);else if("setComments"==n.action)obj.setComments(n.column,n.oldValue[0],n.oldValue[1]);else if("orderBy"==n.action){for(var r=[],i=0;i<n.rows.length;i++)r[n.rows[i]]=i;obj.updateOrderArrow(n.column,n.order?0:1),obj.updateOrder(r)}else if("setValue"==n.action){for(var s=0;s<n.records.length;s++)o.push({x:n.records[s].x,y:n.records[s].y,newValue:n.records[s].oldValue}),n.oldStyle&&obj.resetStyle(n.oldStyle);obj.setValue(o),n.selection&&obj.updateSelectionFromCoords(n.selection[0],n.selection[1],n.selection[2],n.selection[3])}}obj.ignoreEvents=e,obj.ignoreHistory=t,obj.dispatch("onundo",el,n)},obj.redo=function(){var e=!!obj.ignoreEvents,t=!!obj.ignoreHistory;obj.ignoreEvents=!0,obj.ignoreHistory=!0;if(obj.historyIndex<obj.history.length-1){var o=obj.history[++obj.historyIndex];if("insertRow"==o.action)obj.historyProcessRow(0,o);else if("deleteRow"==o.action)obj.historyProcessRow(1,o);else if("insertColumn"==o.action)obj.historyProcessColumn(0,o);else if("deleteColumn"==o.action)obj.historyProcessColumn(1,o);else if("moveRow"==o.action)obj.moveRow(o.oldValue,o.newValue);else if("moveColumn"==o.action)obj.moveColumn(o.oldValue,o.newValue);else if("setMerge"==o.action)obj.setMerge(o.column,o.colspan,o.rowspan,1);else if("setStyle"==o.action)obj.setStyle(o.newValue,null,null,1);else if("setWidth"==o.action)obj.setWidth(o.column,o.newValue);else if("setHeight"==o.action)obj.setHeight(o.row,o.newValue);else if("setHeader"==o.action)obj.setHeader(o.column,o.newValue);else if("setComments"==o.action)obj.setComments(o.column,o.newValue[0],o.newValue[1]);else if("orderBy"==o.action)obj.updateOrderArrow(o.column,o.order),obj.updateOrder(o.rows);else if("setValue"==o.action){obj.setValue(o.records);for(var n=0;n<o.records.length;n++)o.oldStyle&&obj.resetStyle(o.newStyle);o.selection&&obj.updateSelectionFromCoords(o.selection[0],o.selection[1],o.selection[2],o.selection[3])}}obj.ignoreEvents=e,obj.ignoreHistory=t,obj.dispatch("onredo",el,o)},obj.getDropDownValue=function(e,t){var o=[];if(obj.options.columns[e]&&obj.options.columns[e].source){for(var n=[],r=obj.options.columns[e].source,i=0;i<r.length;i++)"object"==typeof r[i]?n[r[i].id]=r[i].name:n[r[i]]=r[i];for(var s=Array.isArray(t)?t:(""+t).split(";"),i=0;i<s.length;i++)"object"==typeof s[i]?o.push(n[s[i].id]):n[s[i]]&&o.push(n[s[i]])}else console.error("Invalid column");return 0<o.length?o.join("; "):""},obj.parseCSV=function(e,t){9==(e=e.replace(/\r?\n$|\r$|\n$/g,"")).charCodeAt(e.length-1)&&(e+="\0"),t=t||",";for(var o=[],n=!1,r=0,i=0,s=0;s<e.length;s++){var l=e[s],a=e[s+1];o[r]=o[r]||[],o[r][i]=o[r][i]||"",'"'==l&&n&&'"'==a?(o[r][i]+=l,++s):'"'==l?n=!n:l!=t||n?"\r"!=l||"\n"!=a||n?("\n"!=l||n)&&("\r"!=l||n)?o[r][i]+=l:(++r,i=0):(++r,i=0,++s):++i}return o},obj.hash=function(e){var t,o=0;if(0===e.length)return o;for(t=0;t<e.length;t++)o=(o<<5)-o+e.charCodeAt(t),o|=0;return o},obj.onafterchanges=function(e,t){obj.dispatch("onafterchanges",e,t)},obj.destroy=function(){jexcel.destroy(el)},obj.init=function(){jexcel.current=obj,"function"==typeof jexcel.build&&(obj.options.root?jexcel.build(obj.options.root):(jexcel.build(document),jexcel.build=null)),el.setAttribute("tabindex",1),el.addEventListener("focus",function(e){jexcel.current&&!obj.selectedCell&&(obj.updateSelectionFromCoords(0,0,0,0),obj.left())}),obj.options.csv?(1==obj.options.loadingSpin&&jSuites.loading.show(),jSuites.ajax({url:obj.options.csv,method:obj.options.method,data:obj.options.requestVariables,dataType:"text",success:function(e){e=obj.parseCSV(e,obj.options.csvDelimiter);if(1==obj.options.csvHeaders&&0<e.length)for(var t=e.shift(),o=0;o<t.length;o++)obj.options.columns[o]||(obj.options.columns[o]={type:"text",align:obj.options.defaultColAlign,width:obj.options.defaultColWidth}),void 0===obj.options.columns[o].title&&(obj.options.columns[o].title=t[o]);obj.options.data=e,obj.prepareTable(),1==obj.options.loadingSpin&&jSuites.loading.hide()}})):obj.options.url?(1==obj.options.loadingSpin&&jSuites.loading.show(),jSuites.ajax({url:obj.options.url,method:obj.options.method,data:obj.options.requestVariables,dataType:"json",success:function(e){obj.options.data=e.data||e,obj.prepareTable(),1==obj.options.loadingSpin&&jSuites.loading.hide()}})):obj.prepareTable()},options&&null!=options.contextMenu?obj.options.contextMenu=options.contextMenu:obj.options.contextMenu=function(e,t,o,n){var r,i=[];return null==o?(1==obj.options.allowInsertColumn&&i.push({title:obj.options.text.insertANewColumnBefore,onclick:function(){obj.insertColumn(1,parseInt(t),1)}}),1==obj.options.allowInsertColumn&&i.push({title:obj.options.text.insertANewColumnAfter,onclick:function(){obj.insertColumn(1,parseInt(t),0)}}),1==obj.options.allowDeleteColumn&&i.push({title:obj.options.text.deleteSelectedColumns,onclick:function(){obj.deleteColumn(obj.getSelectedColumns().length?void 0:parseInt(t))}}),1==obj.options.allowRenameColumn&&i.push({title:obj.options.text.renameThisColumn,onclick:function(){obj.setHeader(t)}}),1==obj.options.columnSorting&&(i.push({type:"line"}),i.push({title:obj.options.text.orderAscending,onclick:function(){obj.orderBy(t,0)}}),i.push({title:obj.options.text.orderDescending,onclick:function(){obj.orderBy(t,1)}}))):(1==obj.options.allowInsertRow&&(i.push({title:obj.options.text.insertANewRowBefore,onclick:function(){obj.insertRow(1,parseInt(o),1)}}),i.push({title:obj.options.text.insertANewRowAfter,onclick:function(){obj.insertRow(1,parseInt(o))}})),1==obj.options.allowDeleteRow&&i.push({title:obj.options.text.deleteSelectedRows,onclick:function(){obj.deleteRow(obj.getSelectedRows().length?void 0:parseInt(o))}}),t&&1==obj.options.allowComments&&(i.push({type:"line"}),r=obj.records[o][t].getAttribute("title")||"",i.push({title:r?obj.options.text.editComments:obj.options.text.addComments,onclick:function(){var e=prompt(obj.options.text.comments,r);e&&obj.setComments([t,o],e)}}),r&&i.push({title:obj.options.text.clearComments,onclick:function(){obj.setComments([t,o],"")}}))),i.push({type:"line"}),i.push({title:obj.options.text.copy,shortcut:"Ctrl + C",onclick:function(){obj.copy(!0)}}),navigator&&navigator.clipboard&&i.push({title:obj.options.text.paste,shortcut:"Ctrl + V",onclick:function(){obj.selectedCell&&navigator.clipboard.readText().then(function(e){e&&jexcel.current.paste(obj.selectedCell[0],obj.selectedCell[1],e)})}}),obj.options.allowExport&&i.push({title:obj.options.text.saveAs,shortcut:"Ctrl + S",onclick:function(){obj.download()}}),obj.options.about&&i.push({title:obj.options.text.about,onclick:function(){!0===obj.options.about?alert(Version().print()):alert(obj.options.about)}}),i},obj.scrollControls=function(e){obj.wheelControls(),0<obj.options.freezeColumns&&obj.content.scrollLeft!=scrollLeft&&obj.updateFreezePosition(),1!=obj.options.lazyLoading&&1!=obj.options.tableOverflow||obj.edition&&"jdropdown"!=e.target.className.substr(0,9)&&obj.closeEditor(obj.edition[0],!0)},obj.wheelControls=function(e){1==obj.options.lazyLoading&&null==jexcel.timeControlLoading&&(jexcel.timeControlLoading=setTimeout(function(){obj.content.scrollTop+obj.content.clientHeight>=obj.content.scrollHeight-10?obj.loadDown()&&(obj.content.scrollTop+obj.content.clientHeight>obj.content.scrollHeight-10&&(obj.content.scrollTop=obj.content.scrollTop-obj.content.clientHeight),obj.updateCornerPosition()):obj.content.scrollTop<=obj.content.clientHeight&&obj.loadUp()&&(obj.content.scrollTop<10&&(obj.content.scrollTop=obj.content.scrollTop+obj.content.clientHeight),obj.updateCornerPosition()),jexcel.timeControlLoading=null},100))},obj.getFreezeWidth=function(){var e=0;if(0<obj.options.freezeColumns)for(var t=0;t<obj.options.freezeColumns;t++)e+=parseInt(obj.options.columns[t].width);return e},0);return obj.updateFreezePosition=function(){var e=0;if(50<(scrollLeft=obj.content.scrollLeft))for(var t=0;t<obj.options.freezeColumns;t++){0<t&&"hidden"!==obj.options.columns[t-1].type&&(e+=parseInt(obj.options.columns[t-1].width)),obj.headers[t].classList.add("jexcel_freezed"),obj.headers[t].style.left=e+"px";for(var o,n=0;n<obj.rows.length;n++)obj.rows[n]&&obj.records[n][t]&&(o=scrollLeft+(0<t?obj.records[n][t-1].style.width:0)-51+"px",obj.records[n][t].classList.add("jexcel_freezed"),obj.records[n][t].style.left=o)}else for(t=0;t<obj.options.freezeColumns;t++){obj.headers[t].classList.remove("jexcel_freezed"),obj.headers[t].style.left="";for(n=0;n<obj.rows.length;n++)obj.records[n][t]&&(obj.records[n][t].classList.remove("jexcel_freezed"),obj.records[n][t].style.left="")}obj.updateCornerPosition()},el.addEventListener("DOMMouseScroll",obj.wheelControls),el.addEventListener("mousewheel",obj.wheelControls),el.jexcel=obj,el.jspreadsheet=obj,obj.init(),obj};return jexcel.setDictionary=function(e){jSuites.setDictionary(e)},jexcel.setExtensions=function(e){for(var t=Object.keys(e),o=0;o<t.length;o++)"function"==typeof e[t[o]]&&(jexcel[t[o]]=e[t[o]],jexcel.license&&"function"==typeof e[t[o]].license&&e[t[o]].license(jexcel.license))},void 0!==formula&&(jexcel.formula=formula),jexcel.version=Version,jexcel.current=null,jexcel.timeControl=null,jexcel.timeControlLoading=null,jexcel.destroy=function(e,t){var o;e.jexcel&&(o=e.jexcel.options.root||document,e.removeEventListener("DOMMouseScroll",e.jexcel.scrollControls),e.removeEventListener("mousewheel",e.jexcel.scrollControls),e.jexcel=null,e.innerHTML="",t&&(o.removeEventListener("mouseup",jexcel.mouseUpControls),o.removeEventListener("mousedown",jexcel.mouseDownControls),o.removeEventListener("mousemove",jexcel.mouseMoveControls),o.removeEventListener("mouseover",jexcel.mouseOverControls),o.removeEventListener("dblclick",jexcel.doubleClickControls),o.removeEventListener("paste",jexcel.pasteControls),o.removeEventListener("contextmenu",jexcel.contextMenuControls),o.removeEventListener("touchstart",jexcel.touchStartControls),o.removeEventListener("touchend",jexcel.touchEndControls),o.removeEventListener("touchcancel",jexcel.touchEndControls),document.removeEventListener("keydown",jexcel.keyDownControls),jexcel=null))},jexcel.build=function(e){e.addEventListener("mouseup",jexcel.mouseUpControls),e.addEventListener("mousedown",jexcel.mouseDownControls),e.addEventListener("mousemove",jexcel.mouseMoveControls),e.addEventListener("mouseover",jexcel.mouseOverControls),e.addEventListener("dblclick",jexcel.doubleClickControls),e.addEventListener("paste",jexcel.pasteControls),e.addEventListener("contextmenu",jexcel.contextMenuControls),e.addEventListener("touchstart",jexcel.touchStartControls),e.addEventListener("touchend",jexcel.touchEndControls),e.addEventListener("touchcancel",jexcel.touchEndControls),e.addEventListener("touchmove",jexcel.touchEndControls),document.addEventListener("keydown",jexcel.keyDownControls)},jexcel.keyDownControls=function(e){var t,o,n;jexcel.current&&(jexcel.current.edition&&(27==e.which?(jexcel.current.edition&&jexcel.current.closeEditor(jexcel.current.edition[0],!1),e.preventDefault()):13==e.which?"calendar"==jexcel.current.options.columns[jexcel.current.edition[2]].type?jexcel.current.closeEditor(jexcel.current.edition[0],!0):"dropdown"!=jexcel.current.options.columns[jexcel.current.edition[2]].type&&"autocomplete"!=jexcel.current.options.columns[jexcel.current.edition[2]].type&&((1==jexcel.current.options.wordWrap||1==jexcel.current.options.columns[jexcel.current.edition[2]].wordWrap||200<jexcel.current.options.data[jexcel.current.edition[3]][jexcel.current.edition[2]].length)&&e.altKey?(n=jexcel.current.edition[0].children[0],o=jexcel.current.edition[0].children[0].value,t=n.selectionStart,o=o.slice(0,t)+"\n"+o.slice(t),n.value=o,n.focus(),n.selectionStart=t+1,n.selectionEnd=t+1):jexcel.current.edition[0].children[0].blur()):9==e.which&&("calendar"==jexcel.current.options.columns[jexcel.current.edition[2]].type?jexcel.current.closeEditor(jexcel.current.edition[0],!0):jexcel.current.edition[0].children[0].blur())),!jexcel.current.edition&&jexcel.current.selectedCell?37==e.which?(jexcel.current.left(e.shiftKey,e.ctrlKey),e.preventDefault()):39==e.which?(jexcel.current.right(e.shiftKey,e.ctrlKey),e.preventDefault()):38==e.which?(jexcel.current.up(e.shiftKey,e.ctrlKey),e.preventDefault()):40==e.which?(jexcel.current.down(e.shiftKey,e.ctrlKey),e.preventDefault()):36==e.which?(jexcel.current.first(e.shiftKey,e.ctrlKey),e.preventDefault()):35==e.which?(jexcel.current.last(e.shiftKey,e.ctrlKey),e.preventDefault()):32==e.which?(1==jexcel.current.options.editable&&jexcel.current.setCheckRadioValue(),e.preventDefault()):46==e.which?1==jexcel.current.options.editable&&(jexcel.current.selectedRow?1==jexcel.current.options.allowDeleteRow&&confirm(jexcel.current.options.text.areYouSureToDeleteTheSelectedRows)&&jexcel.current.deleteRow():jexcel.current.selectedHeader?1==jexcel.current.options.allowDeleteColumn&&confirm(jexcel.current.options.text.areYouSureToDeleteTheSelectedColumns)&&jexcel.current.deleteColumn():jexcel.current.setValue(jexcel.current.highlighted,"")):13==e.which?(e.shiftKey?jexcel.current.up():(1==jexcel.current.options.allowInsertRow&&1==jexcel.current.options.allowManualInsertRow&&jexcel.current.selectedCell[1]==jexcel.current.options.data.length-1&&jexcel.current.insertRow(),jexcel.current.down()),e.preventDefault()):9==e.which?(e.shiftKey?jexcel.current.left():(1==jexcel.current.options.allowInsertColumn&&1==jexcel.current.options.allowManualInsertColumn&&jexcel.current.selectedCell[0]==jexcel.current.options.data[0].length-1&&jexcel.current.insertColumn(),jexcel.current.right()),e.preventDefault()):!e.ctrlKey&&!e.metaKey||e.shiftKey?jexcel.current.selectedCell&&1==jexcel.current.options.editable&&(o=jexcel.current.selectedCell[1],n=jexcel.current.selectedCell[0],"readonly"!=jexcel.current.options.columns[n].type&&(32==e.keyCode?"checkbox"==jexcel.current.options.columns[n].type||"radio"==jexcel.current.options.columns[n].type?e.preventDefault():jexcel.current.openEditor(jexcel.current.records[o][n],!0):113==e.keyCode?jexcel.current.openEditor(jexcel.current.records[o][n],!1):(8==e.keyCode||48<=e.keyCode&&e.keyCode<=57||96<=e.keyCode&&e.keyCode<=111||187<=e.keyCode&&e.keyCode<=190||(String.fromCharCode(e.keyCode)==e.key||String.fromCharCode(e.keyCode).toLowerCase()==e.key.toLowerCase())&&jexcel.validLetter(String.fromCharCode(e.keyCode)))&&(jexcel.current.openEditor(jexcel.current.records[o][n],!0),"calendar"==jexcel.current.options.columns[n].type&&e.preventDefault()))):65==e.which?(jexcel.current.selectAll(),e.preventDefault()):83==e.which?(jexcel.current.download(),e.preventDefault()):89==e.which?(jexcel.current.redo(),e.preventDefault()):90==e.which?(jexcel.current.undo(),e.preventDefault()):67==e.which?(jexcel.current.copy(!0),e.preventDefault()):88==e.which?(1==jexcel.current.options.editable?jexcel.cutControls():jexcel.copyControls(),e.preventDefault()):86==e.which&&jexcel.pasteControls():e.target.classList.contains("jexcel_search")&&(jexcel.timeControl&&clearTimeout(jexcel.timeControl),jexcel.timeControl=setTimeout(function(){jexcel.current.search(e.target.value)},200)))},jexcel.isMouseAction=!1,jexcel.mouseDownControls=function(e){t=(e=e||window.event).buttons||e.button||e.which;var n,t,o,r,i=jexcel.getElement(e.target);if(i[0]?jexcel.current!=i[0].jexcel&&(jexcel.current&&(jexcel.current.edition&&jexcel.current.closeEditor(jexcel.current.edition[0],!0),jexcel.current.resetSelection()),jexcel.current=i[0].jexcel):jexcel.current&&(jexcel.current.edition&&jexcel.current.closeEditor(jexcel.current.edition[0],!0),jexcel.current.resetSelection(!0),jexcel.current=null),jexcel.current&&1==t){if(e.target.classList.contains("jexcel_selectall"))jexcel.current&&jexcel.current.selectAll();else if(e.target.classList.contains("jexcel_corner"))1==jexcel.current.options.editable&&(jexcel.current.selectedCorner=!0);else{if(1==i[1])if(o=e.target.getAttribute("data-x")){var s,l,a=e.target.getBoundingClientRect();if(1==jexcel.current.options.columnResize&&a.width-e.offsetX<6){jexcel.current.resizing={mousePosition:e.pageX,column:o,width:a.width},jexcel.current.headers[o].classList.add("resizing");for(var u=0;u<jexcel.current.records.length;u++)jexcel.current.records[u][o]&&jexcel.current.records[u][o].classList.add("resizing")}else if(1==jexcel.current.options.columnDrag&&a.height-e.offsetY<6)if(jexcel.current.isColMerged(o).length)console.error("Jspreadsheet: This column is part of a merged cell.");else{jexcel.current.resetSelection(),jexcel.current.dragging={element:e.target,column:o,destination:o},jexcel.current.headers[o].classList.add("dragging");for(u=0;u<jexcel.current.records.length;u++)jexcel.current.records[u][o]&&jexcel.current.records[u][o].classList.add("dragging")}else l=jexcel.current.selectedHeader&&(e.shiftKey||e.ctrlKey)?(s=jexcel.current.selectedHeader,o):(jexcel.current.selectedHeader==o&&1==jexcel.current.options.allowRenameColumn&&(jexcel.timeControl=setTimeout(function(){jexcel.current.setHeader(o)},800)),s=jexcel.current.selectedHeader=o),jexcel.current.updateSelectionFromCoords(s,0,l,jexcel.current.options.data.length-1)}else e.target.parentNode.classList.contains("jexcel_nested")&&(t=e.target.getAttribute("data-column")?(t=e.target.getAttribute("data-column").split(","),r=parseInt(t[0]),parseInt(t[t.length-1])):(r=0,jexcel.current.options.columns.length-1),jexcel.current.updateSelectionFromCoords(r,0,t,jexcel.current.options.data.length-1));else jexcel.current.selectedHeader=!1;2==i[1]?(r=e.target.getAttribute("data-y"),e.target.classList.contains("jexcel_row")?(a=e.target.getBoundingClientRect(),1==jexcel.current.options.rowResize&&a.height-e.offsetY<6?(jexcel.current.resizing={element:e.target.parentNode,mousePosition:e.pageY,row:r,height:a.height},e.target.parentNode.classList.add("resizing")):1==jexcel.current.options.rowDrag&&a.width-e.offsetX<6?jexcel.current.isRowMerged(r).length?console.error("Jspreadsheet: This row is part of a merged cell"):1==jexcel.current.options.search&&jexcel.current.results?console.error("Jspreadsheet: Please clear your search before perform this action"):(jexcel.current.resetSelection(),jexcel.current.dragging={element:e.target.parentNode,row:r,destination:r},e.target.parentNode.classList.add("dragging")):(l=jexcel.current.selectedRow&&(e.shiftKey||e.ctrlKey)?(s=jexcel.current.selectedRow,r):s=jexcel.current.selectedRow=r,jexcel.current.updateSelectionFromCoords(0,s,jexcel.current.options.data[0].length-1,l))):e.target.classList.contains("jclose")&&e.target.clientWidth-e.offsetX<50&&e.offsetY<50?jexcel.current.closeEditor(jexcel.current.edition[0],!0):(t=(n=function(e){var t=e.getAttribute("data-x"),o=e.getAttribute("data-y");return t&&o?[t,o]:e.parentNode?n(e.parentNode):void 0})(e.target))&&(o=t[0],r=t[1],!jexcel.current.edition||jexcel.current.edition[2]==o&&jexcel.current.edition[3]==r||jexcel.current.closeEditor(jexcel.current.edition[0],!0),jexcel.current.edition||(e.shiftKey?jexcel.current.updateSelectionFromCoords(jexcel.current.selectedCell[0],jexcel.current.selectedCell[1],o,r):jexcel.current.updateSelectionFromCoords(o,r)),jexcel.current.selectedHeader=null,jexcel.current.selectedRow=null)):jexcel.current.selectedRow=!1,e.target.classList.contains("jexcel_page")&&("<"==e.target.innerText?jexcel.current.page(0):">"==e.target.innerText?jexcel.current.page(e.target.getAttribute("title")-1):jexcel.current.page(e.target.innerText-1))}jexcel.current.edition?jexcel.isMouseAction=!1:jexcel.isMouseAction=!0}else jexcel.isMouseAction=!1},jexcel.mouseUpControls=function(e){if(jexcel.current)if(jexcel.current.resizing){if(jexcel.current.resizing.column){var t=jexcel.current.colgroup[jexcel.current.resizing.column].getAttribute("width"),o=jexcel.current.getSelectedColumns();if(1<o.length){for(var n=[],r=0;r<o.length;r++)n.push(parseInt(jexcel.current.colgroup[o[r]].getAttribute("width")));n[o.indexOf(parseInt(jexcel.current.resizing.column))]=jexcel.current.resizing.width,jexcel.current.setWidth(o,t,n)}else jexcel.current.setWidth(jexcel.current.resizing.column,t,jexcel.current.resizing.width);jexcel.current.headers[jexcel.current.resizing.column].classList.remove("resizing");for(var i=0;i<jexcel.current.records.length;i++)jexcel.current.records[i][jexcel.current.resizing.column]&&jexcel.current.records[i][jexcel.current.resizing.column].classList.remove("resizing")}else{jexcel.current.rows[jexcel.current.resizing.row].children[0].classList.remove("resizing");t=jexcel.current.rows[jexcel.current.resizing.row].getAttribute("height");jexcel.current.setHeight(jexcel.current.resizing.row,t,jexcel.current.resizing.height),jexcel.current.resizing.element.classList.remove("resizing")}jexcel.current.resizing=null}else if(jexcel.current.dragging){if(jexcel.current.dragging){if(jexcel.current.dragging.column){t=e.target.getAttribute("data-x");jexcel.current.headers[jexcel.current.dragging.column].classList.remove("dragging");for(i=0;i<jexcel.current.rows.length;i++)jexcel.current.records[i][jexcel.current.dragging.column]&&jexcel.current.records[i][jexcel.current.dragging.column].classList.remove("dragging");for(r=0;r<jexcel.current.headers.length;r++)jexcel.current.headers[r].classList.remove("dragging-left"),jexcel.current.headers[r].classList.remove("dragging-right");t&&jexcel.current.dragging.column!=jexcel.current.dragging.destination&&jexcel.current.moveColumn(jexcel.current.dragging.column,jexcel.current.dragging.destination)}else{var s;jexcel.current.dragging.element.nextSibling?(s=parseInt(jexcel.current.dragging.element.nextSibling.getAttribute("data-y")),jexcel.current.dragging.row<s&&--s):s=parseInt(jexcel.current.dragging.element.previousSibling.getAttribute("data-y")),jexcel.current.dragging.row!=jexcel.current.dragging.destination&&jexcel.current.moveRow(jexcel.current.dragging.row,s,!0),jexcel.current.dragging.element.classList.remove("dragging")}jexcel.current.dragging=null}}else jexcel.current.selectedCorner&&(jexcel.current.selectedCorner=!1,0<jexcel.current.selection.length&&(jexcel.current.copyData(jexcel.current.selection[0],jexcel.current.selection[jexcel.current.selection.length-1]),jexcel.current.removeCopySelection()));jexcel.timeControl&&(clearTimeout(jexcel.timeControl),jexcel.timeControl=null),jexcel.isMouseAction=!1},jexcel.mouseMoveControls=function(e){if((e=e||window.event).buttons||e.button||e.which||(jexcel.isMouseAction=!1),jexcel.current)if(1==jexcel.isMouseAction){if(jexcel.current.resizing)jexcel.current.resizing.column?(t=e.pageX-jexcel.current.resizing.mousePosition,0<jexcel.current.resizing.width+t&&(t=jexcel.current.resizing.width+t,jexcel.current.colgroup[jexcel.current.resizing.column].setAttribute("width",t),jexcel.current.updateCornerPosition())):(t=e.pageY-jexcel.current.resizing.mousePosition,0<jexcel.current.resizing.height+t&&(t=jexcel.current.resizing.height+t,jexcel.current.rows[jexcel.current.resizing.row].setAttribute("height",t),jexcel.current.updateCornerPosition()));else if(jexcel.current.dragging)if(jexcel.current.dragging.column){var t=e.target.getAttribute("data-x");if(t)if(jexcel.current.isColMerged(t).length)console.error("Jspreadsheet: This column is part of a merged cell.");else{for(var o=0;o<jexcel.current.headers.length;o++)jexcel.current.headers[o].classList.remove("dragging-left"),jexcel.current.headers[o].classList.remove("dragging-right");jexcel.current.dragging.column==t?jexcel.current.dragging.destination=parseInt(t):e.target.clientWidth/2>e.offsetX?(jexcel.current.dragging.column<t?jexcel.current.dragging.destination=parseInt(t)-1:jexcel.current.dragging.destination=parseInt(t),jexcel.current.headers[t].classList.add("dragging-left")):(jexcel.current.dragging.column<t?jexcel.current.dragging.destination=parseInt(t):jexcel.current.dragging.destination=parseInt(t)+1,jexcel.current.headers[t].classList.add("dragging-right"))}}else{var t=e.target.getAttribute("data-y");t&&(jexcel.current.isRowMerged(t).length?console.error("Jspreadsheet: This row is part of a merged cell."):(t=e.target.clientHeight/2>e.offsetY?e.target.parentNode.nextSibling:e.target.parentNode,jexcel.current.dragging.element!=t&&(e.target.parentNode.parentNode.insertBefore(jexcel.current.dragging.element,t),jexcel.current.dragging.destination=Array.prototype.indexOf.call(jexcel.current.dragging.element.parentNode.children,jexcel.current.dragging.element))))}}else{var t=e.target.getAttribute("data-x"),n=e.target.getAttribute("data-y"),r=e.target.getBoundingClientRect();jexcel.current.cursor&&(jexcel.current.cursor.style.cursor="",jexcel.current.cursor=null),e.target.parentNode.parentNode&&e.target.parentNode.parentNode.className&&(e.target.parentNode.parentNode.classList.contains("resizable")&&(e.target&&t&&!n&&r.width-(e.clientX-r.left)<6?(jexcel.current.cursor=e.target,jexcel.current.cursor.style.cursor="col-resize"):e.target&&!t&&n&&r.height-(e.clientY-r.top)<6&&(jexcel.current.cursor=e.target,jexcel.current.cursor.style.cursor="row-resize")),e.target.parentNode.parentNode.classList.contains("draggable")&&(e.target&&!t&&n&&r.width-(e.clientX-r.left)<6||e.target&&t&&!n&&r.height-(e.clientY-r.top)<6)&&(jexcel.current.cursor=e.target,jexcel.current.cursor.style.cursor="move"))}},jexcel.mouseOverControls=function(e){if((e=e||window.event).buttons||e.button||e.which||(jexcel.isMouseAction=!1),jexcel.current&&1==jexcel.isMouseAction){var t=jexcel.getElement(e.target);if(t[0]){if(jexcel.current!=t[0].jexcel&&jexcel.current)return!1;var o,n,r=e.target.getAttribute("data-x"),i=e.target.getAttribute("data-y");jexcel.current.resizing||jexcel.current.dragging||(1==t[1]&&jexcel.current.selectedHeader&&(r=e.target.getAttribute("data-x"),o=jexcel.current.selectedHeader,n=r,jexcel.current.updateSelectionFromCoords(o,0,n,jexcel.current.options.data.length-1)),2==t[1]&&(e.target.classList.contains("jexcel_row")?jexcel.current.selectedRow&&(o=jexcel.current.selectedRow,jexcel.current.updateSelectionFromCoords(0,o,jexcel.current.options.data[0].length-1,n=i)):jexcel.current.edition||r&&i&&(jexcel.current.selectedCorner?jexcel.current.updateCopySelection(r,i):jexcel.current.selectedCell&&jexcel.current.updateSelectionFromCoords(jexcel.current.selectedCell[0],jexcel.current.selectedCell[1],r,i))))}}jexcel.timeControl&&(clearTimeout(jexcel.timeControl),jexcel.timeControl=null)},jexcel.doubleClickControls=function(e){var t,o,n,r,i,s;jexcel.current&&(e.target.classList.contains("jexcel_corner")?0<jexcel.current.highlighted.length&&(s=jexcel.current.highlighted[0].getAttribute("data-x"),n=parseInt(jexcel.current.highlighted[jexcel.current.highlighted.length-1].getAttribute("data-y"))+1,t=jexcel.current.highlighted[jexcel.current.highlighted.length-1].getAttribute("data-x"),o=jexcel.current.records.length-1,jexcel.current.copyData(jexcel.current.records[n][s],jexcel.current.records[o][t])):e.target.classList.contains("jexcel_column_filter")?(r=e.target.getAttribute("data-x"),jexcel.current.openFilter(r)):(1==(n=jexcel.getElement(e.target))[1]&&1==jexcel.current.options.columnSorting&&(r=e.target.getAttribute("data-x"))&&jexcel.current.orderBy(r),2!=n[1]||1!=jexcel.current.options.editable||jexcel.current.edition||(s=(i=function(e){var t,o;if(e.parentNode)return t=e.getAttribute("data-x"),o=e.getAttribute("data-y"),t&&o?e:i(e.parentNode)})(e.target))&&s.classList.contains("highlight")&&jexcel.current.openEditor(s)))},jexcel.copyControls=function(e){jexcel.current&&jexcel.copyControls.enabled&&(jexcel.current.edition||jexcel.current.copy(!0))},jexcel.cutControls=function(e){!jexcel.current||jexcel.current.edition||(jexcel.current.copy(!0),1==jexcel.current.options.editable&&jexcel.current.setValue(jexcel.current.highlighted,""))},jexcel.pasteControls=function(e){jexcel.current&&jexcel.current.selectedCell&&(jexcel.current.edition||1==jexcel.current.options.editable&&(e&&e.clipboardData?(jexcel.current.paste(jexcel.current.selectedCell[0],jexcel.current.selectedCell[1],e.clipboardData.getData("text")),e.preventDefault()):window.clipboardData&&jexcel.current.paste(jexcel.current.selectedCell[0],jexcel.current.selectedCell[1],window.clipboardData.getData("text"))))},jexcel.contextMenuControls=function(e){var t,o;"buttons"in(e=e||window.event)?e.buttons:e.which||e.button,jexcel.current&&(jexcel.current.edition?e.preventDefault():jexcel.current.options.contextMenu&&(jexcel.current.contextMenu.contextmenu.close(),jexcel.current&&(o=e.target.getAttribute("data-x"),t=e.target.getAttribute("data-y"),(o||t)&&((o<parseInt(jexcel.current.selectedCell[0])||o>parseInt(jexcel.current.selectedCell[2])||t<parseInt(jexcel.current.selectedCell[1])||t>parseInt(jexcel.current.selectedCell[3]))&&jexcel.current.updateSelectionFromCoords(o,t,o,t),o=jexcel.current.options.contextMenu(jexcel.current,o,t,e),jexcel.current.contextMenu.contextmenu.open(e,o),e.preventDefault()))))},jexcel.touchStartControls=function(e){var t,o=jexcel.getElement(e.target);o[0]?jexcel.current!=o[0].jexcel&&(jexcel.current&&jexcel.current.resetSelection(),jexcel.current=o[0].jexcel):jexcel.current&&(jexcel.current.resetSelection(),jexcel.current=null),jexcel.current&&!jexcel.current.edition&&(t=e.target.getAttribute("data-x"),o=e.target.getAttribute("data-y"),t&&o&&(jexcel.current.updateSelectionFromCoords(t,o),jexcel.timeControl=setTimeout(function(){"color"==jexcel.current.options.columns[t].type?jexcel.tmpElement=null:jexcel.tmpElement=e.target,jexcel.current.openEditor(e.target,!1,e)},500)))},jexcel.touchEndControls=function(e){jexcel.timeControl&&(clearTimeout(jexcel.timeControl),jexcel.timeControl=null,jexcel.tmpElement&&"INPUT"==jexcel.tmpElement.children[0].tagName&&jexcel.tmpElement.children[0].focus(),jexcel.tmpElement=null)},jexcel.tabs=function(e,t){for(var o,n,r,i=[],s=(r=e.classList.contains("jexcel_tabs")?(o=e.children[0],e.children[1]):(e.innerHTML="",e.classList.add("jexcel_tabs"),e.jexcel=[],n=document.createElement("div"),o=e.appendChild(n),n=document.createElement("div"),e.appendChild(n)),[]),l=[],a=0;a<t.length;a++){s[a]=document.createElement("div"),s[a].classList.add("jexcel_tab");var u=jexcel(s[a],t[a]);r.appendChild(s[a]),i[a]=e.jexcel.push(u),l[a]=document.createElement("div"),l[a].classList.add("jexcel_tab_link"),l[a].setAttribute("data-spreadsheet",e.jexcel.length-1),l[a].innerHTML=t[a].sheetName,l[a].onclick=function(){for(var e=0;e<o.children.length;e++)o.children[e].classList.remove("selected"),r.children[e].style.display="none";var t=this.getAttribute("data-spreadsheet");r.children[t].style.display="block",o.children[t].classList.add("selected")},o.appendChild(l[a])}for(var c=0;c<o.children.length;c++)o.children[c].classList.remove("selected"),r.children[c].style.display="none";return o.children[o.children.length-1].classList.add("selected"),r.children[o.children.length-1].style.display="block",i},jexcel.createTabs=jexcel.tabs,jexcel.fromSpreadsheet=function(e,o){function n(b){var m=[];return b.SheetNames.forEach(function(e){var t={rows:[],columns:[],data:[],style:{}};if(t.sheetName=e,(p=b.Sheets[e]["!cols"])&&p.length)for(var o=0;o<p.length;o++)t.columns[o]={},p[o]&&p[o].wpx&&(t.columns[o].width=p[o].wpx+"px");if((p=b.Sheets[e]["!rows"])&&p.length)for(o=0;o<p.length;o++)p[o]&&p[o].hpx&&(t.rows[o]={},t.rows[o].height=p[o].hpx+"px");if((p=b.Sheets[e]["!merges"])&&0<p.length){t.mergeCells=[];for(o=0;o<p.length;o++){var n=p[o].s.c,r=p[o].s.r,i=p[o].e.c,s=p[o].e.r,l=jexcel.getColumnNameFromId([n,r]);t.mergeCells[l]=[i-n+1,s-r+1]}}for(var a,u,c=0,d=0,p=Object.keys(b.Sheets[e]),o=0;o<p.length;o++)"!"!=p[o].substr(0,1)&&(a=b.Sheets[e][p[o]],u=jexcel.getIdFromColumnName(p[o],!0),t.data[u[1]]||(t.data[u[1]]=[]),t.data[u[1]][u[0]]=a.f?"="+a.f:a.w,c<u[0]&&(c=u[0]),d<u[1]&&(d=u[1]),a.style&&0<Object.keys(a.style).length&&(t.style[p[o]]=a.style),a.s&&a.s.fgColor&&(t.style[p[o]]&&(t.style[p[o]]+=";"),t.style[p[o]]+="background-color:#"+a.s.fgColor.rgb));for(var h=t.columns,f=0;f<=d;f++)for(o=0;o<=c;o++)t.data[f]||(t.data[f]=[]),t.data[f][o]||h<o&&(t.data[f][o]="");m.push(t)}),m}var r=new XMLHttpRequest;r.open("GET",e,!0),"undefined"!=typeof Uint8Array?(r.responseType="arraybuffer",r.onload=function(e){var t=r.response,t=new Uint8Array(t),t=XLSX.read(t,{type:"array",cellFormula:!0,cellStyles:!0});o(n(t))}):(r.setRequestHeader("Accept-Charset","x-user-defined"),r.onreadystatechange=function(){var e;4==r.readyState&&200==r.status&&(e=convertResponseBodyToText(r.responseBody),e=XLSX.read(e,{type:"binary",cellFormula:!0,cellStyles:!0}),o(n(e)))}),r.send()},jexcel.validLetter=function(e){return e.match(/([\u0041-\u005A\u0061-\u007A\u00AA\u00B5\u00BA\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u0527\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0\u08A2-\u08AC\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0977\u0979-\u097F\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C33\u0C35-\u0C39\u0C3D\u0C58\u0C59\u0C60\u0C61\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D60\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F4\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191C\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19C1-\u19C7\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FCC\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA697\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA78E\uA790-\uA793\uA7A0-\uA7AA\uA7F8-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA80-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uABC0-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC-\u0400-\u04FF']+)/g)?1:0},jexcel.injectArray=function(e,t,o){return e.slice(0,t).concat(o).concat(e.slice(t))},jexcel.getColumnName=function(e){var t="";return 701<e?t=(t+=String.fromCharCode(64+parseInt(e/676)))+String.fromCharCode(64+parseInt(e%676/26)):25<e&&(t+=String.fromCharCode(64+parseInt(e/26))),t+=String.fromCharCode(65+e%26)},jexcel.getIdFromColumnName=function(e,t){var o=/^[a-zA-Z]+/.exec(e);if(o){for(var n=0,r=0;r<o[0].length;r++)n+=parseInt(o[0].charCodeAt(r)-64)*Math.pow(26,o[0].length-1-r);--n<0&&(n=0);var i=parseInt(/[0-9]+$/.exec(e));0<i&&i--,e=1==t?[n,i]:n+"-"+i}return e},jexcel.getColumnNameFromId=function(e){return Array.isArray(e)||(e=e.split("-")),jexcel.getColumnName(parseInt(e[0]))+(parseInt(e[1])+1)},jexcel.getElement=function(e){var o=0,n=0;return function e(t){t.className&&t.classList.contains("jexcel_container")&&(n=t),"THEAD"==t.tagName?o=1:"TBODY"==t.tagName&&(o=2),t.parentNode&&!n&&e(t.parentNode)}(e),[n,o]},jexcel.doubleDigitFormat=function(e){return e=1==(e=""+e).length?"0"+e:e},jexcel.createFromTable=function(e,n){if("TABLE"==e.tagName){(n=n||{}).columns=[],n.data=[];var t=e.querySelectorAll("colgroup > col");if(t.length)for(var r=0;r<t.length;r++){var o=t[r].style.width;(o=o||t[r].getAttribute("width"))&&(n.columns[r]||(n.columns[r]={}),n.columns[r].width=o)}var i=function(e){var t=e.getBoundingClientRect(),o=50<t.width?t.width:50;n.columns[r]||(n.columns[r]={}),e.getAttribute("data-celltype")?n.columns[r].type=e.getAttribute("data-celltype"):n.columns[r].type="text",n.columns[r].width=o+"px",n.columns[r].title=e.innerHTML,n.columns[r].align=e.style.textAlign||"center",(t=e.getAttribute("name"))&&(n.columns[r].name=t),(t=e.getAttribute("id"))&&(n.columns[r].id=t)},s=[];if((c=e.querySelectorAll(":scope > thead > tr")).length){for(var l=0;l<c.length-1;l++){for(var a=[],r=0;r<c[l].children.length;r++){var u={title:c[l].children[r].innerText,colspan:c[l].children[r].getAttribute("colspan")||1};a.push(u)}s.push(a)}for(var c=c[c.length-1].children,r=0;r<c.length;r++)i(c[r])}for(var d=0,p={},h={},f={},b={},m=e.querySelectorAll(":scope > tr, :scope > tbody > tr"),l=0;l<m.length;l++)if(n.data[d]=[],1!=n.parseTableFirstRowAsHeader||c.length||0!=l){for(r=0;r<m[l].children.length;r++){(A=m[l].children[r].getAttribute("data-formula"))?"="!=A.substr(0,1)&&(A="="+A):A=m[l].children[r].innerHTML,n.data[d].push(A);var g=jexcel.getColumnNameFromId([r,l]),j=m[l].children[r].getAttribute("class"),j=(j&&(b[g]=j),parseInt(m[l].children[r].getAttribute("colspan"))||0),v=parseInt(m[l].children[r].getAttribute("rowspan"))||0,j=((j||v)&&(p[g]=[j||1,v||1]),m[l].children[r].style&&"none"==m[l].children[r].style.display&&(m[l].children[r].style.display=""),m[l].children[r].getAttribute("style"));j&&(f[g]=j),m[l].children[r].classList.contains("styleBold")&&(f[g]?f[g]+="; font-weight:bold;":f[g]="font-weight:bold;")}m[l].style&&m[l].style.height&&(h[l]={height:m[l].style.height}),d++}else for(r=0;r<m[l].children.length;r++)i(m[l].children[r]);if(0<Object.keys(s).length&&(n.nestedHeaders=s),0<Object.keys(f).length&&(n.style=f),0<Object.keys(p).length&&(n.mergeCells=p),0<Object.keys(h).length&&(n.rows=h),0<Object.keys(b).length&&(n.classes=b),(m=e.querySelectorAll("tfoot tr")).length){for(var y=[],l=0;l<m.length;l++){for(var x=[],r=0;r<m[l].children.length;r++)x.push(m[l].children[r].innerText);y.push(x)}0<Object.keys(y).length&&(n.footers=y)}if(1==n.parseTableAutoCellType)for(var C=[],r=0;r<n.columns.length;r++){var w=!0,E=!0;C[r]=[];for(l=0;l<n.data.length;l++){var A=n.data[l][r];C[r][A]||(C[r][A]=0),C[r][A]++,25<A.length&&(w=!1),10==A.length&&"-"==A.substr(4,1)&&"-"==A.substr(7,1)||(E=!1)}var N=Object.keys(C[r]).length;E?n.columns[r].type="calendar":1==w&&1<N&&N<=parseInt(.1*n.data.length)&&(n.columns[r].type="dropdown",n.columns[r].source=Object.keys(C[r]))}return n}console.log("Element is not a table")},jexcel.helpers=function(){var o={getCaretIndex:function(e){var t,o=0,n=(this.config.root||window).getSelection();return n&&0!==n.rangeCount&&((t=(n=n.getRangeAt(0)).cloneRange()).selectNodeContents(e),t.setEnd(n.endContainer,n.endOffset),o=t.toString().length),o},invert:function(e){for(var t=[],o=Object.keys(e),n=0;n<o.length;n++)t[e[o[n]]]=o[n];return t},getColumnName:function(e){var t="";return 701<e?t=(t+=String.fromCharCode(64+parseInt(e/676)))+String.fromCharCode(64+parseInt(e%676/26)):25<e&&(t+=String.fromCharCode(64+parseInt(e/26))),t+=String.fromCharCode(65+e%26)},getColumnNameFromCoords:function(e,t){return o.getColumnName(parseInt(e))+(parseInt(t)+1)},getCoordsFromColumnName:function(e){var t=/^[a-zA-Z]+/.exec(e);if(t){for(var o=0,n=0;n<t[0].length;n++)o+=parseInt(t[0].charCodeAt(n)-64)*Math.pow(26,t[0].length-1-n);--o<0&&(o=0);e=parseInt(/[0-9]+$/.exec(e))||null;return 0<e&&e--,[o,e]}},createFromTable:function(){},injectArray:function(e,t,o){return e.slice(0,t).concat(o).concat(e.slice(t))},parseCSV:function(e,t){t=t||",";for(var o=0,n=0,r=[[]],i=0,s=null,l=!1,a=!1,u=0;u<e.length;u++)if(r[n]||(r[n]=[]),r[n][o]||(r[n][o]=""),"\r"!=e[u])if("\n"!=e[u]&&e[u]!=t||0!=l&&1!=a&&s){if('"'==e[u]&&(l=!l),null===s){if(1==(s=l))continue}else if(!0===s&&!a&&'"'==e[u]){'"'==e[u+1]?(l=!0,r[n][o]+=e[u],u++):a=!0;continue}r[n][o]+=e[u]}else{var c,s=null,l=!1,a=!1;'"'!=r[n][o][0]||'"'==(c=r[n][o].trim())[c.length-1]&&(r[n][o]=c.substr(1,c.length-2)),"\n"==e[u]?(o=0,n++):i<++o&&(i=o)}for(var d=0;d<r.length;d++)for(u=0;u<=i;u++)void 0===r[d][u]&&(r[d][u]="");return r}};return o}(),"undefined"!=typeof jQuery&&function(o){o.fn.jspreadsheet=o.fn.jexcel=function(e){var t=o(this).get(0);return t.jexcel?Array.isArray(t.jexcel)?t.jexcel[e][arguments[1]].apply(this,Array.prototype.slice.call(arguments,2)):t.jexcel[e].apply(this,Array.prototype.slice.call(arguments,1)):jexcel(o(this).get(0),e)}}(jQuery),jexcel}),!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.jSuites=t()}(this,function(){"use strict";u=function(e,t){return!(!e[t.type]||e[t.type]!=t)||!!e.parentNode&&u(e.parentNode,t)},(n={}).init=function(){var a=!1,s={x:null,y:null};document.addEventListener("mouseup",function(e){a&&a.e&&("function"==typeof a.e.refresh&&a.e.refresh(),a.e.style.cursor=""),a=!(s={x:null,y:null})}),document.addEventListener("mousedown",function(e){var t,o=F.findElement(e.target,"jpanel");if(o&&!o.classList.contains("readonly")){o.focus();var n=e.target.getBoundingClientRect(),r=(a={e:o,x:e.clientX,y:e.clientY,w:n.width,h:n.height,d:o.style.cursor,resizing:!!o.style.cursor},o.style.width||(o.style.width=n.width+"px"),o.style.height||(o.style.height=n.height+"px"),window.getSelection());if(r.rangeCount)for(var i=0;i<r.rangeCount;i++)r.removeRange(r.getRangeAt(i));e.preventDefault(),e.stopPropagation()}else a=!1;o=e.changedTouches&&e.changedTouches[0]?(t=e.changedTouches[0].clientX,e.changedTouches[0].clientY):(t=e.clientX,e.clientY);var n=event.path||event.composedPath&&event.composedPath(),s=n?n[0]:(e.target&&e.target.shadowRoot?e.target.shadowRoot:document).elementFromPoint(t,o);if(0<F.current.length)for(var l=0;l<F.current.length;l++)F.current[l]&&!u(s,F.current[l])&&F.current[l].close()}),document.addEventListener("mousemove",function(e){var t,o,n,r,i;a?(i=e.clientX||e.pageX,t=e.clientY||e.pageY,a.resizing?(o=n=null,"e-resize"!=a.d&&"ne-resize"!=a.d&&"se-resize"!=a.d||(n=a.w+(i-a.x),a.e.style.width=n+"px",e.shiftKey?(r=(i-a.x)*(a.h/a.w),o=a.h+r,a.e.style.height=o+"px"):r=!1),r||"s-resize"!=a.d&&"se-resize"!=a.d&&"sw-resize"!=a.d||(o=a.h+(t-a.y),a.e.style.height=o+"px"),"function"==typeof a.e.refresh&&a.e.refresh("dimensions",n,o)):(null==s.x&&null==s.y&&(s.x=i,s.y=t),r=i-s.x,n=t-s.y,o=a.e.offsetTop+n,n=a.e.offsetLeft+r,a.e.style.top=o+"px",a.e.style.left=n+"px",a.e.style.cursor="move",s.x=i,s.y=t,"function"==typeof a.e.refresh&&a.e.refresh("position",o,n))):(r=F.findElement(e.target,"jpanel"))&&r.getAttribute("tabindex")&&(i=r.getBoundingClientRect(),e.clientY-i.top<15?i.width-(e.clientX-i.left)<15?r.style.cursor="ne-resize":e.clientX-i.left<15?r.style.cursor="nw-resize":r.style.cursor="n-resize":i.height-(e.clientY-i.top)<15?i.width-(e.clientX-i.left)<15?r.style.cursor="se-resize":e.clientX-i.left<15?r.style.cursor="sw-resize":r.style.cursor="s-resize":i.width-(e.clientX-i.left)<15?r.style.cursor="e-resize":e.clientX-i.left<15?r.style.cursor="w-resize":r.style.cursor="")}),document.addEventListener("dblclick",function(e){var t=F.findElement(e.target,"jpanel");t&&"function"==typeof t.dblclick&&t.dblclick(e)}),document.addEventListener("keydown",function(e){var t=document.activeElement;t&&"Delete"==e.key&&"function"==typeof t.delete&&(t.delete(),e.preventDefault(),e.stopImmediatePropagation()),F.current.length&&(t=F.current[F.current.length-1])&&"Escape"==e.key&&"function"==typeof t.close&&(t.close(),e.preventDefault(),e.stopImmediatePropagation())}),document.addEventListener("contextmenu",function(e){var t,o=document.activeElement;o&&"function"==typeof o.contextmenu?(o.contextmenu(e),e.preventDefault(),e.stopImmediatePropagation()):(o=F.findElement(e.target,function(e){return e.tagName&&e.getAttribute("aria-contextmenu-id")}))&&((t=document.querySelector("#"+o))?(t.contextmenu.open(e),e.preventDefault(),e.stopImmediatePropagation()):console.error("JSUITES: contextmenu id not found: "+o))}),document.dictionary={},n.version="4.11.5"},n.setExtensions=function(e){if("object"==typeof e)for(var t=Object.keys(e),o=0;o<t.length;o++)n[t[o]]=e[t[o]]},n.tracking=function(e,t){1==t?(F.current=F.current.filter(function(e){return null!==e}),setTimeout(function(){F.current.push(e)},0)):0<=(t=F.current.indexOf(e))&&F.current.splice(t,1)},n.path=function(e,t){if((e=e.split(".")).length){for(var o=this,n=null;1<e.length;)if(n=e.shift(),o.hasOwnProperty(n))o=o[n];else{if(void 0===t)return;o[n]={},o=o[n]}if(n=e.shift(),void 0!==t)return o[n]=t,!0;if(o)return o[n]}return!1},n.setDictionary=function(e){document.dictionary||(document.dictionary={});for(var t=Object.keys(e),o=0;o<t.length;o++)document.dictionary[t[o]]=e[t[o]];for(var n=null,o=0;o<F.calendar.weekdays.length;o++)n=F.translate(F.calendar.weekdays[o]),F.calendar.weekdays[o]&&(F.calendar.weekdays[o]=n,F.calendar.weekdaysShort[o]=n.substr(0,3));for(o=0;o<F.calendar.months.length;o++)(n=F.translate(F.calendar.months[o]))&&(F.calendar.months[o]=n,F.calendar.monthsShort[o]=n.substr(0,3))},n.translate=function(e){return document.dictionary&&document.dictionary[e]||e},n.current=[];var n,u,e,t,s,d,p,a,h,f,b,o,r,i,l,c,m,g,j,v,y,x,F=n,C=("undefined"!=typeof document&&F.init(),F.ajax=function(o,e){if(Array.isArray(o)){var t={instance:[],complete:e};if(0<o.length)for(var n=0;n<o.length;n++)(o[n].multiple=t).instance.push(F.ajax(o[n]));return t}if(o.data||(o.data={}),o.type&&(o.method=o.type),o.method||(o.method="GET"),o.dataType||(o.dataType="json"),o.data){var u=function(e,t){var o=[],n=Object.keys(e);if(n.length)for(var r,i=0;i<n.length;i++)if(e[r=t?t+"["+n[i]+"]":n[i]]instanceof FileList)o[r]=e[n[i]];else if("object"==typeof e[n[i]])for(var s=u(e[n[i]],r),l=Object.keys(s),a=0;a<l.length;a++)o[l[a]]=s[l[a]];else o[r]=e[n[i]];return o},r=u(o.data),i=Object.keys(r);if("GET"==o.method){if(i.length){for(var s=[],n=0;n<i.length;n++)s.push(i[n]+"="+encodeURIComponent(r[i[n]]));o.url.indexOf("?")<0&&(o.url+="?"),o.url+=s.join("&")}}else for(s=new FormData,n=0;n<i.length;n++)if(r[i[n]]instanceof FileList){if(r[i[n]].length)for(var l=0;l<r[i[n]].length;l++)s.append(i[n],r[i[n]][l],r[i[n]][l].name)}else s.append(i[n],r[i[n]])}var a=new XMLHttpRequest;return a.open(o.method,o.url,!0),a.setRequestHeader("X-Requested-With","XMLHttpRequest"),o.contentType&&a.setRequestHeader("Content-Type",o.contentType),"POST"==o.method?a.setRequestHeader("Accept","application/json"):"blob"==o.dataType?a.responseType="blob":o.contentType||("json"==o.dataType?a.setRequestHeader("Content-Type","text/json"):"html"==o.dataType&&a.setRequestHeader("Content-Type","text/html")),1!=o.cache&&(a.setRequestHeader("pragma","no-cache"),a.setRequestHeader("cache-control","no-cache")),1==o.withCredentials&&(a.withCredentials=!0),"function"==typeof o.beforeSend&&o.beforeSend(a),"function"==typeof F.ajax.beforeSend&&F.ajax.beforeSend(a),document.ajax&&"function"==typeof document.ajax.beforeSend&&document.ajax.beforeSend(a),a.onload=function(){var e;if(200===a.status)if("json"==o.dataType)try{var t=JSON.parse(a.responseText);o.success&&"function"==typeof o.success&&o.success(t)}catch(e){o.error&&"function"==typeof o.error&&o.error(e,t)}else t="blob"==o.dataType?a.response:a.responseText,o.success&&"function"==typeof o.success&&o.success(t);else o.error&&"function"==typeof o.error&&o.error(a.responseText,a.status);F.ajax.queue&&0<F.ajax.queue.length&&F.ajax.send(F.ajax.queue.shift()),F.ajax.requests&&F.ajax.requests.length&&(e=F.ajax.requests.indexOf(a),F.ajax.requests.splice(e,1),F.ajax.requests.length||o.complete&&"function"==typeof o.complete&&o.complete(t),o.group&&F.ajax.oncomplete&&"function"==typeof F.ajax.oncomplete[o.group]&&!F.ajax.pending(o.group)&&(F.ajax.oncomplete[o.group](),F.ajax.oncomplete[o.group]=null),o.multiple&&o.multiple.instance&&(e=o.multiple.instance.indexOf(a),o.multiple.instance.splice(e,1),o.multiple.instance.length||o.multiple.complete&&"function"==typeof o.multiple.complete&&o.multiple.complete(t)))},a.options=o,a.data=s,1==o.queue&&0<F.ajax.requests.length?F.ajax.queue.push(a):F.ajax.send(a),a},F.ajax.send=function(e){e.data?Array.isArray(e.data)?e.send(e.data.join("&")):e.send(e.data):e.send(),F.ajax.requests.push(e)},F.ajax.exists=function(e,t){var o=new XMLHttpRequest;o.open("HEAD",e,!1),o.send(),o.status&&t(o.status)},F.ajax.pending=function(e){var t=0,o=F.ajax.requests;if(o&&o.length)for(var n=0;n<o.length;n++)e&&e!=o[n].options.group||t++;return t},F.ajax.oncomplete={},F.ajax.requests=[],F.ajax.queue=[],F.alert=function(e){F.getWindowWidth()<800&&F.dialog?F.dialog.open({title:"Alert",message:e}):alert(e)},F.animation={},F.animation.slideLeft=function(e,t,o){1==t?(e.classList.add("slide-left-in"),setTimeout(function(){e.classList.remove("slide-left-in"),"function"==typeof o&&o()},400)):(e.classList.add("slide-left-out"),setTimeout(function(){e.classList.remove("slide-left-out"),"function"==typeof o&&o()},400))},F.animation.slideRight=function(e,t,o){1==t?(e.classList.add("slide-right-in"),setTimeout(function(){e.classList.remove("slide-right-in"),"function"==typeof o&&o()},400)):(e.classList.add("slide-right-out"),setTimeout(function(){e.classList.remove("slide-right-out"),"function"==typeof o&&o()},400))},F.animation.slideTop=function(e,t,o){1==t?(e.classList.add("slide-top-in"),setTimeout(function(){e.classList.remove("slide-top-in"),"function"==typeof o&&o()},400)):(e.classList.add("slide-top-out"),setTimeout(function(){e.classList.remove("slide-top-out"),"function"==typeof o&&o()},400))},F.animation.slideBottom=function(e,t,o){1==t?(e.classList.add("slide-bottom-in"),setTimeout(function(){e.classList.remove("slide-bottom-in"),"function"==typeof o&&o()},400)):(e.classList.add("slide-bottom-out"),setTimeout(function(){e.classList.remove("slide-bottom-out"),"function"==typeof o&&o()},100))},F.animation.fadeIn=function(e,t){e.style.display="",e.classList.add("fade-in"),setTimeout(function(){e.classList.remove("fade-in"),"function"==typeof t&&t()},2e3)},F.animation.fadeOut=function(e,t){e.classList.add("fade-out"),setTimeout(function(){e.style.display="none",e.classList.remove("fade-out"),"function"==typeof t&&t()},1e3)},F.calendar=function(a,e){if(a.calendar)return a.calendar.setOptions(e,!0);function t(e){var t,o;F.findElement(e.target,"jcalendar-container")?"jcalendar-prev"==(t=e.target.className)?v.prev():"jcalendar-next"==t?v.next():"jcalendar-month"==t?v.getMonths():"jcalendar-year"==t?v.getYears():"jcalendar-set-year"==t?(v.date[0]=e.target.innerText,"year-month-picker"==v.options.type?v.getMonths():v.getDays()):e.target.classList.contains("jcalendar-set-month")?(o=parseInt(e.target.getAttribute("data-value")),"year-month-picker"==v.options.type?v.update(e.target,o):(v.date[1]=o,v.getDays())):"jcalendar-confirm"==t||"jcalendar-update"==t||"jcalendar-close"==t?v.close():"jcalendar-backdrop"==t?v.close(!1,!1):"jcalendar-reset"==t?v.reset():e.target.classList.contains("jcalendar-set-day")&&e.target.innerText&&v.update(e.target):v.close()}function o(e){e.target.value&&3<e.target.value.length&&((e=F.calendar.extractDateFromString(e.target.value,v.options.format))&&v.setValue(e))}var v={type:"calendar",options:{},date:null,setOptions:function(e,t){for(var o,n,r={type:"default",validRange:null,startingDay:null,format:"DD/MM/YYYY",readonly:!0,today:!1,time:!1,resetButton:!0,placeholder:"",months:F.calendar.monthsShort,monthsFull:F.calendar.months,weekdays:F.calendar.weekdays,weekdays_short:F.calendar.weekdays,textDone:F.translate("Done"),textReset:F.translate("Reset"),textUpdate:F.translate("Update"),value:null,fullscreen:!1,opened:!1,onopen:null,onclose:null,onchange:null,onupdate:null,mode:null,position:null,dataType:null},i=0;i<r.weekdays_short.length;i++)r.weekdays_short[i]=r.weekdays_short[i].substr(0,1);for(o in r)e&&e.hasOwnProperty(o)?v.options[o]=e[o]:void 0!==v.options[o]&&!0!==t||(v.options[o]=r[o]);return 0==v.options.resetButton?s.style.display="none":s.style.display="",v.options.readonly?a.setAttribute("readonly","readonly"):a.removeAttribute("readonly"),v.options.placeholder?a.setAttribute("placeholder",v.options.placeholder):a.removeAttribute("placeholder"),F.isNumeric(v.options.value)&&0<v.options.value&&(v.options.value=F.calendar.numToDate(v.options.value),v.options.dataType="numeric"),s.innerHTML=v.options.textReset,l.innerHTML=v.options.textDone,p.innerHTML=v.options.textUpdate,a.setAttribute("data-mask",v.options.format.toLowerCase()),(n=!v.options.value&&v.options.today?F.calendar.now():v.options.value)&&(v.options.value=null,v.setValue(n)),v},open:function(e){var t,o,n;r.classList.contains("jcalendar-focus")||r.classList.contains("jcalendar-inline")||(F.calendar.current=v,F.tracking(v,!0),v.getDays(),"year-month-picker"==v.options.type&&v.getMonths(),v.options.time&&(h.value=v.date[3],f.value=v.date[4]),r.classList.add("jcalendar-focus"),F.getWindowWidth()<800||v.options.fullscreen?(r.classList.add("jcalendar-fullsize"),F.animation.slideBottom(u,1)):(r.classList.remove("jcalendar-fullsize"),t=a.getBoundingClientRect(),o=u.getBoundingClientRect(),v.options.position?(i.style.position="fixed",window.innerHeight<t.bottom+o.height?i.style.top=t.top-(o.height+2)+"px":i.style.top=t.top+t.height+2+"px",i.style.left=t.left+"px"):(window.innerHeight<t.bottom+o.height?((n=-1*(t.height+o.height+2))+t.top<0&&(n=-1*(t.top+t.height)),i.style.top=n+"px"):i.style.top="2px",window.innerWidth<t.left+o.width?(n=window.innerWidth-(t.left+o.width+20),i.style.left=n+"px"):i.style.left="0px")),"function"==typeof v.options.onopen&&v.options.onopen(a))},close:function(e,t){var o;return r.classList.contains("jcalendar-focus")&&(!1!==t&&(o=r.querySelector(".jcalendar-selected"),t="string"==typeof t?t:!o||o.classList.contains("jcalendar-disabled")?v.options.value:v.getValue(),v.setValue(t)),e||"function"!=typeof v.options.onclose||v.options.onclose(a),r.classList.remove("jcalendar-focus"),F.tracking(v,!1),F.calendar.current=null),v.options.value},prev:function(){"years"==v.options.mode?(v.date[0]=v.date[0]-12,v.getYears()):"months"==v.options.mode?(v.date[0]=parseInt(v.date[0])-1,v.getMonths()):(v.date[1]<2?(v.date[0]=v.date[0]-1,v.date[1]=12):v.date[1]=v.date[1]-1,v.getDays())},next:function(){"years"==v.options.mode?(v.date[0]=parseInt(v.date[0])+12,v.getYears()):"months"==v.options.mode?(v.date[0]=parseInt(v.date[0])+1,v.getMonths()):(11<v.date[1]?(v.date[0]=parseInt(v.date[0])+1,v.date[1]=1):v.date[1]=parseInt(v.date[1])+1,v.getDays())},setToday:function(){var e=(new Date).toISOString().substr(0,10);return v.setValue(e),e},setValue:function(e){var t,o,n,r,i,s=e=e||""+e,l=v.options.value;l!=s&&(e=s?(v.setLabel(s,v.options),(n=s.split(" "))[1]||(n[1]="00:00:00"),i=n[1].split(":"),n=n[0].split("-"),t=parseInt(n[0]),o=parseInt(n[1]),n=parseInt(n[2]),r=parseInt(i[0]),i=parseInt(i[1]),v.date=[t,o,n,r,i,0],v.setLabel(s,v.options)):(v.date=null,""),v.options.value=s,"function"==typeof v.options.onchange&&v.options.onchange(a,s,l),a.value!=e&&(a.value=e,"function"==typeof a.oninput&&a.oninput({type:"input",target:a,value:a.value}))),v.getDays()},getValue:function(){return v.date?v.options.time?F.two(v.date[0])+"-"+F.two(v.date[1])+"-"+F.two(v.date[2])+" "+F.two(v.date[3])+":"+F.two(v.date[4])+":"+F.two(0):F.two(v.date[0])+"-"+F.two(v.date[1])+"-"+F.two(v.date[2])+" "+F.two(0)+":"+F.two(0)+":"+F.two(0):""},update:function(e,t){var o;e.classList.contains("jcalendar-disabled")||((o=r.querySelector(".jcalendar-selected"))&&o.classList.remove("jcalendar-selected"),e.classList.add("jcalendar-selected"),e.classList.contains("jcalendar-set-month")?(v.date[1]=t,v.date[2]=1):v.date[2]=e.innerText,v.options.time?(v.date[3]=h.value,v.date[4]=f.value):v.close()),y()},reset:function(){v.setValue(""),v.date=null,v.close(!1,!1)},getDays:function(){v.options.mode="days";var e=new Date,t=v.date&&F.isNumeric(v.date[0])?v.date[0]:parseInt(e.getFullYear()),o=v.date&&F.isNumeric(v.date[1])?v.date[1]:parseInt(e.getMonth())+1,n=v.date&&F.isNumeric(v.date[2])?v.date[2]:parseInt(e.getDate()),r=v.date&&F.isNumeric(v.date[3])?v.date[3]:parseInt(e.getHours()),i=v.date&&F.isNumeric(v.date[4])?v.date[4]:parseInt(e.getMinutes()),s=(v.date=[t,o,n,r,i,0],x.innerHTML=t,C.innerHTML=v.options.months[o-1],e.getMonth()==o-1&&e.getFullYear()==t),l=e.getDate(),a=(e=new Date(t,o,0,0,0)).getDate(),u=(e=new Date(t,o-1,0,0,0)).getDay()+1;u-=d=v.options.startingDay||0,w.innerHTML="",(f=document.createElement("tr")).setAttribute("align","center"),w.appendChild(f);for(var c=0;c<7;c++)(b=document.createElement("td")).classList.add("jcalendar-weekday"),b.innerHTML=v.options.weekdays_short[d],f.appendChild(b),6<++d&&(d=0);for(var d=0,p=0,h=0;h<6;h++){(f=document.createElement("tr")).setAttribute("align","center");for(var f,b,m,g,j=!0,c=0;c<7;c++)(b=document.createElement("td")).classList.add("jcalendar-set-day"),u<=d&&d<u+a&&(p++,(b.innerHTML=p)==n&&b.classList.add("jcalendar-selected"),s&&l==p&&(b.style.fontWeight="bold"),g=F.calendar.now(new Date(t,o-1,p),!0),v.options.validRange&&(m=!v.options.validRange[0]||g>=v.options.validRange[0],g=!v.options.validRange[1]||g<=v.options.validRange[1],m&&g||b.classList.add("jcalendar-disabled")),j=!1),f.appendChild(b),d++;0==j&&w.appendChild(f)}v.options.time?E.style.display="":E.style.display="none",y()},getMonths:function(){v.options.mode="months";for(var e=v.options.months,t=(v.options.value,new Date),o=parseInt(t.getFullYear()),n=parseInt(t.getMonth())+1,r=v.date&&F.isNumeric(v.date[0])?v.date[0]:o,i=v.date&&F.isNumeric(v.date[1])?v.date[1]:n,s=(x.innerHTML=v.date[0],C.innerHTML=e[i-1],document.createElement("table")),l=(s.setAttribute("width","100%"),null),a=0;a<12;a++){a%4||((l=document.createElement("tr")).setAttribute("align","center"),s.appendChild(l));var u,c,d=document.createElement("td");d.classList.add("jcalendar-set-month"),d.setAttribute("data-value",a+1),d.innerText=e[a],v.options.validRange&&(c=r+"-"+F.two(a+1),u=!v.options.validRange[0]||c>=v.options.validRange[0].substr(0,7),c=!v.options.validRange[1]||c<=v.options.validRange[1].substr(0,7),u&&c||d.classList.add("jcalendar-disabled")),a+1==i&&d.classList.add("jcalendar-selected"),o==r&&a+1==n&&(d.style.fontWeight="bold"),l.appendChild(d)}w.innerHTML='<tr><td colspan="7"></td></tr>',w.children[0].children[0].appendChild(s),y()},getYears:function(){v.options.mode="years";for(var e=new Date,t=e.getFullYear(),o=v.date&&F.isNumeric(v.date[0])?v.date[0]:parseInt(e.getFullYear()),n=[],r=0;r<25;r++)n[r]=parseInt(v.date[0])+(r-12);var i=document.createElement("table");i.setAttribute("width","100%");for(r=0;r<25;r++){r%5||((s=document.createElement("tr")).setAttribute("align","center"),i.appendChild(s));var s,l=document.createElement("td");l.classList.add("jcalendar-set-year"),l.innerText=n[r],o==n[r]&&l.classList.add("jcalendar-selected"),t==n[r]&&(l.style.fontWeight="bold"),s.appendChild(l)}w.innerHTML='<tr><td colspan="7"></td></tr>',w.firstChild.firstChild.appendChild(i),y()},setLabel:function(e,t){return F.calendar.getDateString(e,t)},fromFormatted:function(e,t){return F.calendar.extractDateFromString(e,t)}},y=function(){var e=r.querySelector(".jcalendar-selected");e&&e.classList.contains("jcalendar-disabled")?(p.setAttribute("disabled","disabled"),h.setAttribute("disabled","disabled"),f.setAttribute("disabled","disabled")):(p.removeAttribute("disabled"),h.removeAttribute("disabled"),f.removeAttribute("disabled")),"function"==typeof v.options.onupdate&&v.options.onupdate(a,v.getValue())},r=null,s=null,l=null,i=null,u=null,x=null,C=null,n=null,w=null,c=null,E=null,d=null,p=null,h=null,f=null,c=("INPUT"==a.tagName&&a.value&&(e.value=a.value),(s=document.createElement("div")).className="jcalendar-reset",(l=document.createElement("div")).className="jcalendar-confirm",(c=document.createElement("div")).className="jcalendar-controls",c.style.borderBottom="1px solid #ddd",c.appendChild(s),c.appendChild(l),(i=document.createElement("div")).className="jcalendar-container",(u=document.createElement("div")).className="jcalendar-content",i.appendChild(u),"DIV"==a.tagName?(r=a).classList.add("jcalendar-inline"):(u.appendChild(c),(r=document.createElement("div")).className="jcalendar"),r.classList.add("jcalendar-container"),r.appendChild(i),document.createElement("div")),b=(c.className="jcalendar-table",u.appendChild(c),document.createElement("td")),m=(b.setAttribute("colspan","2"),b.className="jcalendar-prev",(x=document.createElement("span")).className="jcalendar-year",(C=document.createElement("span")).className="jcalendar-month",document.createElement("td")),g=(m.className="jcalendar-header",m.setAttribute("colspan","3"),m.appendChild(C),m.appendChild(x),document.createElement("td")),j=(g.setAttribute("colspan","2"),g.className="jcalendar-next",document.createElement("thead")),A=document.createElement("tr");A.appendChild(b),A.appendChild(m),A.appendChild(g),j.appendChild(A),n=document.createElement("table"),w=document.createElement("tbody"),n.setAttribute("cellpadding","0"),n.setAttribute("cellspacing","0"),n.appendChild(j),n.appendChild(w),c.appendChild(n),(h=document.createElement("select")).className="jcalendar-select",h.onchange=function(){v.date[3]=this.value,"function"==typeof v.options.onupdate&&v.options.onupdate(a,v.getValue())};for(var N=0;N<24;N++)(L=document.createElement("option")).value=N,L.innerHTML=F.two(N),h.appendChild(L);(f=document.createElement("select")).className="jcalendar-select",f.onchange=function(){v.date[4]=this.value,"function"==typeof v.options.onupdate&&v.options.onupdate(a,v.getValue())};for(var L,N=0;N<60;N++)(L=document.createElement("option")).value=N,L.innerHTML=F.two(N),f.appendChild(L);return(b=document.createElement("div")).className="jcalendar-controls",(E=document.createElement("div")).className="jcalendar-time",E.style.maxWidth="140px",E.appendChild(h),E.appendChild(f),(p=document.createElement("button")).setAttribute("type","button"),p.className="jcalendar-update",(d=document.createElement("div")).style.flexGrow="10",d.appendChild(p),b.appendChild(E),"INPUT"==a.tagName&&b.appendChild(d),u.appendChild(b),(m=document.createElement("div")).className="jcalendar-backdrop",r.appendChild(m),a.addEventListener("keyup",o),r.addEventListener("swipeleft",function(e){F.animation.slideLeft(n,0,function(){v.next(),F.animation.slideRight(n,1)}),e.preventDefault(),e.stopPropagation()}),r.addEventListener("swiperight",function(e){F.animation.slideRight(n,0,function(){v.prev(),F.animation.slideLeft(n,1)}),e.preventDefault(),e.stopPropagation()}),a.onmouseup=function(){v.open()},"ontouchend"in document.documentElement==!0?r.addEventListener("touchend",t):r.addEventListener("mouseup",t),F.calendar.hasEvents||(F.calendar.hasEvents=!0,document.addEventListener("keydown",F.calendar.keydown)),v.setOptions(e),"INPUT"==a.tagName?(a.parentNode.insertBefore(r,a.nextSibling),a.setAttribute("autocomplete","off"),a.classList.add("jcalendar-input"),a.value=v.setLabel(v.getValue(),v.options)):(v.getDays(),v.options.time&&(h.value=v.date[3],f.value=v.date[4])),1==v.options.opened&&v.open(),a.change=v.setValue,a.val=function(e){if(void 0===e)return v.getValue();v.setValue(e)},a.calendar=r.calendar=v},F.calendar.keydown=function(e){var t=null;(t=F.calendar.current)&&(13==e.which?t.close(!1,!0):27==e.which&&t.close(!1,!1))},F.calendar.prettify=function(e,t){t=t||{justNow:"Just now",xMinutesAgo:"{0}m ago",xHoursAgo:"{0}h ago",xDaysAgo:"{0}d ago",xWeeksAgo:"{0}w ago",xMonthsAgo:"{0} mon ago",xYearsAgo:"{0}y ago"};var o=new Date,e=new Date(e),o=parseInt((o-e)/1e3/60);return String.prototype.format=function(e){return this.replace("{0}",e)},0==o?t.justNow:o<90?t.xMinutesAgo.format(o):o<1440?t.xHoursAgo.format(Math.round(o/60)):o<20160?t.xDaysAgo.format(Math.round(o/1440)):o<43200?t.xWeeksAgo.format(Math.round(o/10080)):o<1036800?t.xMonthsAgo.format(Math.round(o/43200)):t.xYearsAgo.format(Math.round(o/525600))},F.calendar.prettifyAll=function(){for(var e=document.querySelectorAll(".prettydate"),t=0;t<e.length;t++)e[t].getAttribute("data-date")?e[t].innerHTML=F.calendar.prettify(e[t].getAttribute("data-date")):e[t].innerHTML&&(e[t].setAttribute("data-date",e[t].innerHTML),e[t].innerHTML=F.calendar.prettify(e[t].innerHTML))},F.calendar.now=function(e,t){var o,n,r,i,s;return e=Array.isArray(e)?(o=e[0],n=e[1],r=e[2],i=e[3],s=e[4],e[5]):(o=(e=e||new Date).getFullYear(),n=e.getMonth()+1,r=e.getDate(),i=e.getHours(),s=e.getMinutes(),e.getSeconds()),1==t?F.two(o)+"-"+F.two(n)+"-"+F.two(r):F.two(o)+"-"+F.two(n)+"-"+F.two(r)+" "+F.two(i)+":"+F.two(s)+":"+F.two(e)},F.calendar.toArray=function(e){var t,o=(e=e.split(-1!==e.indexOf("T")?"T":" "))[1],e=e[0].split("-"),n=parseInt(e[0]),r=parseInt(e[1]),e=parseInt(e[2]);return o=o?(o=o.split(":"),t=parseInt(o[0]),parseInt(o[1])):t=0,[n,r,e,t,o,0]},F.calendar.extractDateFromString=function(e,t){if(0<e&&Number(e)==e)return(o=new Date(Math.round(86400*(e-25569)*1e3))).getFullYear()+"-"+F.two(o.getMonth())+"-"+F.two(o.getDate())+" 00:00:00";var o=F.mask(e,{mask:t},!0);return o.date[0]&&o.date[1]?(o.date[2]||(o.date[2]=1),o.date[0]+"-"+F.two(o.date[1])+"-"+F.two(o.date[2])+" "+F.two(o.date[3])+":"+F.two(o.date[4])+":"+F.two(o.date[5])):""},Date.UTC(1900,0,0)),w=Date.UTC(1900,1,29),E=864e5;function A(){var e;return-1!==this.mask.toLowerCase().indexOf("[h]")?(e=0,this.date[4]&&(e=parseFloat(this.date[4]/60)),e=parseInt(this.date[3])+e,e/=24):this.date[0]&&this.date[1]&&this.date[2]||!this.date[3]&&!this.date[4]?(this.date[0]&&this.date[1]&&!this.date[2]&&(this.date[2]=1),e=F.two(this.date[0])+"-"+F.two(this.date[1])+"-"+F.two(this.date[2]),(this.date[3]||this.date[4]||this.date[5])&&(e+=" "+F.two(this.date[3])+":"+F.two(this.date[4])+":"+F.two(this.date[5]))):e=F.two(this.date[3])+":"+F.two(this.date[4])+":"+F.two(this.date[5]),e}function N(e){return null===e||""===e||void 0===e}function L(e){return(e=a.call(this,e))?("-"===e[0]&&(e[0]="-0"),parseFloat(e.join("."))):null}function I(e){var t,o=g.call(this,e);if(t=o?o.type:t){for(var n=0,r=m.call(this,e),i=0;i<r.length;i++)(o=g.call(this,r[i]))&&d(o.type)&&n++;1<n&&(t="general")}return t}function M(){"function"==typeof c[this.methods[this.index]]?(c[this.methods[this.index]].call(this,this.value[this.position]),this.position++):(this.values[this.index]=this.tokens[this.index],this.index++)}function T(e,t,o){var n=null,r={input:null,value:null,options:{},values:[],index:0,position:0,date:[0,0,0,0,0,0],number:0};if("object"==typeof e){if(r.input=e.target,r.value=b.call(e.target),r.caret=f.call(e.target),(n=e.target.getAttribute("data-mask"))&&(r.mask=n),(n=e.target.getAttribute("data-type"))&&(r.type=n),e.target.mask?(e.target.mask.options&&(r.options=e.target.mask.options),e.target.mask.locale&&(r.locale=e.target.mask.locale)):(n=e.target.getAttribute("data-locale"))&&(r.locale=n,r.mask&&(r.options.style=r.mask)),e.target.attributes&&e.target.attributes.length)for(var i=0;i<e.target.attributes.length;i++){var s=e.target.attributes[i].name,l=e.target.attributes[i].value;"data"==s.substr(0,4)&&(r.options[s.substr(5)]=l)}}else{if("string"==typeof t)r.mask=t;else for(s=Object.keys(t),i=0;i<s.length;i++)r[s[i]]=t[s[i]];"number"==typeof e&&(p.call(r,r.mask),e=(""+e).replace(".",r.options.decimal)),r.value=e,r.input&&(b.call(r.input,e),F.focus(r.input),r.caret=f.call(r.input))}if("="!=(""+r.value)[0]&&(r.mask||r.locale)){if(r.mask&&(r.mask=r.mask.replace("[-]",""),-1!==r.mask.indexOf("##")&&((u=r.mask.split(";"))[0]&&(u[0]=u[0].replace("*",""),u[0]=u[0].replace(/_/g,""),u[0]=u[0].replace(/-/g,""),u[0]=u[0].replace("(",""),u[0]=u[0].replace(")",""),u[0]=u[0].replace("##0.###","##0.000"),u[0]=u[0].replace("##0.##","##0.00"),u[0]=u[0].replace("##0.#","##0.0")),r.mask=u[0]),r.type||(r.type=I.call(r,r.mask)),r.tokens=m.call(r,r.mask)),"object"!=typeof e||!e.inputType||!e.inputType.indexOf("insert")||!e.inputType.indexOf("delete"))if(r.locale)r.input?function(e){var t,o=b.call(e);o&&(p.call(this),o=(t=h.call(this,o)).length-o.length,o=f.call(e)+o,b.call(e,t,o,!0))}.call(r,r.input):c=h.call(r,r.value);else{for(r.methods=function(e){for(var t=[],o=0;o<e.length;o++){var n=g.call(this,e[o]);n?t.push(n.method):t.push(null)}for(o=0;o<t.length;o++)"MM"==t[o]&&(t[o-1]&&0<=t[o-1].indexOf("H")||t[o-2]&&0<=t[o-2].indexOf("H")||t[o+1]&&0<=t[o+1].indexOf("S")||t[o+2]&&0<=t[o+2].indexOf("S"))&&(t[o]="MI");return t}.call(r,r.tokens);r.position<r.value.length&&void 0!==r.tokens[r.index];)M.call(r);if(d(r.type)){for(;void 0!==r.tokens[r.index];)(n=g.call(r,r.tokens[r.index]))&&"general"==n.type&&(r.values[r.index]=r.tokens[r.index]),r.index++;var a=!0}else a=!1;var u,c=r.values.join("");r.input&&(u=0<(n=c.length-r.value.length)?r.caret+n:r.caret,b.call(r.input,c,u,a))}if(r.input&&(u=null,d(r.type)?(r.number=L.call(r,b.call(r.input)),u="percentage"==r.type?r.number/100:r.number):"datetime"==r.type&&(u=A.call(r),r.date[0]&&r.date[1]&&r.date[2]&&r.input.setAttribute("data-completed",!0)),u&&r.input.setAttribute("data-value",u)),void 0!==c)return o?r:c}}function D(e){return j[e]||j.material}function S(e,t){return"function"==typeof S[t.type]?!(!t.allowBlank||""!==e)||S[t.type](e,t):null}return F.calendar.dateToNum=function(e){e=(e="string"==typeof e?new Date(e+"  GMT+0"):e).getTime();return w<=e&&(e+=E),(e-=C)/E},F.calendar.numToDate=function(e){e=C+e*E;w<=e&&(e-=E);const t=new Date(e);e=[t.getUTCFullYear(),t.getUTCMonth()+1,t.getUTCDate(),t.getUTCHours(),t.getUTCMinutes(),t.getUTCSeconds()];return F.calendar.now(e)},F.calendar.getDateString=function(e,t){if(t=(t=(t=t||{})&&"object"==typeof t?t.format:t)||"YYYY-MM-DD","number"==typeof e&&0<=t.indexOf("[h]"))return o=parseFloat(24*Number(e)),0<=t.indexOf("mm")&&(s=(l=(""+o).split("."))[1]?(s=60*parseFloat("0."+l[1]),parseFloat(s.toFixed(2))):0,o=parseInt(l[0])+":"+F.two(s)),o;e instanceof Date?e=F.calendar.now(e):e&&F.isNumeric(e)&&(e=F.calendar.numToDate(e));for(var o=new RegExp(["DAY","WD","DDDD","DDD","DD","D","Q","HH24","HH12","HH","H","AM/PM","MI","SS","MS","YYYY","YYY","YY","Y","MONTH","MON","MMMMM","MMMM","MMM","MM","M","."].join("|"),"gi"),n=t.match(o),r=0;r<n.length;r++)"MM"==n[r].toUpperCase()&&(n[r-1]&&0<=n[r-1].toUpperCase().indexOf("H")||n[r-2]&&0<=n[r-2].toUpperCase().indexOf("H")||n[r+1]&&0<=n[r+1].toUpperCase().indexOf("S")||n[r+2]&&0<=n[r+2].toUpperCase().indexOf("S"))&&(n[r]="mi");var i={tokens:n};if(e){var s,t=-1!==(s=""+e).indexOf("T")?"T":" ",l=0,o=0,a=0;if((s=s.split(t))[1]&&(o=(l=s[1].split(":"))[1]||0,a=l[2]||0,l=l[0]||0),(s=s[0].split("-"))[0]&&s[1]&&s[2]&&0<s[0]&&0<s[1]&&s[1]<13&&0<s[2]&&s[2]<32){i.data=[s[0],s[1],s[2],l,o,a],i.value=[];for(var u=new Date(i.data[0],i.data[1]-1,i.data[2],i.data[3],i.data[4],i.data[5]),c=function(e){var t=this.tokens[e],o=t.toUpperCase(),n=null;"YYYY"===o?n=this.data[0]:"YYY"===o?n=this.data[0].substring(1,4):"YY"===o?n=this.data[0].substring(2,4):"Y"===o?n=this.data[0].substring(3,4):"MON"===t?n=F.calendar.months[u.getMonth()].substr(0,3).toUpperCase():"mon"===t?n=F.calendar.months[u.getMonth()].substr(0,3).toLowerCase():"MONTH"===t?n=F.calendar.months[u.getMonth()].toUpperCase():"month"===t?n=F.calendar.months[u.getMonth()].toLowerCase():"MMMMM"===o?n=F.calendar.months[u.getMonth()].substr(0,1):"MMMM"===o||"Month"===t?n=F.calendar.months[u.getMonth()]:"MMM"===o||"Mon"==t?n=F.calendar.months[u.getMonth()].substr(0,3):"MM"===o?n=F.two(this.data[1]):"M"===o?n=u.getMonth()+1:"DAY"===t?n=F.calendar.weekdays[u.getDay()].toUpperCase():"day"===t?n=F.calendar.weekdays[u.getDay()].toLowerCase():"DDDD"===o||"Day"==t?n=F.calendar.weekdays[u.getDay()]:"DDD"===o?n=F.calendar.weekdays[u.getDay()].substr(0,3):"DD"===o?n=F.two(this.data[2]):"D"===o?n=this.data[2]:"Q"===o?n=Math.floor((u.getMonth()+3)/3):"HH24"===o||"HH"===o?n=F.two(this.data[3]):"HH12"===o?n=12<this.data[3]?F.two(this.data[3]-12):F.two(this.data[3]):"H"===o?n=this.data[3]:"MI"===o?n=F.two(this.data[4]):"SS"===o?n=F.two(this.data[5]):"MS"===o?n=u.getMilliseconds():"AM/PM"===o?n=12<=this.data[3]?"PM":"AM":"WD"===o&&(n=F.calendar.weekdays[u.getDay()]),this.value[e]=null===n?this.tokens[e]:n},r=0;r<i.tokens.length;r++)c.call(i,r);e=i.value.join("")}else e=""}return e},F.calendar.weekdays=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],F.calendar.months=["January","February","March","April","May","June","July","August","September","October","November","December"],F.calendar.weekdaysShort=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],F.calendar.monthsShort=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],F.color=function(r,e){if(r.color)return r.color.setOptions(e,!0);function n(e){return 1===(e=e.toString(16)).length?"0"+e:e}function t(e){return parseInt("0x"+e)}function i(){var e=h.firstChild.getBoundingClientRect();j.width=e.width-14,y()}function o(){function t(e,t,o){1===e&&(t=t-(e=n.getBoundingClientRect()).left,o=o-e.top,(t=t<0?0:t)>e.width&&(t=e.width),(o=o<0?0:o)>e.height&&(o=e.height),r.style.left=t+"px",r.style.top=o+"px",e=v.getImageData(t,o,1,1).data,x=b(e[0],e[1],e[2]))}var n=document.createElement("div"),r=(n.className="jcolor-hsl",document.createElement("div")),e=(r.className="jcolor-point",document.createElement("div"));return e.appendChild(j),e.appendChild(r),n.appendChild(e),n.addEventListener("mousedown",function(e){t(e.buttons,e.clientX,e.clientY)}),n.addEventListener("mousemove",function(e){t(e.buttons,e.clientX,e.clientY)}),n.addEventListener("touchmove",function(e){t(1,e.changedTouches[0].clientX,e.changedTouches[0].clientY)}),n}function s(){function e(e){var t=document.createElement("div"),o=(t.className="jcolor-sliders-input-container",document.createElement("label"));o.innerText=e;(e=document.createElement("div")).className="jcolor-sliders-input-subcontainer";var n=document.createElement("input"),r=(n.type="range",n.min=0,n.max=255,n.value=0,t.appendChild(o),e.appendChild(n),document.createElement("div"));return r.innerText=n.value,n.addEventListener("input",function(){r.innerText=n.value}),e.appendChild(r),t.appendChild(e),i.appendChild(t),n}var t=document.createElement("div"),i=(t.className="jcolor-sliders",document.createElement("div")),o=(C=[e("Red"),e("Green"),e("Blue")],t.appendChild(i),document.createElement("div")),n=(o.className="jcolor-sliders-final-color",document.createElement("div"));return n.style.visibility="hidden",n.innerText="a",o.appendChild(n),C.forEach(function(e){e.addEventListener("input",function(){var e;e=b(parseInt(C[0].value),parseInt(C[1].value),parseInt(C[2].value)),n.innerText=e,n.style.color=e,n.style.removeProperty("visibility"),x=e,w()})}),t.appendChild(o),t}var l={type:"color",options:{}},a=null,u=null,c=null,d=null,p=null,h=null,f=null,b=(l.setOptions=function(e,t){var o,n={placeholder:"",value:null,onopen:null,onclose:null,onchange:null,closeOnChange:!0,palette:null,position:null,doneLabel:"Done",resetLabel:"Reset",fullscreen:!1,opened:!1};for(o in(e=e||{})&&!e.palette&&(e.palette=F.palette()),n)e&&e.hasOwnProperty(o)?l.options[o]=e[o]:void 0!==l.options[o]&&!0!==t||(l.options[o]=n[o]);return d&&(d.innerHTML=l.options.resetLabel),p&&(p.innerHTML=l.options.doneLabel),l.options.palette&&f&&f.updateContent(0,g()),"string"==typeof l.options.value&&(r.value=l.options.value,"INPUT"===r.tagName&&(r.style.color=r.value,r.style.backgroundColor=r.value)),l.options.placeholder?r.setAttribute("placeholder",l.options.placeholder):r.getAttribute("placeholder")&&r.removeAttribute("placeholder"),l},l.select=function(e){var t=a.querySelector(".jcolor-selected");t&&t.classList.remove("jcolor-selected"),l.values[e]&&l.values[e].classList.add("jcolor-selected")},l.open=function(){var e,t,o,n;a.classList.contains("jcolor-focus")||(F.tracking(l,!0),a.classList.add("jcolor-focus"),l.options.value&&l.select(l.options.value),c.style.marginTop="",c.style.marginLeft="",e=c.getBoundingClientRect(),t=F.getWindowWidth(),o=F.getWindowHeight(),t<800||1==l.options.fullscreen?(c.classList.add("jcolor-fullscreen"),F.animation.slideBottom(c,1),u.style.display="block"):(c.classList.contains("jcolor-fullscreen")&&(c.classList.remove("jcolor-fullscreen"),u.style.display=""),l.options.position?c.style.position="fixed":c.style.position="",e.left+e.width>t&&(c.style.marginLeft=-1*(e.left+e.width-(t-20))+"px"),e.top+e.height>o&&(c.style.marginTop=-1*(e.top+e.height-(o-20))+"px")),"function"==typeof l.options.onopen&&l.options.onopen(r),f.setBorder(f.getActive()),l.options.value&&(n=m(l.options.value),C.forEach(function(e,t){e.value=n[t],e.dispatchEvent(new Event("input"))})))},l.close=function(e){return a.classList.contains("jcolor-focus")&&(a.classList.remove("jcolor-focus"),u.style.display="",e||"function"!=typeof l.options.onclose||l.options.onclose(r),F.tracking(l,!1)),l.options.value},l.setValue=function(e){(e=e||"")!=l.options.value&&(l.options.value=e,x=e,l.select(e),"function"==typeof l.options.onchange&&l.options.onchange(r,e),r.value!=l.options.value&&(r.value=l.options.value,"INPUT"===r.tagName&&(r.style.color=r.value,r.style.backgroundColor=r.value),"function"==typeof r.oninput&&r.oninput({type:"input",target:r,value:r.value})),1==l.options.closeOnChange&&l.close())},l.getValue=function(){return l.options.value},function(e,t,o){return"#"+n(e)+n(t)+n(o)}),m=function(e){return[t(e.substr(1,2)),t(e.substr(3,2)),t(e.substr(5,2))]},g=function(){var e=document.createElement("div"),t=(e.className="jcolor-grid",l.values=[],document.createElement("table"));t.setAttribute("cellpadding","7"),t.setAttribute("cellspacing","0");for(var o=0;o<l.options.palette.length;o++){for(var n=document.createElement("tr"),r=0;r<l.options.palette[o].length;r++){var i=document.createElement("td"),s=l.options.palette[o][r];s.length<7&&"#"!==s.substr(0,1)&&(s="#"+s),i.style.backgroundColor=s,i.setAttribute("data-value",s),i.innerHTML="",n.appendChild(i),l.options.value==s&&i.classList.add("jcolor-selected"),l.values[s]=i}t.appendChild(n)}return e.appendChild(t),e},j=document.createElement("canvas"),v=(j.width=200,j.height=160,j.getContext("2d")),y=function(){var e=v.createLinearGradient(0,0,j.width,0);e.addColorStop(0,"rgb(255,0,0)"),e.addColorStop(.15,"rgb(255,0,255)"),e.addColorStop(.33,"rgb(0,0,255)"),e.addColorStop(.49,"rgb(0,255,255)"),e.addColorStop(.67,"rgb(0,255,0)"),e.addColorStop(.84,"rgb(255,255,0)"),e.addColorStop(1,"rgb(255,0,0)"),v.fillStyle=e,v.fillRect(0,0,j.width,j.height),(e=v.createLinearGradient(0,0,0,j.height)).addColorStop(0,"rgba(255,255,255,1)"),e.addColorStop(.5,"rgba(255,255,255,0)"),e.addColorStop(.5,"rgba(0,0,0,0)"),e.addColorStop(1,"rgba(0,0,0,1)"),v.fillStyle=e,v.fillRect(0,0,j.width,j.height)},x="",C=[],w=function(){if(""!==x)for(var e=0;e<C.length;e++){var t=m(x);t[e]=0;var o=(o="linear-gradient(90deg, rgb(")+t.join(", ")+"), rgb(";t[e]=255,o=o+t.join(", ")+"))",C[e].style.backgroundImage=o}};return l.toHex=function(e){function t(e){return("0"+parseInt(e).toString(16)).slice(-2)}return/^#[0-9A-F]{6}$/i.test(e)?e:"#"+t((e=e.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/))[1])+t(e[2])+t(e[3])},l.setOptions(e),"INPUT"==r.tagName&&(r.classList.add("jcolor-input"),r.readOnly=!0),(a=document.createElement("div")).className="jcolor",(u=document.createElement("div")).className="jcolor-backdrop",a.appendChild(u),(c=document.createElement("div")).className="jcolor-content",(e=document.createElement("div")).className="jcolor-controls",c.appendChild(e),(d=document.createElement("div")).className="jcolor-reset",d.innerHTML=l.options.resetLabel,e.appendChild(d),(p=document.createElement("div")).className="jcolor-close",p.innerHTML=l.options.doneLabel,e.appendChild(p),h=document.createElement("div"),c.appendChild(h),f=F.tabs(h,{animation:!0,data:[{title:"Grid",contentElement:g()},{title:"Spectrum",contentElement:o()},{title:"Sliders",contentElement:s()}],onchange:function(e,t,o){var n,r;1===o?i():(n=""!==x?x:l.getValue(),2===o&&n&&(r=m(n),C.forEach(function(e,t){e.value=r[t],e.dispatchEvent(new Event("input"))})))},palette:"modern"}),a.appendChild(c),"INPUT"==r.tagName?r.parentNode.insertBefore(a,r.nextSibling):r.appendChild(a),a.addEventListener("click",function(e){var t;"TD"==e.target.tagName?(t=e.target.getAttribute("data-value"))&&l.setValue(t):e.target.classList.contains("jcolor-reset")?(l.setValue(""),l.close()):e.target.classList.contains("jcolor-close")?(0<f.getActive()&&l.setValue(x),l.close()):e.target.classList.contains("jcolor-backdrop")?l.close():l.open()}),r.addEventListener("mouseup",function(e){l.open()}),window.addEventListener("resize",function(){a.classList.contains("jcolor-focus")&&1==f.getActive()&&i()}),1==l.options.opened&&l.open(),r.change=l.setValue,r.val=function(e){if(void 0===e)return l.getValue();l.setValue(e)},r.color=l,a.color=l},F.contextmenu=function(i,e){var t,s={type:"contextmenu",options:{}},o={items:null,onclick:null};for(t in o)e&&e.hasOwnProperty(t)?s.options[t]=e[t]:s.options[t]=o[t];return i.classList.add("jcontextmenu"),s.open=function(e,t){var o,n;t&&(s.options.items=t,s.create(t)),F.contextmenu.current&&F.contextmenu.current.close(),F.tracking(s,!0),i.classList.add("jcontextmenu-focus"),((F.contextmenu.current=s).options.items&&0<s.options.items.length||i.children.length)&&(t=e.target?(o=e.clientX,e.clientY):(o=e.x,e.y),e=i.getBoundingClientRect(),window.innerHeight<t+e.height?(n=t-e.height,i.style.top=(n=n<0?0:n)+"px"):i.style.top=t+"px",window.innerWidth<o+e.width?0<o-e.width?i.style.left=o-e.width+"px":i.style.left="10px":i.style.left=o+"px")},s.close=function(){i.classList.contains("jcontextmenu-focus")&&i.classList.remove("jcontextmenu-focus"),F.tracking(s,!1)},s.create=function(e){i.innerHTML="";(t=document.createElement("div")).classList.add("header"),t.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation()}),(o=document.createElement("a")).classList.add("title"),o.innerHTML=F.translate("Menu"),t.appendChild(o),(o=document.createElement("a")).classList.add("close"),o.innerHTML=F.translate("close"),o.addEventListener("click",function(e){s.close()}),t.appendChild(o);var t,o=t;i.appendChild(o);for(var n=0;n<e.length;n++){var r=function e(t){if(!t.type||"line"!=t.type&&"divisor"!=t.type){var o=document.createElement("div"),n=document.createElement("a");if(n.innerHTML=t.title,t.tooltip&&o.setAttribute("title",t.tooltip),t.icon&&o.setAttribute("data-icon",t.icon),t.id&&(o.id=t.id),t.disabled?o.className="jcontextmenu-disabled":t.onclick&&(o.method=t.onclick,o.addEventListener("mousedown",function(e){e.preventDefault()}),o.addEventListener("mouseup",function(e){this.method(this,e)})),o.appendChild(n),t.submenu){for(var n=document.createElement("span"),r=(n.innerHTML="&#9658;",o.appendChild(n),o.classList.add("jcontexthassubmenu"),document.createElement("div")),i=(r.classList.add("jcontextmenu"),r.setAttribute("tabindex","900"),t.submenu),s=0;s<i.length;s++){var l=e(i[s]);r.appendChild(l)}o.appendChild(r)}else t.shortcut&&((n=document.createElement("span")).innerHTML=t.shortcut,o.appendChild(n))}else var o=document.createElement("hr");return o}(e[n]);i.appendChild(r)}},"function"==typeof s.options.onclick&&i.addEventListener("click",function(e){s.options.onclick(s,e)}),s.options.items&&s.create(s.options.items),window.addEventListener("mousewheel",function(){s.close()}),i.contextmenu=s},F.dropdown=function(r,e){if(r.dropdown)return r.dropdown.setOptions(e,!0);function i(e,t){e&&e.length&&(!1!==p.options.sortResults&&("function"==typeof p.options.sortResults?e.sort(p.options.sortResults):e.sort(o)),p.setData(e)),"function"==typeof p.options.onload&&p.options.onload(r,p,e,t),t&&n(t),null==t&&(p.options.value=""),r.value=p.options.value,1==p.options.opened&&p.open()}function o(e,t){var o,n;return"string"==typeof e?o=e:e.text?o=e.text:e.name&&(o=e.name),"string"==typeof t?n=t:t.text?n=t.text:t.name&&(n=t.name),"string"==typeof o||"string"==typeof n?(o="string"!=typeof o?""+o:o).localeCompare(n="string"!=typeof n?""+n:n):o-n}function n(e){if(u(),null!==e)if(e){Array.isArray(e)||(e=(""+e).split(";"));for(var t=0;t<e.length;t++)p.value[e[t]]=""}else void 0!==p.value[""]&&(p.value[""]="");for(t=0;t<p.items.length;t++)void 0!==p.value[c(t)]&&(p.items[t].element&&p.items[t].element.classList.add("jdropdown-selected"),p.items[t].selected=!0,p.value[c(t)]=d(t));p.options.value=Object.keys(p.value).join(";"),p.header.value=p.getText()}function s(){return Object.keys(p.value)}function l(){for(var e=[],t=Object.keys(p.value),o=0;o<t.length;o++)e.push(p.value[t[o]]);return e}function a(e){r.value!=p.options.value&&(r.value=p.options.value,"function"==typeof r.oninput&&r.oninput({type:"input",target:r,value:r.value})),"function"==typeof p.options.onchange&&p.options.onchange(r,p,e,p.options.value)}var t,p={type:"dropdown",options:{}},u=function(){p.value={};for(var e=0;e<p.items.length;e++)1==p.items[e].selected&&(p.items[e].element&&p.items[e].element.classList.remove("jdropdown-selected"),p.items[e].selected=null);p.options.value=""},c=function(e,t){var o;return o=p.options.format?"id":"value",p.items[e]?void 0!==t?p.items[e].data[o]=t:p.items[e].data[o]:""},d=function(e,t){var o;return o=p.options.format?"name":"text",p.items[e]?void 0!==t?p.items[e].data[o]=t:p.items[e].data[o]:""},h=(p.setOptions=function(e,t){e=e||{};var o,n={url:null,data:[],format:0,multiple:!1,autocomplete:!1,remoteSearch:!1,lazyLoading:!1,type:null,width:null,maxWidth:null,opened:!1,value:null,placeholder:"",newOptions:!1,position:!1,onchange:null,onload:null,onopen:null,onclose:null,onfocus:null,onblur:null,oninsert:null,onbeforeinsert:null,sortResults:!1,autofocus:!1};for(o in n)e&&e.hasOwnProperty(o)?p.options[o]=e[o]:void 0!==p.options[o]&&!0!==t||(p.options[o]=n[o]);return 1!=p.options.remoteSearch&&"searchbar"!==p.options.type||(p.options.autocomplete=!0),1==p.options.newOptions?p.header.classList.add("jdropdown-add"):p.header.classList.remove("jdropdown-add"),1==p.options.autocomplete?p.header.removeAttribute("readonly"):p.header.setAttribute("readonly","readonly"),p.options.placeholder?p.header.setAttribute("placeholder",p.options.placeholder):p.header.removeAttribute("placeholder"),r.classList.remove("jdropdown-searchbar"),r.classList.remove("jdropdown-picker"),r.classList.remove("jdropdown-list"),"searchbar"==p.options.type?r.classList.add("jdropdown-searchbar"):"list"==p.options.type?r.classList.add("jdropdown-list"):"picker"==p.options.type?r.classList.add("jdropdown-picker"):F.getWindowWidth()<800?p.options.autocomplete?(r.classList.add("jdropdown-searchbar"),p.options.type="searchbar"):(r.classList.add("jdropdown-picker"),p.options.type="picker"):(p.options.width?(r.style.width=p.options.width,r.style.minWidth=p.options.width):(r.style.removeProperty("width"),r.style.removeProperty("min-width")),r.classList.add("jdropdown-default"),p.options.type="default"),"searchbar"==p.options.type?h.appendChild(m):f.insertBefore(m,f.firstChild),p.options.url&&!e.data?F.ajax({url:p.options.url,method:"GET",dataType:"json",success:function(e){e&&i(e,p.options.value)}}):i(p.options.data,p.options.value),p},null),f=null,b=null,m=null,g=null,j=null,v=null;p.getUrl=function(){return p.options.url},p.setUrl=function(e,t){p.options.url=e,F.ajax({url:p.options.url,method:"GET",dataType:"json",success:function(e){p.setData(e),"function"==typeof t&&t(p)}})},p.setId=function(e,t){var o;o=p.options.format?"id":"value","object"==typeof e?e[o]=t:p.items[e].data[o]=t},p.add=function(e,t){if(!e){var o=1==p.options.autocomplete?p.header.value:"";if(!(e=prompt(F.translate("Add A New Option"),o)))return!1}if(t=t||F.guid(),o=p.options.format?{id:t,name:e}:{value:t,text:e},"function"==typeof p.options.onbeforeinsert){t=p.options.onbeforeinsert(p,o);if(!1===t)return!1;t&&(o=t)}p.options.data.push(o);e=p.createItem(o);return b.appendChild(e.element),"function"==typeof p.options.oninsert&&p.options.oninsert(p,o,e),"none"==b.style.display&&(b.style.display=""),p.results&&p.results.push(e),o},p.createItem=function(e,t,o){p.options.format?(e.id||void 0===e.value||(e.id=e.value),e.name||void 0===e.text||(e.name=e.text)):(e.value||void 0===e.id||(e.value=e.id),e.text||void 0===e.name||(e.text=e.name));var n={},r=(n.element=document.createElement("div"),n.element.className="jdropdown-item",n.element.indexValue=p.items.length,n.data=e,t&&(n.group=t),e.id&&n.element.setAttribute("id",e.id),1==e.disabled&&n.element.setAttribute("data-disabled",!0),e.tooltip&&n.element.setAttribute("title",e.tooltip),e.image?((t=document.createElement("img")).className="jdropdown-image",t.src=e.image,e.title||t.classList.add("jdropdown-image-small"),n.element.appendChild(t)):e.icon?((t=document.createElement("span")).className="jdropdown-icon material-icons",t.innerText=e.icon,e.title||t.classList.add("jdropdown-icon-small"),e.color&&(t.style.color=e.color),n.element.appendChild(t)):e.color&&((t=document.createElement("div")).className="jdropdown-color",t.style.backgroundColor=e.color,n.element.appendChild(t)),t=p.options.format?e.name:e.text,document.createElement("div"));return r.className="jdropdown-description",r.innerHTML=t||"&nbsp;",e.title&&((t=document.createElement("div")).className="jdropdown-title",t.innerText=e.title,r.appendChild(t)),t=p.options.format?e.id:e.value,p.value[t]&&(n.element.classList.add("jdropdown-selected"),n.selected=!0),p.items.push(n),n.element.appendChild(r),n},p.appendData=function(e){if(e.length){for(var t=[],o=[],n=0;n<e.length;n++)e[n].group?(o[e[n].group]||(o[e[n].group]=[]),o[e[n].group].push(n)):t.push(n);var r=0,i=Object.keys(o);if(0<i.length)for(n=0;n<i.length;n++){var s=document.createElement("div"),l=(s.className="jdropdown-group",document.createElement("div")),a=(l.className="jdropdown-group-name",l.innerHTML=i[n],document.createElement("i")),u=(a.className="jdropdown-group-arrow jdropdown-group-arrow-down",l.appendChild(a),document.createElement("div"));u.className="jdropdown-group-items";for(var c=0;c<o[i[n]].length;c++){var d=p.createItem(e[o[i[n]][c]],s,i[n]);(0==p.options.lazyLoading||r<200)&&(u.appendChild(d.element),r++)}s.appendChild(l),s.appendChild(u),p.groups.push(s),0<u.children.length&&b.appendChild(s)}if(t.length)for(n=0;n<t.length;n++){d=p.createItem(e[t[n]]);(0==p.options.lazyLoading||r<200)&&(b.appendChild(d.element),r++)}}},p.setData=function(e){if(e.length){for(var t=0;t<e.length;t++)"object"!=typeof e[t]&&(p.options.format?e[t]={id:e[t],name:e[t]}:e[t]={value:e[t],text:e[t]});u(),b.innerHTML="",p.header.value="",p.items=[],p.appendData(e),p.options.data=e}},p.getData=function(){return p.options.data},p.getPosition=function(e){for(var t=0;t<p.items.length;t++)if(c(t)==e)return t;return!1},p.getText=function(e){var t=l();return e?t:t.join("; ")},p.getValue=function(e){var t=s();return e?t:t.join(";")},p.setValue=function(e){var t=p.getValue();t!==(e=Array.isArray(e)?e.join(";"):e)&&(n(e),a(t))},p.resetSelected=function(){p.setValue(null)},p.selectIndex=function(e,t){e=parseInt(e);p.items&&p.items[e]&&(!0===t||!0!==p.items[e].data.disabled)&&(p.setCursor(e,!1),p.options.multiple?(t=p.options.value,p.items[e].selected?(p.items[e].element.classList.remove("jdropdown-selected"),p.items[e].selected=!1,delete p.value[c(e)]):(p.items[e].element.classList.add("jdropdown-selected"),p.items[e].selected=!0,p.value[c(e)]=d(e)),p.options.value=Object.keys(p.value).join(";"),0==p.options.autocomplete&&(p.header.value=l().join("; ")),a(t)):(p.items[e].selected?p.setValue(null):p.setValue(c(e)),p.close()))},p.selectItem=function(e){p.selectIndex(e.indexValue)};return p.find=function(e){if(p.search==e.trim())return!1;if(p.search=e,p.setCursor(),p.groups.length)for(var t=0;t<p.groups.length;t++)p.groups[t].lastChild.innerHTML="";if(b.innerHTML="",1==p.options.remoteSearch){p.results=null;var o=p.options.url+(0<p.options.url.indexOf("?")?"&":"?")+"q="+e;F.ajax({url:o,method:"GET",dataType:"json",success:function(e){p.items=[];var t=Object.keys(p.value);if(t.length)for(var o=0;o<t.length;o++)!function(e,t){for(var o=0;o<t.length;o++)if(p.options.format){if(t[o].id==e)return!0}else if(t[o].value==e)return!0;return!1}(t[o],e)&&(p.options.format?e.unshift({id:t[o],name:p.value[t[o]]}):e.unshift({value:t[o],text:p.value[t[o]]}));p.appendData(e),e.length?b.style.display="":b.style.display="none"}})}else{e=new RegExp(e,"gi");for(var n=[],t=0;t<p.items.length;t++){var r=d(t),i=p.items[t].data.title||"",s=p.items[t].data.group||"",l=(l=p.items[t].data.synonym||"")&&l.join(" ");(null==e||1==p.items[t].selected||r.match(e)||i.match(e)||s.match(e)||l.match(e))&&n.push(p.items[t])}if(n.length){b.style.display="";var a=(p.results=n).length||0;1==p.options.lazyLoading&&200<a&&(a=200);for(t=0;t<a;t++)p.results[t].group?(p.results[t].group.parentNode||b.appendChild(p.results[t].group),p.results[t].group.lastChild.appendChild(p.results[t].element)):b.appendChild(p.results[t].element)}else b.style.display="none",p.results=null}1==p.options.autofocus&&p.first()},p.open=function(){var e,t;r.classList.contains("jdropdown-focus")||(F.dropdown.current=p,F.tracking(p,!0),r.classList.add("jdropdown-focus"),F.getWindowWidth()<800&&(null!=p.options.type&&"picker"!=p.options.type||F.animation.slideBottom(f,1)),1==p.options.autocomplete&&(p.header.value=p.search,p.header.focus()),(e=s())[0]&&!1!==(e=p.getPosition(e[0]))&&p.setCursor(e),p.options.type&&"default"!=p.options.type||(e=r.getBoundingClientRect(),t=f.getBoundingClientRect(),p.options.position?(f.style.position="fixed",window.innerHeight<e.bottom+t.height?(f.style.top="",f.style.bottom=window.innerHeight-e.top+1+"px"):(f.style.top=e.bottom+"px",f.style.bottom=""),f.style.left=e.left+"px"):window.innerHeight<e.bottom+t.height?(f.style.top="",f.style.bottom=e.height+1+"px"):(f.style.top="",f.style.bottom=""),f.style.minWidth=e.width+"px",p.options.maxWidth&&(f.style.maxWidth=p.options.maxWidth),p.items.length||1!=p.options.autocomplete?b.style.display="":b.style.display="none")),"function"==typeof p.options.onopen&&p.options.onopen(r)},p.close=function(e){return r.classList.contains("jdropdown-focus")&&(p.header.value=p.getText(),p.setCursor(),e||"function"!=typeof p.options.onclose||p.options.onclose(r),p.header.blur&&p.header.blur(),r.classList.remove("jdropdown-focus"),F.tracking(p,!1),F.dropdown.current=null),p.getValue()},p.setCursor=function(e,t){null!=p.currentIndex&&p.items&&p.items[p.currentIndex]&&p.items[p.currentIndex].element.classList.remove("jdropdown-cursor"),null==e?p.currentIndex=null:(e=parseInt(e),p.items[e].element.parentNode&&(p.items[e].element.classList.add("jdropdown-cursor"),p.currentIndex=e,!1!==t&&p.items[p.currentIndex].element&&(b.scrollTop,e=p.items[p.currentIndex].element,b.scrollTop=e.offsetTop-e.scrollTop+e.clientTop-95)))},p.resetCursor=p.setCursor,p.updateCursor=p.setCursor,p.reset=function(){p.setCursor(),p.setValue(null)},p.first=function(){!0===p.options.lazyLoading&&p.loadFirst();var e=b.querySelectorAll(".jdropdown-item");e.length&&(e=e[0].indexValue,p.setCursor(e))},p.last=function(){!0===p.options.lazyLoading&&p.loadLast();var e=b.querySelectorAll(".jdropdown-item");e.length&&(e=e[e.length-1].indexValue,p.setCursor(e))},p.next=function(e){var t,o,n=null;if(e){if(1==e.length){var r,i=p.currentIndex||-1,s=(e=e.toLowerCase(),null),l=b.querySelectorAll(".jdropdown-item");if(l.length){for(var a=0;a<l.length;a++)if(l[a].indexValue>i&&(r=p.items[l[a].indexValue])&&(s=r.element.innerText[0])&&e==(s=s.toLowerCase())){n=l[a].indexValue;break}p.setCursor(n)}}}else null==p.currentIndex||null==p.currentIndex?p.first():((o=(t=p.items[p.currentIndex].element).nextElementSibling)?n=(o=o.classList.contains("jdropdown-group")?o.lastChild.firstChild:o).indexValue:t.parentNode.classList.contains("jdropdown-group-items")&&((o=t.parentNode.parentNode.nextElementSibling)&&(o.classList.contains("jdropdown-group")?o=o.lastChild.firstChild:o.classList.contains("jdropdown-item")?n=o.indexValue:o=null),o&&(n=o.indexValue)),null!==n&&p.setCursor(n))},p.prev=function(){var e,t,o=null;null===p.currentIndex?p.first():(t=(e=p.items[p.currentIndex].element).previousElementSibling)?o=(t=t.classList.contains("jdropdown-group")?t.lastChild.lastChild:t).indexValue:e.parentNode.classList.contains("jdropdown-group-items")&&((t=e.parentNode.parentNode.previousElementSibling)&&(t.classList.contains("jdropdown-group")?t=t.lastChild.lastChild:t.classList.contains("jdropdown-item")?o=t.indexValue:t=null),t&&(o=t.indexValue)),null!==o&&p.setCursor(o)},p.loadFirst=function(){var e,t=(e=p.results||p.items).length||0;1==p.options.lazyLoading&&200<t&&(t=200),b.innerHTML="";for(var o=0;o<t;o++)e[o].group?(e[o].group.parentNode||b.appendChild(e[o].group),e[o].group.lastChild.appendChild(e[o].element)):b.appendChild(e[o].element);b.scrollTop=0},p.loadLast=function(){var e,t=(e=p.results||p.items).length;if(200<t){t-=200,b.innerHTML="";for(var o=t;o<e.length;o++)e[o].group?(e[o].group.parentNode||b.appendChild(e[o].group),e[o].group.lastChild.appendChild(e[o].element)):b.appendChild(e[o].element);b.scrollTop=b.scrollHeight}},p.loadUp=function(){var e,t=!1;e=p.results||p.items;var o=b.querySelectorAll(".jdropdown-item")[0].indexValue,o=p.items[o],n=e.indexOf(o)-1;if(0<n){for(var r=0;0<n&&e[n]&&r<200;)e[n].group?(e[n].group.parentNode||b.insertBefore(e[n].group,b.firstChild),e[n].group.lastChild.insertBefore(e[n].element,e[n].group.lastChild.firstChild)):b.insertBefore(e[n].element,b.firstChild),n--,r++;t=!0}return t},p.loadDown=function(){var e,t=!1,o=(e=p.results||p.items,b.querySelectorAll(".jdropdown-item")),o=o[o.length-1].indexValue,o=p.items[o],n=e.indexOf(o)+1;if(n<e.length){for(var r=0;n<e.length&&e[n]&&r<200;)e[n].group?(e[n].group.parentNode||b.appendChild(e[n].group),e[n].group.lastChild.appendChild(e[n].element)):b.appendChild(e[n].element),n++,r++;t=!0}return t},e=e||{},"SELECT"==r.tagName&&(t=F.dropdown.extractFromDom(r,e),r=t.el,e=t.options),!e.placeholder&&r.getAttribute("placeholder")&&(e.placeholder=r.getAttribute("placeholder")),p.value={},p.items=[],p.groups=[],p.search="",p.results=null,r.classList.add("jdropdown"),(h=document.createElement("div")).className="jdropdown-container-header",p.header=document.createElement("input"),p.header.className="jdropdown-header",p.header.type="text",p.header.setAttribute("autocomplete","off"),p.header.onfocus=function(){"function"==typeof p.options.onfocus&&p.options.onfocus(r)},p.header.onblur=function(){"function"==typeof p.options.onblur&&p.options.onblur(r)},p.header.onkeyup=function(e){1!=p.options.autocomplete||v?p.options.autocomplete||p.next(e.key):(p.search!=p.header.value.trim()&&(v=setTimeout(function(){p.find(p.header.value.trim()),v=null},400)),r.classList.contains("jdropdown-focus")||p.open())},F.dropdown.hasEvents||(F.dropdown.hasEvents=!0,document.addEventListener("keydown",F.dropdown.keydown)),(f=document.createElement("div")).className="jdropdown-container",(b=document.createElement("div")).className="jdropdown-content",(m=document.createElement("div")).className="jdropdown-close",m.innerHTML="Done",(g=document.createElement("div")).className="jdropdown-reset",g.innerHTML="x",g.onclick=function(){p.reset(),p.close()},(j=document.createElement("div")).className="jdropdown-backdrop",h.appendChild(p.header),f.appendChild(b),r.appendChild(h),r.appendChild(f),r.appendChild(j),p.setOptions(e),"ontouchsend"in document.documentElement==!0?r.addEventListener("touchsend",F.dropdown.mouseup):r.addEventListener("mouseup",F.dropdown.mouseup),1==p.options.lazyLoading&&F.lazyLoading(b,{loadUp:p.loadUp,loadDown:p.loadDown}),b.onwheel=function(e){e.stopPropagation()},r.change=p.setValue,r.val=function(e){if(void 0===e)return p.getValue(!!p.options.multiple);p.setValue(e)},r.dropdown=p},F.dropdown.keydown=function(e){var t=null;if(t=F.dropdown.current)if(13==e.which||9==e.which)t.header.value&&null==t.currentIndex&&t.options.newOptions?t.add():(null==t.currentIndex&&1==t.options.autocomplete&&""!=t.header.value&&t.find(t.header.value),t.selectIndex(t.currentIndex));else if(38==e.which)null==t.currentIndex?t.first():0<t.currentIndex&&t.prev(),e.preventDefault();else if(40==e.which)null==t.currentIndex?t.first():t.currentIndex+1<t.items.length&&t.next(),e.preventDefault();else if(36==e.which)t.first(),e.target.classList.contains("jdropdown-header")||e.preventDefault();else if(35==e.which)t.last(),e.target.classList.contains("jdropdown-header")||e.preventDefault();else if(27==e.which)t.close();else if(33==e.which){if(null==t.currentIndex)t.first();else if(0<t.currentIndex)for(var o=0;o<7;o++)t.prev();e.preventDefault()}else if(34==e.which){if(null==t.currentIndex)t.first();else if(t.currentIndex+1<t.items.length)for(o=0;o<7;o++)t.next();e.preventDefault()}},F.dropdown.mouseup=function(e){var t=F.findElement(e.target,"jdropdown");if(t){var o,n=t.dropdown;if(e.target.classList.contains("jdropdown-header"))t.classList.contains("jdropdown-focus")&&t.classList.contains("jdropdown-default")?(t=t.getBoundingClientRect(),e.changedTouches&&e.changedTouches[0]?(o=e.changedTouches[0].clientX,e.changedTouches[0].clientY):(o=e.clientX,e.clientY),t.width-(o-t.left)<30?e.target.classList.contains("jdropdown-add")?n.add():n.close():0==n.options.autocomplete&&n.close()):n.open();else if(e.target.classList.contains("jdropdown-group-name")){var r=e.target.nextSibling.children;if("none"!=e.target.nextSibling.style.display)for(var i=0;i<r.length;i++)"none"!=r[i].style.display&&n.selectItem(r[i])}else e.target.classList.contains("jdropdown-group-arrow")?e.target.classList.contains("jdropdown-group-arrow-down")?(e.target.classList.remove("jdropdown-group-arrow-down"),e.target.classList.add("jdropdown-group-arrow-up"),e.target.parentNode.nextSibling.style.display="none"):(e.target.classList.remove("jdropdown-group-arrow-up"),e.target.classList.add("jdropdown-group-arrow-down"),e.target.parentNode.nextSibling.style.display=""):e.target.classList.contains("jdropdown-item")?n.selectItem(e.target):e.target.classList.contains("jdropdown-image")||e.target.classList.contains("jdropdown-description")?n.selectItem(e.target.parentNode):e.target.classList.contains("jdropdown-title")?n.selectItem(e.target.parentNode.parentNode):(e.target.classList.contains("jdropdown-close")||e.target.classList.contains("jdropdown-backdrop"))&&n.close()}},F.dropdown.extractFromDom=function(e,r){var i=e;if(r=r||{},!e.getAttribute("multiple")||r&&null!=r.multiple||(r.multiple=!0),!e.getAttribute("placeholder")||r&&null!=r.placeholder||(r.placeholder=e.getAttribute("placeholder")),!e.getAttribute("data-autocomplete")||r&&null!=r.autocomplete||(r.autocomplete=!0),r&&null!=r.width||(r.width=e.offsetWidth),!e.value||r&&null!=r.value||(r.value=e.value),!r||null==r.data){r.data=[];for(var t=0;t<e.children.length;t++)if("OPTGROUP"==e.children[t].tagName)for(var o=0;o<e.children[t].children.length;o++)r.data.push({value:e.children[t].children[o].value,text:e.children[t].children[o].innerHTML,group:e.children[t].getAttribute("label")});else r.data.push({value:e.children[t].value,text:e.children[t].innerHTML})}r&&null!=r.onchange||(r.onchange=function(e,t,o,n){1==r.multiple?obj.items[t].classList.contains("jdropdown-selected")?i.options[t].setAttribute("selected","selected"):i.options[t].removeAttribute("selected"):i.value=n});var n=document.createElement("div");return e.parentNode.insertBefore(n,e),e.style.display="none",{el:e=n,options:r}},F.editor=function(s,e){var t,u={type:"editor",options:{}},o={value:null,snippet:null,toolbar:null,remoteParser:null,placeholder:null,parseURL:!1,filterPaste:!0,dropZone:!1,dropAsSnippet:!1,acceptImages:!1,acceptFiles:!1,maxFileSize:5e6,allowImageResize:!0,border:!0,padding:!0,maxHeight:null,height:null,focus:!1,onclick:null,onfocus:null,onblur:null,onload:null,onkeyup:null,onkeydown:null,onchange:null,userSearch:null};for(t in o)e&&e.hasOwnProperty(t)?u.options[t]=e[t]:u.options[t]=o[t];function i(e){"function"==typeof u.options.onchange&&u.options.onchange(s,u,e),u.options.value=u.getData(),s.value!=u.options.value&&(s.value=u.options.value,"function"==typeof s.oninput&&s.oninput({type:"input",target:s,value:s.value}))}function l(e){var t,o;window.getSelection&&(o=window.getSelection()).rangeCount&&((t=o.getRangeAt(0)).toString(),t.deleteContents(),t.insertNode(e),t.setStartAfter(e),t.setEndAfter(e),o.removeAllRanges(),o.addRange(t))}function a(){var e,t=null;(t=f.children[0])&&(t.classList.contains("jslider-grid")||t.classList.add("jslider-grid"),e=t.children.length,t.setAttribute("data-number",4<e?4:e),4<e?t.setAttribute("data-total",e-4):t.removeAttribute("data-total"))}function c(e){f.innerHTML="";for(var t=["image","title","description","host","url"],o=0;o<t.length;o++){var n=document.createElement("div");if(n.className="jsnippet-"+t[o],n.setAttribute("data-k",t[o]),f.appendChild(n),e[t[o]])if("image"==t[o]){Array.isArray(e.image)||(e.image=[e.image]);for(var r=0;r<e.image.length;r++){var i=document.createElement("img");i.src=e.image[r],n.appendChild(i)}}else n.innerHTML=e[t[o]]}m.appendChild(document.createElement("br")),m.appendChild(f)}function n(){clearTimeout(d),d=setTimeout(function(){var e,t;m.querySelector(".jsnippet")||(t=m.innerHTML.replace(/\n/g," "),(e=document.createElement("div")).innerHTML=t,t=e.innerText,(e=F.editor.detectUrl(t))&&("jpg"==e[0].substr(-3)||"png"==e[0].substr(-3)||"gif"==e[0].substr(-3)?u.addImage(e[0],!0):(t=F.editor.youtubeParser(e[0]),u.parseWebsite(e[0],t))))},1e3)}var r,d=null,p=null,h=[],f=(s.innerHTML="",u.el=s,"function"==typeof u.options.onclick&&(s.onclick=function(e){u.options.onclick(s,u,e)}),s.classList.add("jeditor-container"),1==u.options.padding&&s.classList.add("jeditor-padding"),0==u.options.border&&(s.style.border="0px"),document.createElement("div")),b=(f.className="jsnippet",f.setAttribute("contenteditable",!1),document.createElement("div")),m=(b.className="jeditor-toolbar",document.createElement("div")),g=(m.setAttribute("contenteditable",!0),m.setAttribute("spellcheck",!1),m.className="jeditor",u.options.placeholder&&m.setAttribute("data-placeholder",u.options.placeholder),(u.options.maxHeight||u.options.height)&&(m.style.overflowY="auto",u.options.maxHeight&&(m.style.maxHeight=u.options.maxHeight),u.options.height&&(m.style.height=u.options.height)),r=(r=u.options.value||s.innerHTML||"")||"",u.parseContent=function(){n()},u.parseWebsite=function(e,t){var o;u.options.remoteParser?(o={title:"",description:"",image:"",host:(e=t?"https://www.youtube.com/watch?v="+t:e).split("/")[2],url:e},F.ajax({url:u.options.remoteParser+encodeURI(e.trim()),method:"GET",dataType:"json",success:function(e){e.title&&(o.title=e.title),e.description&&(o.description=e.description),e.host&&(o.host=e.host),e.url&&(o.url=e.url),c(o),e.image?u.addImage(e.image,!0):e["og:image"]&&u.addImage(e["og:image"],!0)}})):console.log("The remoteParser is not defined")},u.setData=function(e){m.innerHTML="object"==typeof e?e.content:e,u.options.focus&&F.editor.setCursor(m,!0),h=[]},u.getFiles=function(){for(var e=m.querySelectorAll(".jfile"),t=[],o=0;o<e.length;o++)h[e[o].src]&&t.push(h[e[o].src]);return t},u.getText=function(){return m.innerText},u.getData=function(e){if(e){a={content:""};if(f.innerHTML){a.snippet={};for(var t=0;t<f.children.length;t++){var o=f.children[t].getAttribute("data-k");if(o)if("image"==o){a.snippet.image||(a.snippet.image=[]);for(var n=0;n<f.children[t].children.length;n++)a.snippet.image.push(f.children[t].children[n].getAttribute("src"))}else a.snippet[o]=f.children[t].innerHTML}}var r=Object.keys(h);if(r.length){a.files=[];for(t=0;t<r.length;t++)a.files.push(h[r[t]])}if(R){var i=m.querySelectorAll("a[data-user]");if(i.length){a.users=[];for(t=0;t<i.length;t++){var s=i[t].getAttribute("data-user");s&&a.users.push(s)}a.users=a.users.join(",")}}var e=document.createElement("div"),l=(e.innerHTML=m.innerHTML,e.querySelector(".jsnippet")),l=(l&&l.remove(),e.innerHTML);l=(l=(l=l.replace(/<br>/g,"\n")).replace(/<\/div>/g,"</div>\n")).replace(/<(?:.|\n)*?>/gm,""),a.content=l.trim()}else var a=m.innerHTML;return a},u.reset=function(){m.innerHTML="",f.innerHTML="",h=[]},u.addPdf=function(o){var e,t;"data"!=o.result.substr(0,4)?console.error("Invalid source"):((e=document.createElement("canvas")).width=60,e.height=60,t=new Image,e.getContext("2d").drawImage(t,0,0,e.width,e.height),e.toBlob(function(e){var t=document.createElement("img");t.src=window.URL.createObjectURL(e),t.title=o.name,t.className="jfile pdf",h[t.src]={file:t.src,extension:"pdf",content:o.result},l(t)}))},u.addImage=function(e,n){var r,t;"data"==(e=e||"").substr(0,4)||u.options.remoteParser?("data"==e.substr(0,4)?r=(r=(r=e.split(";"))[0].split("/"))[1]:(r=e.substr(e.lastIndexOf(".")+1),e=u.options.remoteParser+e),(t=new Image).onload=function(){var o=document.createElement("canvas");o.width=t.width,o.height=t.height,o.getContext("2d").drawImage(t,0,0,o.width,o.height),o.toBlob(function(e){var t=document.createElement("img");t.src=window.URL.createObjectURL(e),t.classList.add("jfile"),t.setAttribute("tabindex","900"),h[t.src]={file:t.src,extension:r,content:o.toDataURL()},u.options.dropAsSnippet||n?(e=t,f.innerHTML||c({}),f.children[0].appendChild(e),a(),h[t.src].snippet=!0):l(t),i()})},t.src=e):console.error("remoteParser not defined in your initialization")},u.addFile=function(e){for(var t,o=[],n=0;n<e.length;n++)e[n].size>u.options.maxFileSize?alert("The file is too big"):(t="image"==(t=e[n].type.split("/"))[0]?1:"pdf"==t[1]?2:0)?(o[n]=new FileReader,o[n].index=n,o[n].type=t,o[n].name=e[n].name,o[n].date=e[n].lastModified,o[n].size=e[n].size,o[n].addEventListener("load",function(e){2==e.target.type?1==u.options.acceptFiles&&u.addPdf(e.target):u.addImage(e.target.result)},!1),o[n].readAsDataURL(e[n])):alert("The extension is not allowed")},u.destroy=function(){m.removeEventListener("mouseup",g),m.removeEventListener("mousedown",j),m.removeEventListener("mousemove",v),m.removeEventListener("keyup",y),m.removeEventListener("keydown",x),m.removeEventListener("dragstart",L),m.removeEventListener("dragenter",I),m.removeEventListener("dragover",M),m.removeEventListener("drop",T),m.removeEventListener("paste",N),m.removeEventListener("blur",D),m.removeEventListener("focus",S),s.editor=null,s.classList.remove("jeditor-container"),b.remove(),f.remove(),m.remove()},function(e){p&&p.e&&p.e.classList.remove("resizing"),p=!1}),j=function(o){function e(e){var t=e.getBoundingClientRect();t.width-(o.clientX-t.left)<40&&o.clientY-t.top<40&&(e.innerHTML="",e.remove())}if("IMG"==o.target.tagName)if(o.target.style.cursor){var t=o.target.getBoundingClientRect(),n=(p={e:o.target,x:o.clientX,y:o.clientY,w:t.width,h:t.height,d:o.target.style.cursor},o.target.width||(o.target.width=t.width+"px"),o.target.height||(o.target.height=t.height+"px"),window.getSelection());if(n.rangeCount)for(var r=0;r<n.rangeCount;r++)n.removeRange(n.getRangeAt(r));o.target.classList.add("resizing")}else p=!0;else o.target.classList.contains("jsnippet")?e(o.target):o.target.parentNode.classList.contains("jsnippet")&&e(o.target.parentNode),p=!0},v=function(e){var t,o;"IMG"!=e.target.tagName||e.target.parentNode.classList.contains("jsnippet-image")||1!=u.options.allowImageResize||e.target.getAttribute("tabindex")&&(t=e.target.getBoundingClientRect(),e.clientY-t.top<5?t.width-(e.clientX-t.left)<5?e.target.style.cursor="ne-resize":e.clientX-t.left<5?e.target.style.cursor="nw-resize":e.target.style.cursor="n-resize":t.height-(e.clientY-t.top)<5?t.width-(e.clientX-t.left)<5?e.target.style.cursor="se-resize":e.clientX-t.left<5?e.target.style.cursor="sw-resize":e.target.style.cursor="s-resize":t.width-(e.clientX-t.left)<5?e.target.style.cursor="e-resize":e.clientX-t.left<5?e.target.style.cursor="w-resize":e.target.style.cursor=""),1==e.which&&p&&p.d&&("e-resize"!=p.d&&"ne-resize"!=p.d&&"se-resize"!=p.d||(p.e.width=p.w+(e.clientX-p.x),e.shiftKey?(o=(e.clientX-p.x)*(p.h/p.w),p.e.height=p.h+o):o=null),o||"s-resize"!=p.d&&"se-resize"!=p.d&&"sw-resize"!=p.d||e.shiftKey||(p.e.height=p.h+(e.clientY-p.y)))},y=function(e){var t;m.innerHTML||(m.innerHTML="<div><br></div>"),R&&(t=F.getNode())&&(!0===t.searchable?t.innerText&&"@"==t.innerText.substr(0,1)&&O(t.innerText.substr(1)):!1===t.searchable&&t.innerText!==t.getAttribute("data-label")&&(t.searchable=!0,t.removeAttribute("href"))),"function"==typeof u.options.onkeyup&&u.options.onkeyup(s,u,e)},x=function(e){var t,o;1==u.options.parseURL&&n(),R&&("@"==e.key?((t=(window.getSelection?window.getSelection():document.selection).getRangeAt(0)).deleteContents(),(o=document.createElement("a")).innerText="@",o.searchable=!0,t.insertNode(o),o=t.getBoundingClientRect(),t.collapse(!1),R.style.position="fixed",R.style.top=o.top+o.height+10+"px",R.style.left=o.left+2+"px",e.preventDefault()):O.isOpened()&&O.keydown(e)),"function"==typeof u.options.onkeydown&&u.options.onkeydown(s,u,e),"Delete"==e.key&&"IMG"==e.target.tagName&&e.target.parentNode.classList.contains("jsnippet-image")&&(e.target.remove(),a())},C=[HTMLUnknownElement,HTMLAudioElement,HTMLEmbedElement,HTMLIFrameElement,HTMLTextAreaElement,HTMLInputElement,HTMLScriptElement],w=["width","height","align","border","src","tabindex"],E=["color","font-weight","font-size","background","background-color","margin"],A=function(t){if(t.attributes&&t.attributes.length){var e=null,o=t.getAttribute("style");if(o)for(var e=[],n=o.split(";"),r=0;r<n.length;r++){var i,s=n[r].trim().split(":");0<=E.indexOf(s[0].trim())&&(i=s.shift(),s=s.join(":"),e.push(i+":"+s))}"IMG"==t.tagName.toUpperCase()&&(u.options.acceptImages&&t.src?(t.setAttribute("tabindex","900"),u.addImage(t.src)):t.parentNode.removeChild(t));var l=[],o=t.attributes.length-1;if(0<o){for(var a=o;0<=a;a--)l.push(t.attributes[a].name);l.forEach(function(e){-1==w.indexOf(e)&&t.removeAttribute(e)})}t.style="",e&&e.length&&t.setAttribute("style",e.join(";"))}if(t.children.length)for(a=0;a<t.children.length;a++)A(t.children[a]);0<=C.indexOf(t.constructor)&&t.remove()},N=function(e){var t,o,n,r;1==u.options.filterPaste&&(e.clipboardData||e.originalEvent.clipboardData?(t=(e.originalEvent||e).clipboardData.getData("text/html"),o=(e.originalEvent||e).clipboardData.getData("text/plain"),n=(e.originalEvent||e).clipboardData.files):window.clipboardData&&(t=window.clipboardData.getData("Html"),o=window.clipboardData.getData("Text"),n=window.clipboardData.files),n.length?u.addFile(n):t?(n=(n=t)&&n.replace(new RegExp("\x3c!--(.*?)--\x3e","gsi"),""),n=(new DOMParser).parseFromString(n,"text/html"),A(n),(r=document.createElement("span")).innerHTML=n.firstChild.innerHTML,r=r,document.execCommand("insertHtml",!1,r.innerHTML)):(t=o.split("\r\n"),e.target.innerText?(t=t.map(function(e){return"<div>"+e+"</div>"}),document.execCommand("insertHtml",!1,t.join(""))):t.map(function(e){var t=document.createElement("div");t.innerText=e,m.appendChild(t)})),e.preventDefault())},L=function(e){p&&p.e&&e.preventDefault()},I=function(e){p||0==u.options.dropZone||(s.classList.add("jeditor-dragging"),e.preventDefault())},M=function(e){p||0==u.options.dropZone||(d&&clearTimeout(d),d=setTimeout(function(){s.classList.remove("jeditor-dragging")},100),e.preventDefault())},T=function(e){if(!p&&0!=u.options.dropZone){var t=null,o=(document.caretRangeFromPoint?t=document.caretRangeFromPoint(e.clientX,e.clientY):e.rangeParent&&(t=document.createRange()).setStart(e.rangeParent,e.rangeOffset),window.getSelection()),t=(o.removeAllRanges(),o.addRange(t),o.anchorNode.parentNode.focus(),(e.originalEvent||e).dataTransfer.getData("text/html")),o=(e.originalEvent||e).dataTransfer.getData("text/plain"),n=(e.originalEvent||e).dataTransfer.files;if(n.length)u.addFile(n);else if(o){var n=t,o=document.createElement("div"),r=(o.innerHTML=n,o.querySelectorAll("img"));if(r.length)for(var i=0;i<r.length;i++)u.addImage(r[i].src)}s.classList.remove("jeditor-dragging"),e.preventDefault()}},D=function(e){R&&O.isOpened()&&O.close(),"function"==typeof u.options.onblur&&u.options.onblur(s,u,e),i(e)},S=function(e){"function"==typeof u.options.onfocus&&u.options.onfocus(s,u,e)},R=(m.addEventListener("mouseup",g),m.addEventListener("mousedown",j),m.addEventListener("mousemove",v),m.addEventListener("keyup",y),m.addEventListener("keydown",x),m.addEventListener("dragstart",L),m.addEventListener("dragenter",I),m.addEventListener("dragover",M),m.addEventListener("drop",T),m.addEventListener("paste",N),m.addEventListener("focus",S),m.addEventListener("blur",D),"function"==typeof u.options.onload&&u.options.onload(s,u,m),m.innerHTML=r,s.appendChild(m),u.options.snippet&&c(u.options.snippet),null==u.options.toolbar&&(u.options.toolbar=F.editor.getDefaultToolbar()),u.options.toolbar&&(s.appendChild(b),F.toolbar(b,{container:!0,responsive:!0,items:u.options.toolbar})),null),O=null;return u.options.userSearch&&(R=document.createElement("div"),s.appendChild(R),O=F.search(R,{data:u.options.userSearch,placeholder:F.translate("Type the name a user"),onselect:function(e,t,o,n){var r;O.isOpened()&&(r=F.getNode())&&1==r.searchable&&r.innerText.trim()&&r.innerText.substr(1)&&(r.innerText="@"+o,r.href="/"+o,r.setAttribute("data-user",n),r.setAttribute("data-label",r.innerText),r.searchable=!1,F.focus(r))}})),u.options.focus&&F.editor.setCursor(m,"initial"==u.options.focus),s.change=u.setData,s.val=function(e){var t;if(void 0===e)return t="true"!==s.getAttribute("data-html"),u.getData(t);u.setData(e)},s.editor=u},F.editor.setCursor=function(e,t){e.focus(),document.execCommand("selectAll");var o,e=window.getSelection(),n=e.getRangeAt(0);t=1==t?(o=n.startContainer,0):(o=n.endContainer).length,n.setStart(o,t),n.setEnd(o,t),e.removeAllRanges(),e.addRange(n)},F.editor.getDomain=function(e){return e.replace("http://","").replace("https://","").replace("www.","").split(/[/?#]/)[0].split(/:/g)[0]},F.editor.detectUrl=function(e){e=e.match(/(((https?:\/\/)|(www\.))[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|]+)/gi);return e&&"www"==e[0].substr(0,3)&&(e[0]="http://"+e[0]),e},F.editor.youtubeParser=function(e){e=e.match(/^.*((youtu.be\/)|(v\/)|(\/u\/\w\/)|(embed\/)|(watch\?))\??v?=?([^#\&\?]*).*/);return!(!e||11!=e[7].length)&&e[7]},F.editor.getDefaultToolbar=function(){return[{content:"undo",onclick:function(){document.execCommand("undo")}},{content:"redo",onclick:function(){document.execCommand("redo")}},{type:"divisor"},{content:"format_bold",onclick:function(e,t,o){document.execCommand("bold"),document.queryCommandState("bold")?o.classList.add("selected"):o.classList.remove("selected")}},{content:"format_italic",onclick:function(e,t,o){document.execCommand("italic"),document.queryCommandState("italic")?o.classList.add("selected"):o.classList.remove("selected")}},{content:"format_underline",onclick:function(e,t,o){document.execCommand("underline"),document.queryCommandState("underline")?o.classList.add("selected"):o.classList.remove("selected")}},{type:"divisor"},{content:"format_list_bulleted",onclick:function(e,t,o){document.execCommand("insertUnorderedList"),document.queryCommandState("insertUnorderedList")?o.classList.add("selected"):o.classList.remove("selected")}},{content:"format_list_numbered",onclick:function(e,t,o){document.execCommand("insertOrderedList"),document.queryCommandState("insertOrderedList")?o.classList.add("selected"):o.classList.remove("selected")}},{content:"format_indent_increase",onclick:function(e,t,o){document.execCommand("indent",!0,null),document.queryCommandState("indent")?o.classList.add("selected"):o.classList.remove("selected")}},{content:"format_indent_decrease",onclick:function(){document.execCommand("outdent"),document.queryCommandState("outdent")?this.classList.add("selected"):this.classList.remove("selected")}}]},F.form=function(l,e){var t,a={options:{}},o={url:null,message:"Are you sure? There are unsaved information in your form",ignore:!1,currentHash:null,submitButton:null,validations:null,onbeforeload:null,onload:null,onbeforesave:null,onsave:null,onbeforeremove:null,onremove:null,onerror:function(e,t){F.alert(t)}};for(t in o)e&&e.hasOwnProperty(t)?a.options[t]=e[t]:a.options[t]=o[t];a.options.validations||(a.options.validations={}),a.options.submitButton||(a.options.submitButton=l.querySelector("input[type=submit]")),a.options.submitButton&&a.options.url&&(a.options.submitButton.onclick=function(){a.save()}),a.options.validations.email||(a.options.validations.email=F.validations.email),a.options.validations.length||(a.options.validations.length=F.validations.length),a.options.validations.required||(a.options.validations.required=F.validations.required),a.setUrl=function(e){a.options.url=e},a.load=function(){F.ajax({url:a.options.url,method:"GET",dataType:"json",queue:!0,success:function(e){var t;"function"==typeof a.options.onbeforeload&&(t=a.options.onbeforeload(l,e))&&(e=t),F.form.setElements(l,e),"function"==typeof a.options.onload&&a.options.onload(l,e)}})},a.save=function(){var e=a.validate();if(e)a.options.onerror(l,e);else{var t=F.form.getElements(l,!0);if("function"==typeof a.options.onbeforesave)if(!1===(t=a.options.onbeforesave(l,t)))return;F.ajax({url:a.options.url,method:"POST",dataType:"json",data:t,success:function(e){"function"==typeof a.options.onsave&&a.options.onsave(l,t,e)}})}},a.remove=function(){if("function"==typeof a.options.onbeforeremove&&!1===a.options.onbeforeremove(l,a))return!1;F.ajax({url:a.options.url,method:"DELETE",dataType:"json",success:function(e){"function"==typeof a.options.onremove&&a.options.onremove(l,a,e),a.reset()}})};return a.validateElement=function(e){var t=!1,o=F.form.getValue(e),n=e.getAttribute("data-validation");if("function"!=typeof a.options.validations[n]||a.options.validations[n](o,e)){if(e.classList.contains("error")){for(var n=e,r=!1,i=(n.classList.remove("error"),n.removeAttribute("title"),l.querySelectorAll("input, select, textarea, div[name]")),s=0;s<i.length;s++)i[s].getAttribute("data-validation")&&i[s].classList.contains("error")&&(r=!0);a.options.submitButton&&(r?a.options.submitButton.setAttribute("disabled",!0):a.options.submitButton.removeAttribute("disabled"))}}else(o=e).classList.add("error"),a.options.submitButton&&a.options.submitButton.setAttribute("disabled",!0),n=o.getAttribute("data-error")||"There is an error in the form",o.setAttribute("title",n),t=n;return t},a.reset=function(){for(var e=l.querySelectorAll("input, select, textarea, div[name]"),t=0;t<e.length;t++)e[t].getAttribute("name")&&("checkbox"==e[t].type||"radio"==e[t].type?e[t].checked=!1:"function"==typeof e[t].val?e[t].val(""):e[t].value="")},a.validate=function(){for(var e,t=[],o=l.querySelectorAll("input, select, textarea, div[name]"),n=0;n<o.length;n++)o[n].getAttribute("data-validation")&&(e=a.validateElement(o[n]))&&t.push(e);return 0<t.length&&t.join("<br>")},a.getError=function(){return!!a.validation()},a.setHash=function(){return a.getHash(F.form.getElements(l))},a.getHash=function(e){var t,o=0;if(0===e.length)return o;for(t=0;t<e.length;t++)o=(o<<5)-o+e.charCodeAt(t),o|=0;return o},a.isChanged=function(){var e=a.setHash();return a.options.currentHash!=e},a.resetTracker=function(){a.options.currentHash=a.setHash(),a.options.ignore=!1},a.setIgnore=function(e){a.options.ignore=!!e},setTimeout(function(){a.options.currentHash=a.setHash()},1e3),l.addEventListener("keyup",function(e){e.target.getAttribute("data-validation")&&a.validateElement(e.target)}),F.form.hasEvents||(window.addEventListener("beforeunload",function(e){if(a.isChanged()&&0==a.options.ignore){var t=a.options.message||"o/";if(t)return(e=void 0===e?window.event:e)&&(e.returnValue=t),t}}),F.form.hasEvents=!0),l.form=a},F.form.getValue=function(e){var t=null;if("checkbox"==e.type)1==e.checked&&(t=e.value||!0);else if("radio"==e.type)1==e.checked&&(t=e.value);else if("file"==e.type)t=e.files;else if("select"==e.tagName&&1==e.multiple)for(var t=[],o=e.querySelectorAll("options[selected]"),n=0;n<o.length;n++)t.push(o[n].value);else t="function"==typeof e.val?e.val():e.value||"";return t},F.form.getElements=function(e,t){for(var o,n={},r=e.querySelectorAll("input, select, textarea, div[name]"),i=0;i<r.length;i++)(o=r[i].getAttribute("name"))&&(n[o]=F.form.getValue(r[i])||"");return 1==t?n:JSON.stringify(n)},F.form.setElements=function(e,t){for(var o=null,n=null,r=e.querySelectorAll("input, select, textarea, div[name]"),i=0;i<r.length;i++){var s,l=r[i].getAttribute("type");(o=r[i].getAttribute("name"))&&(n=null,(o=o.replace(new RegExp(/\[(.*?)\]/gi),".$1")).match(/\./)?void 0!==(s=F.path.call(t,o)||"")&&(n=s):void 0!==t[o]&&(n=t[o]),null!==n&&("checkbox"==l||"radio"==l?r[i].checked=!!n:"file"!=l&&("function"==typeof r[i].val?r[i].val(n):r[i].value=n)))}},F.tracker=F.form,F.focus=function(e){var t,o,n;e.innerText.length&&(t=document.createRange(),o=window.getSelection(),n=e.childNodes[e.childNodes.length-1],t.setStart(n,n.length),t.collapse(!0),o.removeAllRanges(),o.addRange(t),e.scrollLeft=e.scrollWidth)},F.isNumeric=function(e){return!isNaN(e)&&null!==e&&""!==e},F.guid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)})},F.getNode=function(){var e=document.getSelection().anchorNode;return e?3==e.nodeType?e.parentNode:e:null},F.hash=function(e){var t,o,n=0;if(0===e.length)return n;for(t=0;t<e.length;t++)32<(o=e.charCodeAt(t))&&(n=(n<<5)-n+o,n|=0);return n},F.randomColor=function(e){for(var t,o=String("#"+Math.random().toString(16).slice(2,8).toUpperCase()).replace(/[^0-9a-f]/gi,""),n=(o.length<6&&(o=o[0]+o[0]+o[1]+o[1]+o[2]+o[2]),[]),r=0;r<3;r++)t=parseInt(o.substr(2*r,2),16),t=Math.round(Math.min(Math.max(0,t+-.25*t),255)).toString(16),n.push(("00"+t).substr(t.length));return 1==e?"#"+F.two(n[0].toString(16))+F.two(n[1].toString(16))+F.two(n[2].toString(16)):n},F.getWindowWidth=function(){var e=window,t=document,o=t.documentElement,t=t.getElementsByTagName("body")[0];return e.innerWidth||o.clientWidth||t.clientWidth},F.getWindowHeight=function(){var e=window,t=document,o=t.documentElement,t=t.getElementsByTagName("body")[0];return e.innerHeight||o.clientHeight||t.clientHeight},F.getPosition=function(e){var t;return e=e.changedTouches&&e.changedTouches[0]?(t=e.changedTouches[0].pageX,e.changedTouches[0].pageY):(t=window.Event?e.pageX:e.clientX+(document.documentElement.scrollLeft||document.body.scrollLeft),window.Event?e.pageY:e.clientY+(document.documentElement.scrollTop||document.body.scrollTop)),[t,e]},F.click=function(e){var t;e.click?e.click():(t=new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window}),e.dispatchEvent(t))},F.findElement=function(e,o){var n=!1;return function e(t){t&&!n&&("function"==typeof o?n=o(t):"string"==typeof o&&t.classList&&t.classList.contains(o)&&(n=t)),t.parentNode&&!n&&e(t.parentNode)}(e),n},F.two=function(e){return e=1==(e=""+e).length?"0"+e:e},F.sha512=function(e){function i(e,t){this.highOrder=e,this.lowOrder=t}var t=[new i(1779033703,4089235720),new i(3144134277,2227873595),new i(1013904242,4271175723),new i(2773480762,1595750129),new i(1359893119,2917565137),new i(2600822924,725511199),new i(528734635,4215389547),new i(1541459225,327033209)],k=[new i(1116352408,3609767458),new i(1899447441,602891725),new i(3049323471,3964484399),new i(3921009573,2173295548),new i(961987163,4081628472),new i(1508970993,3053834265),new i(2453635748,2937671579),new i(2870763221,3664609560),new i(3624381080,2734883394),new i(310598401,1164996542),new i(607225278,1323610764),new i(1426881987,3590304994),new i(1925078388,4068182383),new i(2162078206,991336113),new i(2614888103,633803317),new i(3248222580,3479774868),new i(3835390401,2666613458),new i(4022224774,944711139),new i(264347078,2341262773),new i(604807628,2007800933),new i(770255983,1495990901),new i(1249150122,1856431235),new i(1555081692,3175218132),new i(1996064986,2198950837),new i(2554220882,3999719339),new i(2821834349,766784016),new i(2952996808,2566594879),new i(3210313671,3203337956),new i(3336571891,1034457026),new i(3584528711,2466948901),new i(113926993,3758326383),new i(338241895,168717936),new i(666307205,1188179964),new i(773529912,1546045734),new i(1294757372,1522805485),new i(1396182291,2643833823),new i(1695183700,2343527390),new i(1986661051,1014477480),new i(2177026350,1206759142),new i(2456956037,344077627),new i(2730485921,1290863460),new i(2820302411,3158454273),new i(3259730800,3505952657),new i(3345764771,106217008),new i(3516065817,3606008344),new i(3600352804,1432725776),new i(4094571909,1467031594),new i(275423344,851169720),new i(430227734,3100823752),new i(506948616,1363258195),new i(659060556,3750685593),new i(883997877,3785050280),new i(958139571,3318307427),new i(1322822218,3812723403),new i(1537002063,2003034995),new i(1747873779,3602036899),new i(1955562222,1575990012),new i(2024104815,1125592928),new i(2227730452,2716904306),new i(2361852424,442776044),new i(2428436474,593698344),new i(2756734187,3733110249),new i(3204031479,2999351573),new i(3329325298,3815920427),new i(3391569614,3928383900),new i(3515267271,566280711),new i(3940187606,3454069534),new i(4118630271,4000239992),new i(116418474,1914138554),new i(174292421,2731055270),new i(289380356,3203993006),new i(460393269,320620315),new i(685471733,587496836),new i(852142971,1086792851),new i(1017036298,365543100),new i(1126000580,2618297676),new i(1288033470,3409855158),new i(1501505948,4234509866),new i(1607167915,987167468),new i(1816402316,1246189591)],o=new Array(64);function n(e,t){var o=(65535&e.lowOrder)+(65535&t.lowOrder),n=(e.lowOrder>>>16)+(t.lowOrder>>>16)+(o>>>16),r=(65535&n)<<16|65535&o;return o=(65535&e.highOrder)+(65535&t.highOrder)+(n>>>16),new i((65535&(e.highOrder>>>16)+(t.highOrder>>>16)+(o>>>16))<<16|65535&o,r)}function r(e,t){return t<=32?new i(e.highOrder>>>t|e.lowOrder<<32-t,e.lowOrder>>>t|e.highOrder<<32-t):new i(e.lowOrder>>>t|e.highOrder<<32-t,e.highOrder>>>t|e.lowOrder<<32-t)}function s(e,t){return t<=32?new i(e.highOrder>>>t,e.lowOrder>>>t|e.highOrder<<32-t):new i(0,e.highOrder<<32-t)}var l=8*(e=unescape(encodeURIComponent(e))).length;(e=function(e){for(var t=[],o=8*e.length,n=0;n<o;n+=8)t[n>>5]|=(255&e.charCodeAt(n/8))<<24-n%32;return t}(e))[l>>5]|=128<<24-l%32,e[31+(128+l>>10<<5)]=l;for(var a,u,c,d,p,h,f,b,m,g,j,v,y,x=0;x<e.length;x+=32){for(var C=t[0],w=t[1],E=t[2],A=t[3],N=t[4],L=t[5],I=t[6],M=t[7],T=0;T<80;T++)o[T]=T<16?new i(e[2*T+x],e[2*T+x+1]):(j=o[T-2],y=v=void 0,v=r(j,19),y=r(j,61),j=s(j,6),v=new i(v.highOrder^y.highOrder^j.highOrder,v.lowOrder^y.lowOrder^j.lowOrder),y=o[T-7],j=o[T-15],g=m=void 0,m=r(j,1),g=r(j,8),j=s(j,7),m=new i(m.highOrder^g.highOrder^j.highOrder,m.lowOrder^g.lowOrder^j.lowOrder),g=o[T-16],b=f=j=void 0,j=(65535&v.lowOrder)+(65535&y.lowOrder)+(65535&m.lowOrder)+(65535&g.lowOrder),f=(v.lowOrder>>>16)+(y.lowOrder>>>16)+(m.lowOrder>>>16)+(g.lowOrder>>>16)+(j>>>16),b=(65535&f)<<16|65535&j,j=(65535&v.highOrder)+(65535&y.highOrder)+(65535&m.highOrder)+(65535&g.highOrder)+(f>>>16),new i((65535&(v.highOrder>>>16)+(y.highOrder>>>16)+(m.highOrder>>>16)+(g.highOrder>>>16)+(j>>>16))<<16|65535&j,b)),f=M,y=v=void 0,v=r(m=N,14),y=r(m,18),m=r(m,41),g=new i(v.highOrder^y.highOrder^m.highOrder,v.lowOrder^y.lowOrder^m.lowOrder),j=L,b=I,h=new i((h=N).highOrder&j.highOrder^~h.highOrder&b.highOrder,h.lowOrder&j.lowOrder^~h.lowOrder&b.lowOrder),a=k[T],u=o[T],p=d=c=void 0,c=(65535&f.lowOrder)+(65535&g.lowOrder)+(65535&h.lowOrder)+(65535&a.lowOrder)+(65535&u.lowOrder),d=(f.lowOrder>>>16)+(g.lowOrder>>>16)+(h.lowOrder>>>16)+(a.lowOrder>>>16)+(u.lowOrder>>>16)+(c>>>16),p=(65535&d)<<16|65535&c,c=(65535&f.highOrder)+(65535&g.highOrder)+(65535&h.highOrder)+(65535&a.highOrder)+(65535&u.highOrder)+(d>>>16),d=new i((65535&(f.highOrder>>>16)+(g.highOrder>>>16)+(h.highOrder>>>16)+(a.highOrder>>>16)+(u.highOrder>>>16)+(c>>>16))<<16|65535&c,p),a=n((a=h=void 0,h=r(u=C,28),a=r(u,34),u=r(u,39),new i(h.highOrder^a.highOrder^u.highOrder,h.lowOrder^a.lowOrder^u.lowOrder)),(c=w,p=E,new i((h=C).highOrder&c.highOrder^h.highOrder&p.highOrder^c.highOrder&p.highOrder,h.lowOrder&c.lowOrder^h.lowOrder&p.lowOrder^c.lowOrder&p.lowOrder))),M=I,I=L,L=N,N=n(A,d),A=E,E=w,w=C,C=n(d,a);t[0]=n(C,t[0]),t[1]=n(w,t[1]),t[2]=n(E,t[2]),t[3]=n(A,t[3]),t[4]=n(N,t[4]),t[5]=n(L,t[5]),t[6]=n(I,t[6]),t[7]=n(M,t[7])}for(var D=[],x=0;x<t.length;x++)D.push(t[x].highOrder),D.push(t[x].lowOrder);for(var S,R=D,O="0123456789abcdef",H="",B=4*R.length,F=0;F<B;F+=1)S=R[F>>2]>>8*(3-F%4),H+=O.charAt(S>>4&15)+O.charAt(15&S);return H},F.login||(F.login={},F.login.sha512=F.sha512),F.image=F.upload=function(i,e){var t,s={options:{}},o={type:"image",extension:"*",input:!1,minWidth:!1,maxWidth:null,maxHeight:null,maxJpegSizeBytes:null,onchange:null,multiple:!1,remoteParser:null,text:{extensionNotAllowed:"The extension is not allowed"}};for(t in o)e&&e.hasOwnProperty(t)?s.options[t]=e[t]:s.options[t]=o[t];1==s.options.multiple&&i.setAttribute("data-multiple",!0),i.content=[],i.classList.add("jupload"),1==s.options.input&&i.classList.add("input"),s.add=function(e){var t,o;0==s.options.multiple&&(i.content=[],i.innerText=""),"image"==s.options.type?((t=document.createElement("img")).setAttribute("src",e.file),t.setAttribute("tabindex",-1),i.getAttribute("name")||(t.className="jfile",t.content=e),i.appendChild(t)):(t=e.name||e.file,(o=document.createElement("div")).innerText=t||s.options.type,o.classList.add("jupload-item"),o.setAttribute("tabindex",-1),i.appendChild(o)),e.content&&(e.file=F.guid()),i.content.push(e),"function"==typeof s.options.onchange&&s.options.onchange(i,e)},s.addFromFile=function(t){var e;t.type.split("/")[0]==s.options.type?((e=new FileReader).addEventListener("load",function(e){e={file:e.srcElement.result,extension:t.name.substr(t.name.lastIndexOf(".")+1),name:t.name,size:t.size,lastmodified:t.lastModified,content:e.srcElement.result};s.add(e)}),e.readAsDataURL(t)):alert(s.options.text.extensionNotAllowed)},s.addFromUrl=function(e){var t,o;"data"==e.substr(0,4)||s.options.remoteParser?"data"==e.substr(0,4)?(o=(o=e.split(";"))[0].split("/"))[0].replace("data:","")==s.options.type?(t={file:e,name:"",extension:o[1],content:e},s.add(t)):alert(s.options.text.extensionNotAllowed):(o=e.substr(e.lastIndexOf(".")+1),e=s.options.remoteParser+e,F.ajax({url:e,type:"GET",dataType:"blob",success:function(e){}})):console.error("remoteParser not defined in your initialization")};var n=s.options.type+"/"+s.options.extension,r=document.createElement("input"),l=(r.type="file",r.setAttribute("accept",n),r.onchange=function(){for(var e=0;e<this.files.length;e++)s.addFromFile(this.files[e])},1==s.options.multiple&&r.setAttribute("multiple",!0),null);return i.addEventListener("click",function(e){l=null,i.children.length&&e.target!==i?e.target.parentNode==i&&(l=e.target):F.click(r)}),i.addEventListener("dblclick",function(e){F.click(r)}),i.addEventListener("dragenter",function(e){i.style.border="1px dashed #000"}),i.addEventListener("dragleave",function(e){i.style.border="1px solid #eee"}),i.addEventListener("dragstop",function(e){i.style.border="1px solid #eee"}),i.addEventListener("dragover",function(e){e.preventDefault()}),i.addEventListener("keydown",function(e){l&&46==e.which&&0<=(e=Array.prototype.indexOf.call(i.children,l))&&(i.content.splice(e,1),l.remove(),l=null)}),i.addEventListener("drop",function(e){e.preventDefault(),e.stopPropagation();var t=(e.originalEvent||e).dataTransfer.getData("text/html");if((e.originalEvent||e).dataTransfer.files.length)for(var o=0;o<e.dataTransfer.files.length;o++)s.addFromFile(e.dataTransfer.files[o]);else if(t){0==s.options.multiple&&(i.innerText="");var n=document.createElement("div"),r=(n.innerHTML=t,n.querySelectorAll("img"));if(r.length)for(o=0;o<r.length;o++)s.addFromUrl(r[o].src)}return!(i.style.border="1px solid #eee")}),i.val=function(e){if(void 0===e)return i.content&&i.content.length?i.content:null;if(i.innerText="",i.content=[],e)if(Array.isArray(e))for(var t=0;t<e.length;t++)"string"==typeof e[t]?s.add({file:e[t]}):s.add(e[t]);else"string"==typeof e&&s.add({file:e})},i.upload=i.image=s},F.image.create=function(e){var t=document.createElement("img");return t.setAttribute("src",e.file),t.className="jfile",t.setAttribute("tabindex",-1),t.content=e,t},F.lazyLoading=function(n,r){function t(e){var t,o;null==i&&(t=!1,o=n.scrollTop,n.scrollTop+2*n.clientHeight>=n.scrollHeight?r.loadDown()&&(o==n.scrollTop&&(n.scrollTop=n.scrollTop-n.clientHeight),t=!0):n.scrollTop<=n.clientHeight&&r.loadUp()&&(o==n.scrollTop&&(n.scrollTop=n.scrollTop+n.clientHeight),t=!0),i=setTimeout(function(){i=null},r.timer),t&&"function"==typeof r.onupdate&&r.onupdate())}r.loadUp&&"function"==typeof r.loadUp||(r.loadUp=function(){return!1}),r.loadDown&&"function"==typeof r.loadDown||(r.loadDown=function(){return!1}),r.timer||(r.timer=100);var i=null;return n.onscroll=function(e){t()},n.onwheel=function(e){t()},{}},F.loading=(t=null,(e={}).show=function(){t||((t=document.createElement("div")).className="jloading"),document.body.appendChild(t)},e.hide=function(){t&&t.parentNode&&document.body.removeChild(t)},e),F.mask=(s={currency:["#(.{1})##0?(.{1}0+)?( ?;(.*)?)?","#"],percentage:["0{1}(.{1}0+)?%"],numeric:["0{1}(.{1}0+)?"],datetime:["YYYY","YYY","YY","MMMMM","MMMM","MMM","MM","DDDDD","DDDD","DDD","DD","DY","DAY","WD","D","Q","HH24","HH12","HH","\\[H\\]","H","AM/PM","PM","AM","MI","SS","MS","MONTH","MON","Y","M"],general:["A","0","[0-9a-zA-Z$]+","."]},d=function(e){return"currency"===e||"percentage"===e||"numeric"===e},p=function(e){return e&&Number(e)==e?".":this.options.decimal||(this.locale?(t=Intl.NumberFormat(this.locale).format(1.1),this.options.decimal=t[1]):(e=e||this.mask,(t=new RegExp("0{1}(.{1})0+","ig").exec(e))&&t[1]&&1==t[1].length?(this.options.decimal=t[1],t[1]):((t=new RegExp("#{1}(.{1})#+","ig").exec(e))&&t[1]&&1==t[1].length?","===t[1]?this.options.decimal=".":this.options.decimal=",":this.options.decimal="1.1".toLocaleString().substring(1,2),this.options.decimal||null)));var t},a=function(e,t){return""==e?"":(t=t||p.call(this),(e=(""+e).split(t))[0]=e[0].match(/[\-0-9]+/g,""),e[0]&&(e[0]=e[0].join("")),e[0]||e[1]?(void 0!==e[1]&&(e[1]=e[1].match(/[0-9]+/g,""),e[1]?e[1]=e[1].join(""):e[1]=""),e):"")},h=function(e){if(""==e)return"";var t=p.call(this),o=this.options;if(""==(e=a.call(this,e)))return"";"-"===e[0]&&(e[0]="-0"),e[0]?(n=parseFloat(e[0]+".1"),"percent"==o.style&&(n/=100)):n=null;var n,o=new Intl.NumberFormat(this.locale,o).format(n);return void 0!==(o=o.split(t))[1]&&(n=o[1].replace(/[0-9]*/g,""))&&(o[2]=n),void 0!==e[1]?o[1]=t+e[1]:o[1]="",o.join("")},f=function(e,t){var o;if(void 0===e)return"DIV"==this.tagName?(o=0,(n=window.getSelection())&&0!==n.rangeCount&&((s=(r=n.getRangeAt(0)).cloneRange()).selectNodeContents(this),s.setEnd(r.endContainer,r.endOffset),o=s.toString().length),o):this.selectionStart;var n,r,i=b.call(this);if(t){for(var s=null,l=0;l<i.length;l++)!i[l].match(/[\-0-9]/g)&&"."!=i[l]&&","!=i[l]||(s=l);(s=null===s?i.indexOf(" "):s)<=e&&(e=s+1)}(e=e>i.length?i.length:e)&&("DIV"==this.tagName?(n=window.getSelection(),r=document.createRange(),this.childNodes[0]&&(r.setStart(this.childNodes[0],e),n.removeAllRanges(),n.addRange(r))):(this.selectionStart=e,this.selectionEnd=e))},b=function(e,t,o){if("DIV"==this.tagName){if(void 0===e)return this.innerText;this.innerText!==e&&(this.innerText=e,t&&f.call(this,t,o))}else{if(void 0===e)return this.value;this.value!==e&&(this.value=e,t&&f.call(this,t,o))}},o=F.calendar.weekdays,r=F.calendar.weekdaysShort,i=F.calendar.months,l=F.calendar.monthsShort,c={YEAR:function(e,t){var o=""+(new Date).getFullYear();void 0===this.values[this.index]&&(this.values[this.index]=""),0<=parseInt(e)&&parseInt(e)<=10&&this.values[this.index].length<t&&(this.values[this.index]+=e),this.values[this.index].length==t&&(2==t?o=o.substr(0,2)+this.values[this.index]:3==t?o=o.substr(0,1)+this.values[this.index]:4==t&&(o=this.values[this.index]),this.date[0]=o,this.index++)},YYYY:function(e){c.YEAR.call(this,e,4)},YYY:function(e){c.YEAR.call(this,e,3)},YY:function(e){c.YEAR.call(this,e,2)},FIND:function(e,t){N(this.values[this.index])&&(this.values[this.index]="");for(var o=0,n=0,r=(this.values[this.index]+e).toLowerCase(),i=0;i<t.length;i++)0==t[i].toLowerCase().indexOf(r)&&(o=i,n++);if(1<n)this.values[this.index]+=e;else if(1==n)return e=t[o].length-this.values[this.index].length-1,this.position+=e,this.values[this.index]=t[o],this.index++,o},MMM:function(e){e=c.FIND.call(this,e,l);void 0!==e&&(this.date[1]=e+1)},MMMM:function(e){e=c.FIND.call(this,e,i);void 0!==e&&(this.date[1]=e+1)},MMMMM:function(e){N(this.values[this.index])&&(this.values[this.index]="");for(var t=(this.values[this.index]+e).toLowerCase(),o=0;o<i.length;o++)if(0==i[o][0].toLowerCase().indexOf(t)){this.values[this.index]=i[o][0],this.date[1]=o+1,this.index++;break}},MM:function(e){N(this.values[this.index])?1<parseInt(e)&&parseInt(e)<10?(this.date[1]=this.values[this.index]="0"+e,this.index++):parseInt(e)<2&&(this.values[this.index]=e):(1==this.values[this.index]&&parseInt(e)<3||0==this.values[this.index]&&0<parseInt(e)&&parseInt(e)<10)&&(this.date[1]=this.values[this.index]+=e,this.index++)},M:function(e){var t=!1;0<=parseInt(e)&&parseInt(e)<10?N(this.values[this.index])?1<(this.values[this.index]=e)&&(this.date[1]=this.values[this.index],this.index++):1==this.values[this.index]&&parseInt(e)<3||0==this.values[this.index]&&0<parseInt(e)?(this.date[1]=this.values[this.index]+=e,this.index++):t=!0:t=!0,1==t&&0<(e=parseInt(this.values[this.index]))&&e<12&&(this.date[2]=this.values[this.index],this.index++,this.position--)},D:function(e){var t=!1;0<=parseInt(e)&&parseInt(e)<10?N(this.values[this.index])?(this.values[this.index]=e,3<parseInt(e)&&(this.date[2]=this.values[this.index],this.index++)):3==this.values[this.index]&&parseInt(e)<2||1==this.values[this.index]||2==this.values[this.index]||0==this.values[this.index]&&0<parseInt(e)?(this.date[2]=this.values[this.index]+=e,this.index++):t=!0:t=!0,1==t&&0<(e=parseInt(this.values[this.index]))&&e<32&&(this.date[2]=this.values[this.index],this.index++,this.position--)},DD:function(e){N(this.values[this.index])?3<parseInt(e)&&parseInt(e)<10?(this.date[2]=this.values[this.index]="0"+e,this.index++):parseInt(e)<10&&(this.values[this.index]=e):(3==this.values[this.index]&&parseInt(e)<2||(1==this.values[this.index]||2==this.values[this.index])&&parseInt(e)<10||0==this.values[this.index]&&0<parseInt(e)&&parseInt(e)<10)&&(this.date[2]=this.values[this.index]+=e,this.index++)},DDD:function(e){c.FIND.call(this,e,r)},DDDD:function(e){c.FIND.call(this,e,o)},HH12:function(e,t){N(this.values[this.index])?1<parseInt(e)&&parseInt(e)<10?(this.date[3]=this.values[this.index]=e=t?0+e:e,this.index++):parseInt(e)<10&&(this.values[this.index]=e):(1==this.values[this.index]&&parseInt(e)<3||this.values[this.index]<1&&parseInt(e)<10)&&(this.date[3]=this.values[this.index]+=e,this.index++)},HH24:function(e,t){0<=parseInt(e)&&parseInt(e)<10&&(null==this.values[this.index]||""==this.values[this.index]?2<parseInt(e)&&parseInt(e)<10?(this.date[3]=this.values[this.index]=e=t?0+e:e,this.index++):parseInt(e)<10&&(this.values[this.index]=e):(2==this.values[this.index]&&parseInt(e)<4||this.values[this.index]<2&&parseInt(e)<10)&&(this.date[3]=this.values[this.index]+=e,this.index++))},HH:function(e){c.HH24.call(this,e,1)},H:function(e){c.HH24.call(this,e,0)},"\\[H\\]":function(e){null==this.values[this.index]&&(this.values[this.index]=""),e.match(/[0-9]/g)?this.date[3]=this.values[this.index]+=e:this.values[this.index].match(/[0-9]/g)&&(this.date[3]=this.values[this.index],this.index++,this.position--)},N60:function(e,t){null==this.values[this.index]||""==this.values[this.index]?5<parseInt(e)&&parseInt(e)<10?(this.date[t]=this.values[this.index]="0"+e,this.index++):parseInt(e)<10&&(this.values[this.index]=e):parseInt(e)<10&&(this.date[t]=this.values[this.index]+=e,this.index++)},MI:function(e){c.N60.call(this,e,4)},SS:function(e){c.N60.call(this,e,5)},"AM/PM":function(e){this.values[this.index]="",e&&(12<this.date[3]?this.values[this.index]="PM":this.values[this.index]="AM"),this.index++},WD:function(e){void 0===this.values[this.index]&&(this.values[this.index]=""),0<=parseInt(e)&&parseInt(e)<7&&(this.values[this.index]=e),1==this.value[this.index].length&&this.index++},"0{1}(.{1}0+)?":function(e){var t=p.call(this),o=!1,n=(N(this.values[this.index])?this.values[this.index]="":"-"==this.values[this.index]&&(o=!0),a.call(this,this.values[this.index],t));n&&(this.values[this.index]=n.join(t)),0<=parseInt(e)&&parseInt(e)<10?("0"==this.values[this.index]&&0<e?this.values[this.index]="":"-0"==this.values[this.index]&&0<e&&(this.values[this.index]="-"),("0"!=this.values[this.index]&&"-0"!=this.values[this.index]||e==t)&&(this.values[this.index]+=e)):t&&e==t?-1==this.values[this.index].indexOf(t)&&(this.values[this.index]||(this.values[this.index]="0"),this.values[this.index]+=e):"-"==e&&(o=!0),!0===o&&"-"!==this.values[this.index][0]&&(this.values[this.index]="-"+this.values[this.index])},"0{1}(.{1}0+)?%":function(e){c["0{1}(.{1}0+)?"].call(this,e),this.values[this.index].match(/[\-0-9]/g)?this.values[this.index]&&-1==this.values[this.index].indexOf("%")&&(this.values[this.index]+="%"):this.values[this.index]=""},"#(.{1})##0?(.{1}0+)?( ?;(.*)?)?":function(e){c["0{1}(.{1}0+)?"].call(this,e);var e=p.call(this),t=this.tokens[this.index].substr(1,1),o="-"===this.values[this.index][0],n=a.call(this,this.values[this.index],e);if(""!==n){if(r=n[0].match(/[0-9]/g)){for(var r,i=[],s=0,l=(r=r.join("")).length-1;0<=l;l--)i.push(r[l]),++s%3||i.push(t);i=i.reverse(),n[0]=i.join(""),n[0].substr(0,1)==t&&(n[0]=n[0].substr(1))}else n[0]="";this.values[this.index]=n.join(e),o&&(this.values[this.index]="-"+this.values[this.index])}},0:function(e){e.match(/[0-9]/g)&&(this.values[this.index]=e,this.index++)},"[0-9a-zA-Z$]+":function(e){N(this.values[this.index])&&(this.values[this.index]="");var t=this.tokens[this.index];t[this.values[this.index].length]==e?(this.values[this.index]+=e,this.values[this.index]==t&&this.index++):(this.values[this.index]=t,this.index++,e.match(/[\-0-9]/g)&&this.position--)},A:function(e){e.match(/[a-zA-Z]/gi)&&(this.values[this.index]=e,this.index++)},".":function(e){c["[0-9a-zA-Z$]+"].call(this,e)}},m=function(e){t="general"==this.type?[].concat(s.general):[].concat(s.currency,s.datetime,s.percentage,s.numeric,s.general);var t=new RegExp(t.join("|"),"gi");return e.match(t)},g=function(e){var t;t=this.type?"general"==this.type?["general"]:"datetime"==this.type?["numeric","datetime","general"]:["currency","percentage","numeric","general"]:Object.keys(s);for(var o=0;o<t.length;o++)for(var n=t[o],r=0;r<s[n].length;r++){var i=new RegExp(s[n][r],"gi");if(e.match(i))return{type:n,method:s[n][r]}}},T.prepare=function(e,t){return m.call(t=t||{},e)},T.apply=function(e){var t=b.call(e.target);1==e.key.length&&(t+=e.key),b.call(e.target,T(t,e.target.getAttribute("data-mask")))},T.run=function(e,t,o){return T(e,{mask:t,decimal:o})},T.extract=function(e,t,o){if(N(e))return e;if("object"!=typeof t)return r;t.options||(t.options={}),!t.mask&&t.format&&(t.mask=t.format),p.call(t,t.mask);var n,r,i,s=null;return"percent"==t.type||"percent"==t.options.style?s="percentage":t.mask&&(s=I.call(t,t.mask)),"general"===s?(i=T(e,t,!0),r=e):"datetime"===s?(e instanceof Date&&(n=F.calendar.getDateString(r,t.mask)),i=T(e,t,!0),r=F.isNumeric(e)?e:(r=A.call(i),n=F.calendar.now(i.date),F.calendar.dateToNum(n))):(r=L.call(t,e),"percentage"==s&&(r/=100),i=t),i.value=r,!i.type&&s&&(i.type=s),o?i:r},T.render=function(e,t,o){if(N(e))return e;if("object"!=typeof t)return e;t.options||(t.options={}),!t.mask&&t.format&&(t.mask=t.format);var n=null,r=("percent"==t.type||"percent"==t.options.style?n="percentage":t.mask?n=I.call(t,t.mask):e instanceof Date&&(n="datetime"),!1);if("datetime"==n||"calendar"==t.type)(i=F.calendar.getDateString(e,t.mask))&&(e=i),t.mask&&o&&(r=!0);else if("percentage"==n&&(e*=100),"number"==typeof e){var i=null;if(t.mask&&o){n=new RegExp("0{1}(.{1})0+","ig");i=(s=t.mask.match(n))&&s[0]?(s=s[0].length-2,e.toFixed(s)):e.toFixed(0)}else if(t.locale&&o){var s=(""+e).split(".");if(t.options){void 0===s[1]&&(s[1]="");var l=s[1].length;if(t.options.minimumFractionDigits>l)for(var a=0;a<t.options.minimumFractionDigits-l;a++)s[1]+="0"}i=s[1].length?s.join("."):s[0];l=s[1].length;t.options&&t.options.maximumFractionDigits<l&&(i=parseFloat(i).toFixed(t.options.maximumFractionDigits))}else i=(""+ +e).replace(/(-?)(\d*)\.?(\d*)e([+-]\d+)/,function(e,t,o,n,r){return r<0?t+"0."+Array(1-r-o.length).join(0)+o+n:t+o+n+Array(r-n.length+1).join(0)});null!==i&&(e=i,p.call(t,t.mask),t.options.decimal&&(e=e.replace(".",t.options.decimal)))}else t.mask&&o&&(r=!0);if(r){var u=t.mask.length-e.length;if(0<u)for(a=0;a<u;a++)e+=" "}return e=T(e,t)},T.set=function(e,t){t&&(e.setAttribute("data-mask",t),t=new Event("input",{bubbles:!0,cancelable:!0}),e.dispatchEvent(t))},"undefined"!=typeof document&&document.addEventListener("input",function(e){(e.target.getAttribute("data-mask")||e.target.mask)&&T(e)}),T),F.modal=function(t,e){var o,n={options:{}},r={url:null,onopen:null,onclose:null,closed:!1,width:null,height:null,title:null,padding:null,backdrop:!0};for(o in r)e&&e.hasOwnProperty(o)?n.options[o]=e[o]:n.options[o]=r[o];!n.options.title&&t.getAttribute("title")&&(n.options.title=t.getAttribute("title"));for(var i,s,l=document.createElement("div");t.children[0];)l.appendChild(t.children[0]);for(n.content=document.createElement("div"),n.content.className="jmodal_content",n.content.innerHTML=t.innerHTML;l.children[0];)n.content.appendChild(l.children[0]);return n.container=document.createElement("div"),n.container.className="jmodal",n.container.appendChild(n.content),n.options.padding&&(n.content.style.padding=n.options.padding),n.options.width&&(n.container.style.width=n.options.width),n.options.height&&(n.container.style.height=n.options.height),n.options.title?n.container.setAttribute("title",n.options.title):n.container.classList.add("no-title"),t.innerHTML="",t.style.display="none",t.appendChild(n.container),n.options.backdrop&&((i=document.createElement("div")).className="jmodal_backdrop",i.onclick=function(){n.close()},t.appendChild(i)),n.open=function(){t.style.display="block";var e=n.container.getBoundingClientRect();F.getWindowWidth()<e.width?(n.container.style.top="",n.container.style.left="",n.container.classList.add("jmodal_fullscreen"),F.animation.slideBottom(n.container,1)):n.options.backdrop&&(i.style.display="block"),"function"==typeof n.options.onopen&&n.options.onopen(t,n)},n.resetPosition=function(){n.container.style.top="",n.container.style.left=""},n.isOpen=function(){return"none"!=t.style.display},n.close=function(){n.isOpen()&&(t.style.display="none",n.options.backdrop&&(i.style.display=""),n.container.classList.remove("jmodal_fullscreen"),"function"==typeof n.options.onclose&&n.options.onclose(t,n))},F.modal.hasEvents||(s=null,document.addEventListener("keydown",function(e){if(27==e.which)for(var t=document.querySelectorAll(".jmodal"),o=0;o<t.length;o++)t[o].parentNode.modal.close()}),document.addEventListener("mouseup",function(e){var t,o,n=F.findElement(e.target,"jmodal");n&&(t=n.getBoundingClientRect(),e=e.changedTouches&&e.changedTouches[0]?(o=e.changedTouches[0].clientX,e.changedTouches[0].clientY):(o=e.clientX,e.clientY),t.width-(o-t.left)<50&&e-t.top<50&&n.parentNode.modal.close()),s&&(s.element.style.cursor="auto",s=null)}),document.addEventListener("mousedown",function(e){var t,o,n,r=F.findElement(e.target,"jmodal");r&&(t=r.getBoundingClientRect(),n=e.changedTouches&&e.changedTouches[0]?(o=e.changedTouches[0].clientX,e.changedTouches[0].clientY):(o=e.clientX,e.clientY),t.width-(o-t.left)<50&&n-t.top<50||e.target.getAttribute("title")&&n-t.top<50&&(document.selection?document.selection.empty():window.getSelection&&window.getSelection().removeAllRanges(),s={left:t.left,top:t.top,x:e.clientX,y:e.clientY,width:t.width,height:t.height,element:r}))}),document.addEventListener("mousemove",function(e){s&&((e=e||window.event).buttons||e.button||e.which?(s.element.style.top=s.top+(e.clientY-s.y)+s.height/2+"px",s.element.style.left=s.left+(e.clientX-s.x)+s.width/2+"px",s.element.style.cursor="move"):s.element.style.cursor="auto")}),F.modal.hasEvents=!0),n.options.url?F.ajax({url:n.options.url,method:"GET",dataType:"text/html",success:function(e){n.content.innerHTML=e,n.options.closed||n.open()}}):n.options.closed||n.open(),t.modal=n},F.notification=function(e){var t,o={options:{}},n={icon:null,name:"Notification",date:null,error:null,title:null,message:null,timeout:4e3,autoHide:!0,closeable:!0};for(t in n)e&&e.hasOwnProperty(t)?o.options[t]=e[t]:o.options[t]=n[t];var r,i=document.createElement("div"),s=(i.className="jnotification",o.options.error&&i.classList.add("jnotification-error"),document.createElement("div")),l=(s.className="jnotification-container",i.appendChild(s),document.createElement("div")),a=(l.className="jnotification-header",s.appendChild(l),document.createElement("div")),a=(a.className="jnotification-image",l.appendChild(a),o.options.icon&&((u=document.createElement("img")).src=o.options.icon,a.appendChild(u)),document.createElement("div")),a=(a.className="jnotification-name",a.innerHTML=o.options.name,l.appendChild(a),1==o.options.closeable&&((u=document.createElement("div")).className="jnotification-close",u.onclick=function(){o.hide()},l.appendChild(u)),document.createElement("div")),u=(a.className="jnotification-date",l.appendChild(a),document.createElement("div")),a=(u.className="jnotification-content",s.appendChild(u),o.options.title&&((l=document.createElement("div")).className="jnotification-title",l.innerHTML=o.options.title,u.appendChild(l)),document.createElement("div"));return a.className="jnotification-message",a.innerHTML=o.options.message,u.appendChild(a),o.show=function(){document.body.appendChild(i),800<F.getWindowWidth()?F.animation.fadeIn(i):F.animation.slideTop(i,1)},o.hide=function(){800<F.getWindowWidth()?F.animation.fadeOut(i,function(){i.parentNode&&(i.parentNode.removeChild(i),r&&clearTimeout(r))}):F.animation.slideTop(i,0,function(){i.parentNode&&(i.parentNode.removeChild(i),r&&clearTimeout(r))})},o.show(),1==o.options.autoHide&&(r=setTimeout(function(){o.hide()},o.options.timeout)),F.getWindowWidth()<800&&i.addEventListener("swipeup",function(e){o.hide(),e.preventDefault(),e.stopPropagation()}),o},F.notification.isVisible=function(){var e=document.querySelector(".jnotification");return!(!e||!e.parentNode)},F.palette=(j={material:[["#ffebee","#fce4ec","#f3e5f5","#e8eaf6","#e3f2fd","#e0f7fa","#e0f2f1","#e8f5e9","#f1f8e9","#f9fbe7","#fffde7","#fff8e1","#fff3e0","#fbe9e7","#efebe9","#fafafa","#eceff1"],["#ffcdd2","#f8bbd0","#e1bee7","#c5cae9","#bbdefb","#b2ebf2","#b2dfdb","#c8e6c9","#dcedc8","#f0f4c3","#fff9c4","#ffecb3","#ffe0b2","#ffccbc","#d7ccc8","#f5f5f5","#cfd8dc"],["#ef9a9a","#f48fb1","#ce93d8","#9fa8da","#90caf9","#80deea","#80cbc4","#a5d6a7","#c5e1a5","#e6ee9c","#fff59d","#ffe082","#ffcc80","#ffab91","#bcaaa4","#eeeeee","#b0bec5"],["#e57373","#f06292","#ba68c8","#7986cb","#64b5f6","#4dd0e1","#4db6ac","#81c784","#aed581","#dce775","#fff176","#ffd54f","#ffb74d","#ff8a65","#a1887f","#e0e0e0","#90a4ae"],["#ef5350","#ec407a","#ab47bc","#5c6bc0","#42a5f5","#26c6da","#26a69a","#66bb6a","#9ccc65","#d4e157","#ffee58","#ffca28","#ffa726","#ff7043","#8d6e63","#bdbdbd","#78909c"],["#f44336","#e91e63","#9c27b0","#3f51b5","#2196f3","#00bcd4","#009688","#4caf50","#8bc34a","#cddc39","#ffeb3b","#ffc107","#ff9800","#ff5722","#795548","#9e9e9e","#607d8b"],["#e53935","#d81b60","#8e24aa","#3949ab","#1e88e5","#00acc1","#00897b","#43a047","#7cb342","#c0ca33","#fdd835","#ffb300","#fb8c00","#f4511e","#6d4c41","#757575","#546e7a"],["#d32f2f","#c2185b","#7b1fa2","#303f9f","#1976d2","#0097a7","#00796b","#388e3c","#689f38","#afb42b","#fbc02d","#ffa000","#f57c00","#e64a19","#5d4037","#616161","#455a64"],["#c62828","#ad1457","#6a1b9a","#283593","#1565c0","#00838f","#00695c","#2e7d32","#558b2f","#9e9d24","#f9a825","#ff8f00","#ef6c00","#d84315","#4e342e","#424242","#37474f"],["#b71c1c","#880e4f","#4a148c","#1a237e","#0d47a1","#006064","#004d40","#1b5e20","#33691e","#827717","#f57f17","#ff6f00","#e65100","#bf360c","#3e2723","#212121","#263238"]],fire:[["0b1a6d","840f38","b60718","de030b","ff0c0c","fd491c","fc7521","faa331","fbb535","ffc73a"],["071147","5f0b28","930513","be0309","ef0000","fa3403","fb670b","f9991b","faad1e","ffc123"],["03071e","370617","6a040f","9d0208","d00000","dc2f02","e85d04","f48c06","faa307","ffba08"],["020619","320615","61040d","8c0207","bc0000","c82a02","d05203","db7f06","e19405","efab00"],["020515","2d0513","58040c","7f0206","aa0000","b62602","b94903","c57205","ca8504","d89b00"]],baby:[["eddcd2","fff1e6","fde2e4","fad2e1","c5dedd","dbe7e4","f0efeb","d6e2e9","bcd4e6","99c1de"],["e1c4b3","ffd5b5","fab6ba","f5a8c4","aacecd","bfd5cf","dbd9d0","baceda","9dc0db","7eb1d5"],["daa990","ffb787","f88e95","f282a9","8fc4c3","a3c8be","cec9b3","9dbcce","82acd2","649dcb"],["d69070","ff9c5e","f66770","f05f8f","74bbb9","87bfae","c5b993","83aac3","699bca","4d89c2"],["c97d5d","f58443","eb4d57","e54a7b","66a9a7","78ae9c","b5a67e","7599b1","5c88b7","4978aa"]],chart:[["#C1D37F","#4C5454","#FFD275","#66586F","#D05D5B","#C96480","#95BF8F","#6EA240","#0F0F0E","#EB8258","#95A3B3","#995D81"]]},D.get=function(e){return j[e]||j},D.set=function(e,t){j[e]=t},D),F.picker=function(r,e){if(r.picker)return r.picker.setOptions(e,!0);var l={type:"picker",options:{}},a=null,u=null;l.setOptions=function(e,t){var o,n={value:0,data:null,render:null,onchange:null,onselect:null,onopen:null,onclose:null,onload:null,width:null,header:!0,right:!1,content:!1,columns:null,height:null};for(o in e&&e.options&&(e.data=e.options),n)e&&e.hasOwnProperty(o)?l.options[o]=e[o]:void 0!==l.options[o]&&!0!==t||(l.options[o]=n[o]);!1===l.options.header?a.style.display="none":a.style.display="",l.options.width?a.style.width=parseInt(l.options.width)+"px":a.style.width="",l.options.height?(u.style.maxHeight=l.options.height+"px",u.style.overflow="scroll"):u.style.overflow="",0<l.options.columns&&(u.classList.add("jpicker-columns"),u.style.width=l.options.width||36*l.options.columns+"px"),isNaN(l.options.value)&&(l.options.value="0"),u.innerHTML="";for(var r=Object.keys(l.options.data),i=0;i<r.length;i++){var s=document.createElement("div");s.classList.add("jpicker-item"),s.k=r[i],s.v=l.options.data[r[i]],s.innerHTML=l.getLabel(r[i]),u.appendChild(s)}return l.setValue(l.options.value),l},l.getValue=function(){return l.options.value},l.setValue=function(e){l.setLabel(e),l.options.value=String(e),r.value!=l.options.value&&(r.value=l.options.value,"function"==typeof r.oninput&&r.oninput({type:"input",target:r,value:r.value})),"generic"!==u.children[e].getAttribute("type")&&l.close()},l.getLabel=function(e){e=l.options.data[e]||null;return e="function"==typeof l.options.render?l.options.render(e):e},l.setLabel=function(e){e=l.options.content?'<i class="material-icons">'+l.options.content+"</i>":l.getLabel(e),a.innerHTML=e},l.open=function(){var e,t,o,n;r.classList.contains("jpicker-focus")||(F.tracking(l,!0),r.classList.add("jpicker-focus"),r.focus(),e=n=0,u.style.marginLeft="",t=a.getBoundingClientRect(),o=u.getBoundingClientRect(),n=window.innerHeight<t.bottom+o.height?-1*(o.height+4):t.height+4,!0===l.options.right&&(e=-1*o.width+t.width),o.left+e<0&&(e=e+o.left+10),o.left+o.width>window.innerWidth&&(e=-1*(10+o.left+o.width-window.innerWidth)),u.style.marginTop=parseInt(n)+"px",u.style.marginLeft=parseInt(e)+"px","function"==typeof l.options.onopen&&l.options.onopen(r,l))},l.close=function(){r.classList.contains("jpicker-focus")&&(r.classList.remove("jpicker-focus"),F.tracking(l,!1),"function"==typeof l.options.onclose&&l.options.onclose(r,l))};return r.classList.add("jpicker"),r.setAttribute("tabindex","900"),r.onmousedown=function(e){r.classList.contains("jpicker-focus")||l.open()},(a=document.createElement("div")).classList.add("jpicker-header"),(u=document.createElement("div")).classList.add("jpicker-content"),u.onclick=function(e){var t=F.findElement(e.target,"jpicker-item");t&&t.parentNode===u&&(l.setValue(t.k),"function"==typeof l.options.onchange&&l.options.onchange.call(l,r,l,t.v,t.v,t.k,e))},r.appendChild(a),r.appendChild(u),r.value=e.value||0,l.setOptions(e),"function"==typeof l.options.onload&&l.options.onload(r,l),r.change=l.setValue,r.val=function(e){if(void 0===e)return l.getValue();l.setValue(e)},r.picker=l},F.progressbar=function(n,e){var t,r={options:{}},o={value:0,onchange:null,width:null};for(t in o)e&&e.hasOwnProperty(t)?r.options[t]=e[t]:r.options[t]=o[t];n.classList.add("jprogressbar"),n.setAttribute("tabindex",1),n.setAttribute("data-value",r.options.value);function i(e){var t,o;e.which&&(t=n.getBoundingClientRect(),e.changedTouches&&e.changedTouches[0]?(o=e.changedTouches[0].clientX,e.changedTouches[0].clientY):(o=e.clientX,e.clientY),r.setValue(Math.round((o-t.left)/t.width*100)))}var s=document.createElement("div");s.style.width=r.options.value+"%",s.style.color="#fff",n.appendChild(s),r.options.width&&(n.style.width=r.options.width),r.setValue=function(e){e=parseInt(e),r.options.value=e,s.style.width=e+"%",n.setAttribute("data-value",e+"%"),n.style.color=e<6?"#000":"#fff",r.options.value=e,"function"==typeof r.options.onchange&&r.options.onchange(n,e),n.value!=r.options.value&&(n.value=r.options.value,"function"==typeof n.oninput&&n.oninput({type:"input",target:n,value:n.value}))},r.getValue=function(){return r.options.value};return"touchstart"in document.documentElement==!0?(n.addEventListener("touchstart",i),n.addEventListener("touchend",i)):(n.addEventListener("mousedown",i),n.addEventListener("mousemove",i)),n.change=r.setValue,n.val=function(e){if(void 0===e)return r.getValue();r.setValue(e)},n.progressbar=r},F.rating=function(s,e){if(s.rating)return s.rating.setOptions(e,!0);var l={options:{},setOptions:function(e,t){var o,n={number:5,value:0,tooltip:["Very bad","Bad","Average","Good","Very good"],onchange:null};for(o in n)e&&e.hasOwnProperty(o)?l.options[o]=e[o]:void 0!==l.options[o]&&!0!==t||(l.options[o]=n[o]);s.innerHTML="";for(var r=0;r<l.options.number;r++){var i=document.createElement("div");i.setAttribute("data-index",r+1),i.setAttribute("title",l.options.tooltip[r]),s.appendChild(i)}if(l.options.value)for(r=0;r<l.options.number;r++)r<l.options.value&&s.children[r].classList.add("jrating-selected");return l},setValue:function(e){for(var t=0;t<l.options.number;t++)t<e?s.children[t].classList.add("jrating-selected"):(s.children[t].classList.remove("jrating-over"),s.children[t].classList.remove("jrating-selected"));l.options.value=e,"function"==typeof l.options.onchange&&l.options.onchange(s,e),s.value!=l.options.value&&(s.value=l.options.value,"function"==typeof s.oninput&&s.oninput({type:"input",target:s,value:s.value}))},getValue:function(){return l.options.value}};return l.setOptions(e),s.classList.add("jrating"),s.addEventListener("click",function(e){e=e.target.getAttribute("data-index");null!=e&&(e==l.options.value?l.setValue(0):l.setValue(e))}),s.addEventListener("mouseover",function(e){for(var t=e.target.getAttribute("data-index"),o=0;o<l.options.number;o++)o<t?s.children[o].classList.add("jrating-over"):s.children[o].classList.remove("jrating-over")}),s.addEventListener("mouseout",function(e){for(var t=0;t<l.options.number;t++)s.children[t].classList.remove("jrating-over")}),s.change=l.setValue,s.val=function(e){if(void 0===e)return l.getValue();l.setValue(e)},s.rating=l},F.search=function(l,e){if(l.search)return l.search;function t(n){var e;n!=a.terms&&(a.terms=n,o=a.options.forceSelect?0:null,Array.isArray(a.options.data)?(e=a.options.data.filter(function(e){var t=e;if("string"==typeof t){if(0<=(""+t).toLowerCase().search(n.toLowerCase()))return!0}else for(var o in t)if(0<=(""+t[o]).toLowerCase().search(n.toLowerCase()))return!0;return!1}),r(e)):F.ajax({url:a.options.data+n,method:"GET",dataType:"json",success:function(e){r(e)}}))}var o=null,r=function(e){if(u.innerHTML="",e.length){l.style.display="block";for(var t=e.length<11?e.length:10,o=0;o<t;o++){"string"==typeof e[o]?(n=e[o],r=e[o]):(!(n=e[o].text)&&e[o].name&&(n=e[o].name),!(r=e[o].value)&&e[o].id&&(r=e[o].id));var n,r,i=document.createElement("div"),s=(i.setAttribute("data-value",r),i.setAttribute("data-text",n),i.className="jsearch_item",e[o].id&&i.setAttribute("id",e[o].id),a.options.forceSelect&&0==o&&i.classList.add("selected"),document.createElement("img")),s=(e[o].image?s.src=e[o].image:s.style.display="none",i.appendChild(s),document.createElement("div"));s.innerHTML=n,i.appendChild(s),u.appendChild(i)}}else l.style.display=""},n=null,a=function(e){n&&clearTimeout(n),n=setTimeout(function(){t(e)},500)},u=(null===e.forceSelect&&(e.forceSelect=!0),a.options={data:e.data||null,input:e.input||null,searchByNode:e.searchByNode||null,onselect:e.onselect||null,forceSelect:e.forceSelect,onbeforesearch:e.onbeforesearch||null},a.selectIndex=function(e){var t=e.getAttribute("id"),o=e.getAttribute("data-text"),e=e.getAttribute("data-value");"function"==typeof a.options.onselect&&a.options.onselect(a,o,e,t),a.close()},a.open=function(){l.style.display="block"},a.close=function(){n&&clearTimeout(n),a.terms="",u.innerHTML="",l.style.display=""},a.isOpened=function(){return!!l.style.display},a.keydown=function(e){a.isOpened()&&("Enter"==e.key?null!==o&&u.children[o]?(a.selectIndex(u.children[o]),e.preventDefault()):a.close():"ArrowUp"===e.key?(null!==o&&u.children[0]&&(u.children[o].classList.remove("selected"),a.options.forceSelect||0!==o?(o=Math.max(0,o-1),u.children[o].classList.add("selected")):o=null),e.preventDefault()):"ArrowDown"===e.key&&(null==o?o=-1:u.children[o].classList.remove("selected"),o<9&&u.children[o+1]&&o++,u.children[o].classList.add("selected"),e.preventDefault()))},a.keyup=function(e){var t;if(a.options.searchByNode?(o=F.getNode())&&(t=o.innerText):t="DIV"===a.options.input.tagName?a.options.input.innerText:a.options.input.value,"function"==typeof a.options.onbeforesearch){var o=a.options.onbeforesearch(a,t);if(o)t=o;else if(!1===o)return}a(t)},a.options.input&&(a.options.input.addEventListener("keyup",a.keyup),a.options.input.addEventListener("keydown",a.keydown)),document.createElement("div"));return u.classList.add("jsearch_container"),u.onmousedown=function(e){var t;t=e.target.classList.contains("jsearch_item")?e.target:e.target.parentNode,a.selectIndex(t),e.preventDefault()},l.appendChild(u),l.classList.add("jsearch"),l.search=a},F.slider=function(n,e){var r={options:{},currentImage:null};if(e&&(r.options=e),n.setAttribute("tabindex","900"),r.options.items=[],!n.classList.contains("jslider")){n.classList.add("jslider"),n.classList.add("unselectable"),r.options.height&&(n.style.minHeight=r.options.height),r.options.width&&(n.style.width=r.options.width),r.options.grid&&(n.classList.add("jslider-grid"),4<(e=n.children.length)&&n.setAttribute("data-total",e-4),n.setAttribute("data-number",4<e?4:e));var i=document.createElement("div");if(i.classList.add("jslider-counter"),0<n.children.length)for(var t=0;t<n.children.length;t++){r.options.items.push(n.children[t]);var o=document.createElement("div");o.onclick=function(){var e=Array.prototype.slice.call(i.children).indexOf(this);r.show(r.currentImage=r.options.items[e])},i.appendChild(o)}var e=document.createElement("div"),s=(e.className="jslider-caption",document.createElement("div")),l=document.createElement("div");l.className="jslider-close",l.innerHTML="",l.onclick=function(){r.close()},s.appendChild(e),s.appendChild(l)}r.updateCounter=function(e){for(var t=0;t<i.children.length;t++)if(i.children[t].classList.contains("jslider-counter-focus")){i.children[t].classList.remove("jslider-counter-focus");break}i.children[e].classList.add("jslider-counter-focus")},r.show=function(e){e=e||n.children[0],n.classList.add("jslider-focus"),n.classList.remove("jslider-grid"),n.appendChild(s),n.appendChild(i);var t=r.options.items.indexOf(e);r.updateCounter(t);for(var o=0;o<n.children.length;o++)n.children[o].style.display="";e.style.display="block",e.previousElementSibling?n.classList.add("jslider-left"):n.classList.remove("jslider-left"),e.nextElementSibling&&"IMG"==e.nextElementSibling.tagName?n.classList.add("jslider-right"):n.classList.remove("jslider-right"),r.currentImage=e,r.currentImage.offsetHeight>r.currentImage.offsetWidth&&r.currentImage.classList.add("jslider-vertical"),s.children[0].innerText=r.currentImage.getAttribute("title")},r.open=function(){r.show(),"function"==typeof r.options.onopen&&r.options.onopen(n)},r.close=function(){n.classList.remove("jslider-focus"),n.classList.remove("jslider-left"),n.classList.remove("jslider-right"),r.options.grid&&n.classList.add("jslider-grid");for(var e=0;e<n.children.length;e++)n.children[e].style.display="";i.remove(),s.remove(),r.currentImage=null,"function"==typeof r.options.onclose&&r.options.onclose(n)},r.reset=function(){n.innerHTML=""},r.next=function(){var e=r.currentImage.nextElementSibling;e&&"IMG"===e.tagName&&r.show(r.currentImage.nextElementSibling)},r.prev=function(){r.currentImage.previousElementSibling&&r.show(r.currentImage.previousElementSibling)};function a(e){var t;"IMG"==e.target.tagName?r.show(e.target):e.target.classList.contains("jslider-close")||e.target.parentNode.classList.contains("jslider-counter")||e.target.classList.contains("jslider-counter")||(t=e.offsetX||e.changedTouches[0].clientX,e.target.clientWidth-t<40?r.next():t<40&&r.prev())}return"ontouchend"in document.documentElement==!0?n.addEventListener("touchend",a):n.addEventListener("mouseup",a),n.addEventListener("swipeleft",function(e){r.next(),e.preventDefault(),e.stopPropagation()}),n.addEventListener("swiperight",function(e){r.prev(),e.preventDefault(),e.stopPropagation()}),n.addEventListener("keydown",function(e){27==e.which&&r.close()}),n.slider=r},F.sorting=function(n,e){var t,o={options:{}},r={pointer:null,direction:null,ondragstart:null,ondragend:null,ondrop:null},i=null;for(t in r)e&&e.hasOwnProperty(t)?o.options[t]=e[t]:o.options[t]=r[t];n.classList.add("jsorting"),n.addEventListener("dragstart",function(e){var t=Array.prototype.indexOf.call(e.target.parentNode.children,e.target);i={element:e.target,o:t,d:t},e.target.style.opacity="0.25","function"==typeof o.options.ondragstart&&o.options.ondragstart(n,e.target,e)}),n.addEventListener("dragover",function(e){e.preventDefault(),s(e.target)&&i&&"true"==e.target.getAttribute("draggable")&&i.element!=e.target&&((o.options.direction?e.target.clientWidth/2>e.offsetX:e.target.clientHeight/2>e.offsetY)?e.target.parentNode.insertBefore(i.element,e.target):e.target.parentNode.insertBefore(i.element,e.target.nextSibling),i.d=Array.prototype.indexOf.call(e.target.parentNode.children,i.element))}),n.addEventListener("dragleave",function(e){e.preventDefault()}),n.addEventListener("dragend",function(e){e.preventDefault(),i&&("function"==typeof o.options.ondragend&&o.options.ondragend(n,i.element,e),i.o<i.d?e.target.parentNode.insertBefore(i.element,e.target.parentNode.children[i.o]):e.target.parentNode.insertBefore(i.element,e.target.parentNode.children[i.o].nextSibling),i.element.style.opacity="",i=null)}),n.addEventListener("drop",function(e){e.preventDefault(),i&&i.o!=i.d&&"function"==typeof o.options.ondrop&&o.options.ondrop(n,i.o,i.d,i.element,e.target,e),i.element.style.opacity="",i=null});for(var s=function(e){var o=!1;return function e(t){(o=!(!t.className||!t.classList.contains("jsorting"))||o)||e(t.parentNode)}(e),o},l=0;l<n.children.length;l++)n.children[l].hasAttribute("draggable")||n.children[l].setAttribute("draggable","true");return n.val=function(){for(var e,t=[],o=0;o<n.children.length;o++)(e=n.children[o].getAttribute("data-id"))&&t.push(e);return t},n},F.tabs=function(l,e){var t,a={options:{}},o={data:[],position:null,allowCreate:!1,allowChangePosition:!1,onclick:null,onload:null,onchange:null,oncreate:null,ondelete:null,onbeforecreate:null,onchangeposition:null,animation:!1,hideHeaders:!1,padding:null,palette:null,maxWidth:null};for(t in o)e&&e.hasOwnProperty(t)?a.options[t]=e[t]:a.options[t]=o[t];l.classList.add("jtabs");function s(e){var t;a.options.animation&&(t=a.headers.children[e].getBoundingClientRect(),"modern"==a.options.palette?(p.style.width=t.width-4+"px",p.style.left=a.headers.children[e].offsetLeft+2+"px"):(p.style.width=t.width+"px",p.style.left=a.headers.children[e].offsetLeft+"px"),"bottom"==a.options.position?p.style.top="0px":p.style.bottom="0px")}function u(e){"function"==typeof a.headers.scrollTo?a.headers.scrollTo({left:e,behavior:"smooth"}):a.headers.scrollLeft=e,e<=1?c.classList.add("disabled"):c.classList.remove("disabled"),e>=a.headers.scrollWidth-a.headers.offsetWidth?d.classList.add("disabled"):d.classList.remove("disabled"),a.headers.scrollWidth<=a.headers.offsetWidth?(c.style.display="none",d.style.display="none"):(c.style.display="",d.style.display="")}var c=null,d=null,p=null;if(a.setBorder=s,a.open=function(e){for(var t,o,n,r=null,i=0;i<a.headers.children.length;i++)a.headers.children[i].classList.contains("jtabs-selected")&&(r=i),a.headers.children[i].classList.remove("jtabs-selected"),a.content.children[i]&&a.content.children[i].classList.remove("jtabs-selected");a.headers.children[e].classList.add("jtabs-selected"),a.content.children[e]&&a.content.children[e].classList.add("jtabs-selected"),r!=e&&"function"==typeof a.options.onchange&&a.content.children[e]&&a.options.onchange(l,a,e,a.headers.children[e],a.content.children[e]),1==a.options.hideHeaders&&a.headers.children.length<3&&0==a.options.allowCreate?a.headers.parentNode.style.display="none":(s(e),a.headers.parentNode.style.display="",e=(t=a.headers.children[e].offsetLeft)+a.headers.children[e].offsetWidth,n=(o=a.headers.scrollLeft)+a.headers.offsetWidth,o<=t&&e<=n||u(t-1))},a.selectIndex=function(e){e=Array.prototype.indexOf.call(a.headers.children,e);return 0<=e&&a.open(e),e},a.rename=function(e,t){t=t||prompt("New title",a.headers.children[e].innerText),a.headers.children[e].innerText=t,a.open(e)},a.create=function(e,t){if("function"==typeof a.options.onbeforecreate){var o=a.options.onbeforecreate(l);if(!1===o)return!1;e=o}o=a.appendElement(e);return"function"==typeof a.options.oncreate&&a.options.oncreate(l,o),o},a.remove=function(e){return a.deleteElement(e)},a.nextNumber=function(){for(var e=0,t=0;t<a.headers.children.length;t++){var o=a.headers.children[t].innerText.match(/[0-9].*/);e<o&&(e=parseInt(o))}return e?e++:e=1,e},a.deleteElement=function(e){if(!a.headers.children[e])return!1;a.headers.removeChild(a.headers.children[e]),a.content.removeChild(a.content.children[e]),a.open(0),"function"==typeof a.options.ondelete&&a.options.ondelete(l,e)},a.appendElement=function(e,t){var o,n;if(e=e||prompt("Title?",""))return o=document.createElement("div"),a.content.appendChild(o),(n=document.createElement("div")).innerHTML=e,n.content=o,a.headers.insertBefore(n,a.headers.lastChild),a.options.allowChangePosition&&n.setAttribute("draggable","true"),a.selectIndex(n),"function"==typeof t&&t(o,n),o},a.getActive=function(){for(var e=0;e<a.headers.children.length;e++)if(a.headers.children[e].classList.contains("jtabs-selected"))return e;return 0},a.updateContent=function(e,t){"string"==typeof t&&(document.createElement("div").innerHTML=t),a.content.children[e].classList.contains("jtabs-selected")&&t.classList.add("jtabs-selected"),a.content.replaceChild(t,a.content.children[e])},a.updatePosition=function(e,t){t<e?a.content.insertBefore(a.content.children[e],a.content.children[t]):a.content.insertBefore(a.content.children[e],a.content.children[t].nextSibling),a.open(t),"function"==typeof a.options.onchangeposition&&a.options.onchangeposition(a.headers,e,t)},a.move=function(e,t){t<e?a.headers.insertBefore(a.headers.children[e],a.headers.children[t]):a.headers.insertBefore(a.headers.children[e],a.headers.children[t].nextSibling),a.updatePosition(e,t)},a.setBorder=s,a.init=function(){l.innerHTML="",a.headers=document.createElement("div"),a.content=document.createElement("div"),a.headers.classList.add("jtabs-headers"),a.content.classList.add("jtabs-content"),a.options.palette?l.classList.add("jtabs-modern"):l.classList.remove("jtabs-modern"),a.options.padding&&(a.content.style.padding=parseInt(a.options.padding)+"px");var e=document.createElement("div"),t=(e.className="jtabs-headers-container",e.appendChild(a.headers),a.options.maxWidth&&(e.style.maxWidth=parseInt(a.options.maxWidth)+"px"),document.createElement("div"));t.className="jtabs-controls",t.setAttribute("draggable","false"),e.appendChild(t),"bottom"==a.options.position?(l.appendChild(a.content),l.appendChild(e)):(l.appendChild(e),l.appendChild(a.content)),1==a.options.allowCreate&&((e=document.createElement("div")).className="jtabs-add",e.onclick=function(){a.create()},t.appendChild(e)),(c=document.createElement("div")).className="jtabs-prev",c.onclick=function(){u(a.headers.scrollLeft-a.headers.offsetWidth)},t.appendChild(c),(d=document.createElement("div")).className="jtabs-next",d.onclick=function(){u(a.headers.scrollLeft+a.headers.offsetWidth)},t.appendChild(d);for(var o,n,r,i,s=0;s<a.options.data.length;s++)o=a.options.data[s].titleElement||document.createElement("div"),a.options.data[s].icon&&(n=document.createElement("div"),(r=document.createElement("i")).classList.add("material-icons"),r.innerHTML=a.options.data[s].icon,n.appendChild(r),o.appendChild(n)),a.options.data[s].title&&(r=document.createTextNode(a.options.data[s].title),o.appendChild(r)),a.options.data[s].width&&(o.style.width=a.options.data[s].width),a.options.data[s].contentElement?i=a.options.data[s].contentElement:(i=document.createElement("div")).innerHTML=a.options.data[s].content,a.headers.appendChild(o),a.content.appendChild(i);(p=document.createElement("div")).className="jtabs-border",a.headers.appendChild(p),a.options.animation&&l.classList.add("jtabs-animation"),a.headers.addEventListener("click",function(e){e=e.target.parentNode.classList.contains("jtabs-headers")?e.target:("I"==e.target.tagName?e.target.parentNode:e.target).parentNode;e=a.selectIndex(e);"function"==typeof a.options.onclick&&a.options.onclick(l,a,e,a.headers.children[e],a.content.children[e])}),a.headers.addEventListener("contextmenu",function(e){a.selectIndex(e.target)}),a.headers.children.length&&a.open(0),u(0),1==a.options.allowChangePosition&&F.sorting(a.headers,{direction:1,ondrop:function(e,t,o){a.updatePosition(t,o)}}),"function"==typeof a.options.onload&&a.options.onload(l,a)},l.children[0]&&l.children[0].children.length)for(var n=0;n<l.children[0].children.length;n++){var r=a.options.data&&a.options.data[n]?a.options.data[n]:{};l.children[1]&&l.children[1].children[n]?(r.titleElement=l.children[0].children[n],r.contentElement=l.children[1].children[n]):r.contentElement=l.children[0].children[n],a.options.data[n]=r}var i=!1;if(a.options.data)for(n=0;n<a.options.data.length;n++)a.options.data[n].url&&(F.ajax({url:a.options.data[n].url,type:"GET",dataType:"text/html",index:n,success:function(e){a.options.data[this.index].content=e},complete:function(){a.init()}}),i=!0);return i||a.init(),l.tabs=a},F.tags=function(l,e){if(l.tags)return l.tags.setOptions(e,!0);function a(){return!!(u.options.limit&&l.children.length>=u.options.limit)}var u={type:"tags",options:{}},c=null,r=null,d=(u.setOptions=function(e,t){var o,n={value:"",limit:null,limitMessage:null,search:null,placeholder:null,validation:null,onbeforepaste:null,onbeforechange:null,onlimit:null,onchange:null,onfocus:null,onblur:null,onload:null,colors:null};for(o in n)e&&e.hasOwnProperty(o)?u.options[o]=e[o]:void 0!==u.options[o]&&!0!==t||(u.options[o]=n[o]);return u.options.placeholder?l.setAttribute("data-placeholder",u.options.placeholder):l.removeAttribute("data-placeholder"),l.placeholder=u.options.placeholder,u.setValue(u.options.value),i(),u.options.search?r||(r=document.createElement("div"),l.parentNode.insertBefore(r,l.nextSibling),c=F.search(r,{data:u.options.search,onselect:function(e,t,o){u.selectIndex(t,o)}})):r&&(c=null,r.remove(),r=null),u},u.add=function(e,t){if("function"==typeof u.options.onbeforechange){var o=u.options.onbeforechange(l,u,u.options.value,e);if(!1===o)return!1;null!=o&&(e=o)}if(c&&c.close(),a())"function"==typeof u.options.onlimit?u.options.onlimit(u,u.options.limit):u.options.limitMessage&&alert(u.options.limitMessage+" "+u.options.limit);else{o=F.getNode();if(!(o&&o.parentNode&&o.parentNode.classList.contains("jtags")&&o.nextSibling)||o.nextSibling.innerText&&o.nextSibling.innerText.trim()){if(!l.lastChild||l.lastChild.innerText.trim()||l.removeChild(l.lastChild),e&&"string"!=typeof e)for(var n,r,i=0;i<=e.length;i++)a()||(r=e[i]&&"string"!=typeof e[i]?(n=e[i].text,e[i].value):(n=e[i]||"",null),s=p(n,r));else var s=p(e,e,o);h()}else s=o.nextSibling;t&&d(s)}},u.setLimit=function(e){u.options.limit=e;for(l.children.length;l.children.length>e;)l.removeChild(l.lastChild)},u.remove=function(e){e.parentNode.removeChild(e),l.children.length?h():u.add("",!0)},u.getData=function(){for(var e=[],t=0;t<l.children.length;t++){var o=l.children[t].innerText.replace("\n",""),n=(n=l.children[t].getAttribute("data-value"))||o;(o||n)&&e.push({text:o,value:n})}return e},u.getValue=function(e){var t=null;if(null!=e)t=(t=l.children[e].getAttribute("data-value"))||l.children[e].innerText.replace("\n","");else{for(var o=[],n=0;n<l.children.length;n++)(t=l.children[n].innerText.replace("\n",""))&&o.push(u.getValue(n));t=o.join(",")}return t},u.setValue=function(e){e?l.value!=e&&(Array.isArray(e)?u.add(e):(e=(""+e).trim(),e=n(e),l.innerHTML="",u.add(e))):u.reset()},u.reset=function(){l.classList.add("jtags-empty"),l.innerHTML="<div></div>",h()},u.isValid=function(){for(var e=0,t=0;t<l.children.length;t++)l.children[t].classList.contains("jtags_error")&&e++;return 0==e},u.selectIndex=function(e,t){var o=F.getNode();o&&(o.innerText=e,t&&o.setAttribute("data-value",t),o.classList.remove("jtags_error"),a()||u.add("",!0))},u.search=function(e){e.innerText},u.destroy=function(){l.removeEventListener("mouseup",m),l.removeEventListener("keydown",s),l.removeEventListener("keyup",f),l.removeEventListener("paste",b),l.removeEventListener("focus",g),l.removeEventListener("blur",j),l.parentNode.removeChild(l)},function(e){var t,o;1<l.children.length&&(t=document.createRange(),o=window.getSelection(),e=e||l.childNodes[l.childNodes.length-1],t.setStart(e,e.length),t.collapse(!0),o.removeAllRanges(),o.addRange(t),l.scrollLeft=l.scrollWidth)}),p=function(e,t,o){var n=document.createElement("div");return n.innerHTML=e||"",t&&n.setAttribute("data-value",t),o&&o.parentNode.classList.contains("jtags")?l.insertBefore(n,o.nextSibling):l.appendChild(n),n},h=function(){var e=u.getValue();e!=u.options.value&&(u.options.value=e,"function"==typeof u.options.onchange&&u.options.onchange(l,u,u.options.value),l.value!=u.options.value&&(l.value=u.options.value,"function"==typeof l.oninput&&l.oninput({type:"input",target:l,value:l.value}))),i()},i=function(){for(var e=0;e<l.children.length;e++)u.getValue(e)?(l.children[e].classList.add("jtags_label"),"function"!=typeof u.options.validation||!u.getValue(e)||u.options.validation(l.children[e],l.children[e].innerText,l.children[e].getAttribute("data-value"))?l.children[e].classList.remove("jtags_error"):l.children[e].classList.add("jtags_error")):l.children[e].classList.remove("jtags_label");t()},t=function(){l.innerText.trim()?l.classList.remove("jtags-empty"):(l.innerHTML="<div></div>",l.classList.add("jtags-empty"))},n=function(e){var t=[],o="";if(e=e.trim()){for(var n=0;n<e.length;n++)","==e[n]||";"==e[n]||"\n"==e[n]?o&&(t.push(o.trim()),o=""):o+=e[n];o&&t.push(o)}return t},o=0,s=function(e){o=window.getSelection().anchorOffset,t(),"Tab"===e.key||";"===e.key||","===e.key?(1<window.getSelection().anchorOffset&&(a()?"function"==typeof u.options.onlimit&&u.options.onlimit(u,u.options.limit):u.add("",!0)),e.preventDefault()):"Enter"==e.key?c&&c.isOpened()||(1<window.getSelection().anchorOffset&&(a()||u.add("",!0)),e.preventDefault()):"Backspace"==e.key&&1==l.children.length&&window.getSelection().anchorOffset<1&&e.preventDefault(),c&&c.keydown(e)},f=function(e){var t;39==e.which?1<(t=window.getSelection().anchorOffset)&&t==o&&u.add("",!0):13==e.which||38==e.which||40==e.which?e.preventDefault():c&&c.keyup(e),i()},b=function(e){e.clipboardData||e.originalEvent.clipboardData?t=(e.originalEvent||e).clipboardData.getData("text/plain"):window.clipboardData&&(t=window.clipboardData.getData("Text"));var t=n(t);if("function"==typeof u.options.onbeforepaste){var o=u.options.onbeforepaste(l,u,t);if(!1===o)return e.preventDefault(),!1;o&&(t=o)}1<t.length?(u.add(t,!0),e.preventDefault()):t[0]&&(document.execCommand("insertText",!1,t[0]),e.preventDefault())},m=function(e){var t;e.target.parentNode&&e.target.parentNode.classList.contains("jtags")&&(e.target.classList.contains("jtags_label")||e.target.classList.contains("jtags_error"))&&(t=e.target.getBoundingClientRect()).width-(e.clientX-t.left)<16&&u.remove(e.target),e.target==l&&d()},g=function(){l.classList.contains("jtags-focus")||(l.children.length&&!u.getValue(l.children.length-1)||a()||p(""),"function"==typeof u.options.onfocus&&u.options.onfocus(l,u,u.getValue()),l.classList.add("jtags-focus"))},j=function(){if(l.classList.contains("jtags-focus")){c&&c.close();for(var e=0;e<l.children.length-1;e++)u.getValue(e)||l.removeChild(l.children[e]);h(),l.classList.remove("jtags-focus"),"function"==typeof u.options.onblur&&u.options.onblur(l,u,u.getValue())}};return"touchend"in document.documentElement==!0?l.addEventListener("touchend",m):l.addEventListener("mouseup",m),l.addEventListener("keydown",s),l.addEventListener("keyup",f),l.addEventListener("paste",b),l.addEventListener("focus",g),l.addEventListener("blur",j),l.setAttribute("contenteditable",!0),l.classList.add("jtags"),u.setOptions(e),"function"==typeof u.options.onload&&u.options.onload(l,u),l.change=u.setValue,l.val=function(e){if(void 0===e)return u.getValue();u.setValue(e)},l.tags=u},F.toolbar=function(a,e){var t,u={type:"toolbar",options:{}},o={app:null,container:!1,badge:!1,title:!1,responsive:!1,maxWidth:null,bottom:!0,items:[]};for(t in o)e&&e.hasOwnProperty(t)?u.options[t]=e[t]:u.options[t]=o[t];!a&&e.app&&e.app.el&&(a=document.createElement("div"),e.app.el.appendChild(a));var n=document.createElement("div"),r=(n.classList.add("jtoolbar-item"),n.classList.add("jtoolbar-arrow"),document.createElement("div")),c=(r.classList.add("jtoolbar-floating"),n.appendChild(r),u.selectItem=function(e){for(var t=c.children,o=0;o<t.length;o++)e!=t[o]&&t[o].classList.remove("jtoolbar-selected");e.classList.add("jtoolbar-selected")},u.hide=function(){F.animation.slideBottom(a,0,function(){a.style.display="none"})},u.show=function(){a.style.display="",F.animation.slideBottom(a,1)},u.get=function(){return a},u.setBadge=function(e,t){c.children[e].children[1].firstChild.innerHTML=t},u.destroy=function(){toolbar.remove(),a.innerHTML=""},u.update=function(e,t){for(var o=0;o<c.children.length;o++){var n=c.children[o];"function"==typeof n.updateState&&n.updateState(a,u,n,e,t)}},u.create=function(e){c.innerHTML="";for(var t=0;t<e.length;t++){var o=document.createElement("div");if(o.classList.add("jtoolbar-item"),e[t].width&&(o.style.width=parseInt(e[t].width)+"px"),e[t].k&&(o.k=e[t].k),e[t].tooltip&&o.setAttribute("title",e[t].tooltip),e[t].id&&o.setAttribute("id",e[t].id),e[t].updateState&&(o.updateState=e[t].updateState),e[t].active&&o.classList.add("jtoolbar-active"),"select"==e[t].type||"dropdown"==e[t].type)F.picker(o,e[t]);else if("divisor"==e[t].type)o.classList.add("jtoolbar-divisor");else if("label"==e[t].type)o.classList.add("jtoolbar-label"),o.innerHTML=e[t].content;else{var n,r,i=document.createElement("i");if(void 0===e[t].class)i.classList.add("material-icons");else for(var s=e[t].class.split(" "),l=0;l<s.length;l++)i.classList.add(s[l]);i.innerHTML=e[t].content||"",o.appendChild(i),1==u.options.badge&&((n=document.createElement("div")).classList.add("jbadge"),(r=document.createElement("div")).innerHTML=e[t].badge||"",n.appendChild(r),o.appendChild(n)),e[t].title&&(1==u.options.title?((r=document.createElement("span")).innerHTML=e[t].title,o.appendChild(r)):o.setAttribute("title",e[t].title)),u.options.app&&e[t].route&&(o.route=e[t].route,o.onclick=function(){u.options.app.pages(this.route)},u.options.app.pages(e[t].route,{toolbarItem:o,closed:!0}))}e[t].onclick&&(o.onclick=e[t].onclick.bind(e[t],a,u,o)),c.appendChild(o)}setTimeout(function(){u.refresh()},0)},u.open=function(){n.classList.add("jtoolbar-arrow-selected");a.getBoundingClientRect();r.getBoundingClientRect().bottom>window.innerHeight||u.options.bottom?r.style.bottom="0":r.style.removeProperty("bottom"),r.style.right="0",n.children[0].focus(),F.tracking(u,!0)},u.close=function(){n.classList.remove("jtoolbar-arrow-selected"),F.tracking(u,!1)},u.refresh=function(){if(1==u.options.responsive){var e=a.parentNode.getBoundingClientRect(),t=(u.options.maxWidth||(u.options.maxWidth=e.width),parseInt(u.options.maxWidth));for(n.parentNode&&n.parentNode.removeChild(n);r.firstChild;)c.appendChild(r.firstChild);if(t<c.offsetWidth)for(t-=50;c.lastChild&&t<c.offsetWidth;)r.insertBefore(c.lastChild,r.firstChild);0<r.children.length&&c.appendChild(n)}},a.onclick=function(e){var t=F.findElement(e.target,"jtoolbar-item");t&&u.selectItem(t),e.target.classList.contains("jtoolbar-arrow")&&u.open()},window.addEventListener("resize",function(){u.refresh()}),a.classList.add("jtoolbar"),a.innerHTML="",1==u.options.container&&a.classList.add("jtoolbar-container"),document.createElement("div"));return a.appendChild(c),u.options.app&&a.classList.add("jtoolbar-mobile"),u.create(u.options.items),a.toolbar=u},F.validations=(v={between:function(e,t){return e>=t[0]&&e<=t[1]},"not between":function(e,t){return e<t[0]||e>t[1]},"<":function(e,t){return e<t[0]},"<=":function(e,t){return e<=t[0]},">":function(e,t){return e>t[0]},">=":function(e,t){return e>=t[0]},"=":function(e,t){return e===t[0]},"!=":function(e,t){return e!==t[0]}},y={"valid date":function(){return!0},"=":function(e,t){return e===t[0]},"<":function(e,t){return e<t[0]},"<=":function(e,t){return e<=t[0]},">":function(e,t){return e>t[0]},">=":function(e,t){return e>=t[0]},between:function(e,t){return e>=t[0]&&e<=t[1]},"not between":function(e,t){return e<t[0]||e>t[1]}},x={contains:function(e,t){return e.includes(t[0])},"not contains":function(e,t){return!e.includes(t[0])},"=":function(e,t){return e===t[0]},"valid email":function(e){return new RegExp(/^[^\s@]+@[^\s@]+\.[^\s@]+$/).test(e)},"valid url":function(e){return new RegExp(/(((https?:\/\/)|(www\.))[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|]+)/gi).test(e)}},S.url=function(){return!!new RegExp(/(((https?:\/\/)|(www\.))[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|]+)/gi).test(data)},S.email=function(e){var t=new RegExp(/^[^\s@]+@[^\s@]+\.[^\s@]+$/);return!(!e||!t.test(e))},S.required=function(e){return!!e.trim()},S.number=function(e,t){if(o=e,isNaN(o)||null===o||""===o)return!1;if(!t||!t.criteria)return!0;if(!v[t.criteria])return!1;var o=t.value.map(function(e){return parseFloat(e)});return v[t.criteria](e,o)},S.login=function(e){var t=new RegExp(/^[a-zA-Z0-9\_\-\.\s+]+$/);return!(!e||!t.test(e))},S.list=function(t,e){var o=typeof t;return("string"==o||"number"==o)&&-1<e.value[0].split(",").findIndex(function(e){return e==t})},S.date=function(e,t){if("Invalid Date"==new Date(e))return!1;if(!t||!t.criteria)return!0;if(!y[t.criteria])return!1;var o=t.value.map(function(e){return new Date(e).getTime()});return y[t.criteria](new Date(e).getTime(),o)},S.text=function(e,t){return"string"==typeof e&&(!t||!t.criteria||!!x[t.criteria]&&x[t.criteria](e,t.value))},S),F});